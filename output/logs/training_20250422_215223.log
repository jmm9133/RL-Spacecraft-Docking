2025-04-22 21:52:23,963 [__main__] [INFO] Logging setup complete. Log file: output/logs/training_20250422_215223.log
2025-04-22 21:52:23,964 [__main__] [INFO] Registered RLlib environment 'satellite_marl'
2025-04-22 21:52:23,964 [__main__] [INFO] --- Starting MARL Training Script ---
2025-04-22 21:52:23,964 [__main__] [INFO] Environment Config: src.config
2025-04-22 21:52:23,964 [__main__] [INFO] RLlib PPO Algorithm
2025-04-22 21:52:23,964 [__main__] [INFO] Training Iterations: 36000
2025-04-22 21:52:23,965 [__main__] [INFO] Results Directory: output/ray_results
2025-04-22 21:52:23,965 [__main__] [WARNING] Reminder: Check '/tmp/ray' disk usage. Clean or configure Ray's temp directory if it's over 95% full.
2025-04-22 21:52:23,965 [__main__] [INFO] Detected 16 CPUs.
2025-04-22 21:52:24,054 [filelock] [DEBUG] Attempting to acquire lock 5839987856 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/node_ip_address.json.lock
2025-04-22 21:52:24,055 [filelock] [DEBUG] Lock 5839987856 acquired on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/node_ip_address.json.lock
2025-04-22 21:52:24,056 [filelock] [DEBUG] Attempting to release lock 5839987856 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/node_ip_address.json.lock
2025-04-22 21:52:24,056 [filelock] [DEBUG] Lock 5839987856 released on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/node_ip_address.json.lock
2025-04-22 21:52:24,057 [filelock] [DEBUG] Attempting to acquire lock 4944478032 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,058 [filelock] [DEBUG] Lock 4944478032 acquired on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,059 [filelock] [DEBUG] Attempting to release lock 4944478032 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,059 [filelock] [DEBUG] Lock 4944478032 released on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,059 [filelock] [DEBUG] Attempting to acquire lock 5838998416 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,059 [filelock] [DEBUG] Lock 5838998416 acquired on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,060 [filelock] [DEBUG] Attempting to release lock 5838998416 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,060 [filelock] [DEBUG] Lock 5838998416 released on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,061 [filelock] [DEBUG] Attempting to acquire lock 5838369168 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,061 [filelock] [DEBUG] Lock 5838369168 acquired on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,062 [filelock] [DEBUG] Attempting to release lock 5838369168 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,062 [filelock] [DEBUG] Lock 5838369168 released on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,062 [filelock] [DEBUG] Attempting to acquire lock 5839987856 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,063 [filelock] [DEBUG] Lock 5839987856 acquired on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,065 [filelock] [DEBUG] Attempting to release lock 5839987856 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,066 [filelock] [DEBUG] Lock 5839987856 released on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,066 [filelock] [DEBUG] Attempting to acquire lock 5838998416 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,067 [filelock] [DEBUG] Lock 5838998416 acquired on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,068 [filelock] [DEBUG] Attempting to release lock 5838998416 on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:24,068 [filelock] [DEBUG] Lock 5838998416 released on /tmp/ray/session_2025-04-22_21-52-24_051908_65824/ports_by_node.json.lock
2025-04-22 21:52:28,457 [__main__] [INFO] Ray initialized successfully.
2025-04-22 21:52:28,457 [__main__] [INFO] Creating temporary environment to get action/observation spaces...
2025-04-22 21:52:28,457 [__main__] [DEBUG] Creating RllibSatelliteEnv with config: {}
2025-04-22 21:52:28,461 [src.satellite_marl_env] [INFO] MuJoCo model loaded successfully from /Users/leo/RL-Spacecraft-Docking/src/xml_references/satellites.xml
2025-04-22 21:52:28,462 [src.satellite_marl_env] [DEBUG] MuJoCo IDs retrieved successfully.
2025-04-22 21:52:28,463 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-22 21:52:28,463 [__main__] [INFO] Observation/Action spaces retrieved successfully:
2025-04-22 21:52:28,463 [__main__] [INFO]   Agent 'servicer': Obs=Box(-inf, inf, (13,), float32), Act=Box(-1.0, 1.0, (6,), float32)
2025-04-22 21:52:28,463 [__main__] [INFO]   Agent 'target': Obs=Box(-inf, inf, (13,), float32), Act=Box(-1.0, 1.0, (6,), float32)
2025-04-22 21:52:28,463 [__main__] [INFO] Configuring RLlib PPO Algorithm...
2025-04-22 21:52:28,463 [__main__] [INFO] Absolute results path: /Users/leo/RL-Spacecraft-Docking/output/ray_results
2025-04-22 21:52:28,463 [__main__] [INFO] Using 14 environment runners (workers).
2025-04-22 21:52:28,464 [__main__] [INFO] Setting rollout_fragment_length: 200
2025-04-22 21:52:28,464 [__main__] [INFO] Setting train_batch_size: 2800 (= num_workers * rollout_fragment_length)
2025-04-22 21:52:28,466 [__main__] [INFO] PPO configuration object created.
2025-04-22 21:52:28,466 [__main__] [INFO] Building Algorithm...
2025-04-22 21:52:28,504 [__main__] [ERROR] Failed during RLlib configuration or algorithm build. Exiting.
Traceback (most recent call last):
  File "/Users/leo/RL-Spacecraft-Docking/src/train_marl.py", line 428, in <module>
    algo = config.build_algo() # Use the new method name
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 958, in build_algo
    return algo_class(
           ^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm.py", line 456, in __init__
    config.validate()
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo.py", line 339, in validate
    self._value_error(
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 4468, in _value_error
    raise ValueError(msg)
ValueError: `lr_schedule` is deprecated and must be None! Use the `lr` setting to setup a schedule.
To suppress all validation errors, set `config.experimental(_validate_config=False)` at your own risk.
