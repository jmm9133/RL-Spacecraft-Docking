2025-04-03 21:32:20,284 [__main__] [INFO] Initializing Ray...
2025-04-03 21:32:26,186 [__main__] [INFO] Creating temporary environment to get action/observation spaces...
2025-04-03 21:32:26,188 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:32:26,188 [__main__] [INFO] Spaces retrieved.
2025-04-03 21:32:26,188 [__main__] [INFO] Configuring RLlib PPO Algorithm...
2025-04-03 21:32:26,188 [__main__] [INFO] Using 23 environment runners (workers).
2025-04-03 21:32:26,188 [__main__] [INFO] Setting train_batch_size to 4600 (min required estimate: 4600)
2025-04-03 21:32:26,188 [__main__] [INFO] Building Algorithm...
2025-04-03 21:32:40,057 [__main__] [INFO] Algorithm Built. Using Policy/Module Class: DefaultPPOTorchRLModule
2025-04-03 21:32:40,057 [__main__] [INFO] 
--- Starting Training for 100 iterations ---
2025-04-03 21:32:42,934 [__main__] [INFO] Iter: 1/100, Ts(iter): 0, Ts(total): 4600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.88s
2025-04-03 21:32:45,848 [__main__] [INFO] Iter: 2/100, Ts(iter): 0, Ts(total): 9200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.91s
2025-04-03 21:32:48,516 [__main__] [INFO] Iter: 3/100, Ts(iter): 0, Ts(total): 13800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.67s
2025-04-03 21:32:51,597 [__main__] [INFO] Iter: 4/100, Ts(iter): 0, Ts(total): 18400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.08s
2025-04-03 21:32:54,195 [__main__] [INFO] Iter: 5/100, Ts(iter): 0, Ts(total): 23000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.60s
2025-04-03 21:32:57,190 [__main__] [INFO] Iter: 6/100, Ts(iter): 0, Ts(total): 27600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:33:00,039 [__main__] [INFO] Iter: 7/100, Ts(iter): 0, Ts(total): 32200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.85s
2025-04-03 21:33:02,778 [__main__] [INFO] Iter: 8/100, Ts(iter): 0, Ts(total): 36800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.74s
2025-04-03 21:33:05,722 [__main__] [INFO] Iter: 9/100, Ts(iter): 0, Ts(total): 41400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.94s
2025-04-03 21:35:05,948 [__main__] [INFO] Iter: 10/100, Ts(iter): 0, Ts(total): 46000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 120.23s
2025-04-03 21:35:05,948 [__main__] [DEBUG] Full result dict at iter 10: {'timers': {'training_iteration': 2.870062666431039, 'restore_env_runners': 1.8286423496600683e-05, 'training_step': 2.8699383295169376, 'env_runner_sampling_timer': 0.30785707190344647, 'learner_update_timer': 2.556098696743928, 'synch_weights': 0.004843731721844493, 'synch_env_connectors': 0.008108963791564746, 'restore_eval_env_runners': 4.916000762023032e-06, 'evaluation_iteration': nan, 'synch_eval_env_connectors': 0.002051624993328005}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 129.6413995890854, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.826115866107547e-05, 'module_to_agent_unmapping': 3.898288565710414e-06, 'get_actions': 0.0001632266930889911, 'remove_single_ts_time_rank_from_batch': 1.2214477996567622e-06, 'un_batch_to_individual_items': 2.2120402802908512e-05, 'listify_data_for_vector_env': 9.82507849063723e-06, 'tensor_to_numpy': 5.435014219878963e-05}}, 'connector_pipeline_timer': 0.0003604198913398854}, 'weights_seq_no': 9.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.07952962621779e-05, 'batch_individual_items': 1.8238947105995766e-05, 'add_states_from_episodes_to_batch': 4.339777638421473e-06, 'add_time_dim_to_batch_and_zero_pad': 6.805160296742818e-06, 'agent_to_module_mapping': 4.458210076638953e-06, 'add_observations_from_episodes_to_batch': 1.78145962082645e-05}}, 'connector_pipeline_timer': 0.00012046690710452409}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 46000, 'target': 46000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 46000, 'target': 46000}, 'env_to_module_sum_episodes_length_in': 129.6413995890854, 'env_step_timer': 0.00015816422596210151, 'sample': 0.19911057427390666, 'rlmodule_inference_timer': 0.00017681613220352053, 'num_env_steps_sampled_lifetime': 46000, 'time_between_sampling': 2.675463283928263, 'num_env_steps_sampled_lifetime_throughput': 1026.4461432173086}, 'learners': {'servicer': {'weights_seq_no': 10.0, 'policy_loss': -0.05384344607591629, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 2.7770936489105225, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.702610492706299, 'num_module_steps_trained_lifetime': 463360, 'vf_loss_unclipped': 9324.712890625, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.0062500000931322575, 'mean_kl_loss': 0.005877566523849964, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.941586494445801, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 0.0033740997314453125, 'entropy': 9.258475303649902, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.3158506155014038, 'num_module_steps_trained_lifetime': 463360, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.02500000037252903, 'mean_kl_loss': 0.00685366615653038, 'num_trainable_parameters': 142093.0, 'vf_loss': 7.943806849652901e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 10.32834529876709, 'vf_loss_unclipped': 7.943806849652901e-06, 'weights_seq_no': 10.0, 'policy_loss': -0.10946304351091385, 'gradients_default_optimizer_global_norm': 2.270280599594116}, '__all_modules__': {'num_env_steps_trained_lifetime': 16652000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 8.065429547707225e-06, 'add_time_dim_to_batch_and_zero_pad': 2.7244129372364383e-05, 'add_observations_from_episodes_to_batch': 0.0002455347898152894, 'add_columns_from_episodes_to_train_batch': 0.08119886935765103, 'general_advantage_estimation': 0.027580588312858638, 'agent_to_module_mapping': 0.004069363974161819, 'add_one_ts_to_episodes_and_truncate': 0.005484746700037613, 'numpy_to_tensor': 0.00017097513983094809, 'batch_individual_items': 0.07035652105333105}}, 'connector_pipeline_timer': 0.18937829799009653}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 926720, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'num_env_steps_sampled_lifetime': 46000, 'evaluation': {'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1026.4461432173086, 'done': False, 'training_iteration': 10, 'trial_id': 'default', 'date': '2025-04-03_21-35-05', 'timestamp': 1743730505, 'time_this_iter_s': 120.21374893188477, 'time_total_s': 145.7991864681244, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 145.7991864681244, 'iterations_since_restore': 10, 'perf': {'cpu_util_percent': 14.642690058479532, 'ram_util_percent': 55.00233918128656}}
2025-04-03 21:35:09,923 [__main__] [INFO] Iter: 11/100, Ts(iter): 0, Ts(total): 50600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 21:35:13,683 [__main__] [INFO] Iter: 12/100, Ts(iter): 0, Ts(total): 55200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.76s
2025-04-03 21:35:17,504 [__main__] [INFO] Iter: 13/100, Ts(iter): 0, Ts(total): 59800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.82s
2025-04-03 21:35:21,420 [__main__] [INFO] Iter: 14/100, Ts(iter): 0, Ts(total): 64400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:35:25,323 [__main__] [INFO] Iter: 15/100, Ts(iter): 0, Ts(total): 69000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.90s
2025-04-03 21:35:29,135 [__main__] [INFO] Iter: 16/100, Ts(iter): 0, Ts(total): 73600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.81s
2025-04-03 21:35:33,072 [__main__] [INFO] Iter: 17/100, Ts(iter): 0, Ts(total): 78200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.94s
2025-04-03 21:35:37,046 [__main__] [INFO] Iter: 18/100, Ts(iter): 0, Ts(total): 82800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 21:35:40,815 [__main__] [INFO] Iter: 19/100, Ts(iter): 0, Ts(total): 87400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.77s
2025-04-03 21:39:37,670 [__main__] [INFO] Iter: 20/100, Ts(iter): 0, Ts(total): 92000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 236.85s
2025-04-03 21:39:37,671 [__main__] [DEBUG] Full result dict at iter 20: {'timers': {'training_iteration': 2.9710772146290494, 'restore_env_runners': 1.7350014281505186e-05, 'training_step': 2.9709519420017023, 'env_runner_sampling_timer': 0.3012727594315123, 'learner_update_timer': 2.663591939361398, 'synch_weights': 0.0049267217622307865, 'synch_env_connectors': 0.008049499694515768, 'restore_eval_env_runners': 4.9464307085145266e-06, 'evaluation_iteration': 120.17561495798873, 'synch_eval_env_connectors': 0.002051624993328005}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.71351472764167, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.463875580573377e-05, 'module_to_agent_unmapping': 3.713256785232861e-06, 'get_actions': 0.0001349655735841271, 'remove_single_ts_time_rank_from_batch': 1.1727588898774525e-06, 'un_batch_to_individual_items': 2.219344491940759e-05, 'listify_data_for_vector_env': 1.0091239707637664e-05, 'tensor_to_numpy': 4.961788948613323e-05}}, 'connector_pipeline_timer': 0.0003223423043063405}, 'weights_seq_no': 19.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.9822419359079146e-05, 'batch_individual_items': 1.796048236077701e-05, 'add_states_from_episodes_to_batch': 5.084796549077128e-06, 'add_time_dim_to_batch_and_zero_pad': 6.814654505054175e-06, 'agent_to_module_mapping': 4.168732594170137e-06, 'add_observations_from_episodes_to_batch': 1.6509617842848552e-05}}, 'connector_pipeline_timer': 0.00011645108517253699}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'env_to_module_sum_episodes_length_in': 131.71351472764167, 'env_step_timer': 0.0001524003027587353, 'sample': 0.19814572637736128, 'rlmodule_inference_timer': 0.00015422151358774063, 'num_env_steps_sampled_lifetime': 92000, 'time_between_sampling': 3.7234283767257423, 'num_env_steps_sampled_lifetime_throughput': 1006.3884244209027}, 'learners': {'servicer': {'weights_seq_no': 20.0, 'policy_loss': -0.05091344565153122, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 3.8512516021728516, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.753073215484619, 'num_module_steps_trained_lifetime': 926720, 'vf_loss_unclipped': 45874.890625, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.0003906250058207661, 'mean_kl_loss': 0.005992043297737837, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 0.00036019086837768555, 'entropy': 9.800796508789062, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.06950747221708298, 'num_module_steps_trained_lifetime': 926720, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.012500000186264515, 'mean_kl_loss': 0.005264781415462494, 'num_trainable_parameters': 142093.0, 'vf_loss': 8.377192898478825e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 10.61971664428711, 'vf_loss_unclipped': 8.377192898478825e-06, 'weights_seq_no': 20.0, 'policy_loss': 0.14281268417835236, 'gradients_default_optimizer_global_norm': 4.2193284034729}, '__all_modules__': {'num_env_steps_trained_lifetime': 33304000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 8.012765668145059e-06, 'add_time_dim_to_batch_and_zero_pad': 2.7089226426105666e-05, 'add_observations_from_episodes_to_batch': 0.0002452834571672196, 'add_columns_from_episodes_to_train_batch': 0.0811880573816479, 'general_advantage_estimation': 0.027430470278160306, 'agent_to_module_mapping': 0.0040693003733654745, 'add_one_ts_to_episodes_and_truncate': 0.005481183239927822, 'numpy_to_tensor': 0.00017044659320068238, 'batch_individual_items': 0.07070289894318776}}, 'connector_pipeline_timer': 0.1895575955654664}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 1853440, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 92000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1006.3884244209027, 'done': False, 'training_iteration': 20, 'trial_id': 'default', 'date': '2025-04-03_21-39-37', 'timestamp': 1743730777, 'time_this_iter_s': 236.84665179252625, 'time_total_s': 417.4224634170532, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 417.4224634170532, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 13.309198813056382, 'ram_util_percent': 55.33679525222551}}
2025-04-03 21:39:37,684 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.9710772146290494, 'restore_env_runners': 1.7350014281505186e-05, 'training_step': 2.9709519420017023, 'env_runner_sampling_timer': 0.3012727594315123, 'learner_update_timer': 2.663591939361398, 'synch_weights': 0.0049267217622307865, 'synch_env_connectors': 0.008049499694515768, 'restore_eval_env_runners': 4.9464307085145266e-06, 'evaluation_iteration': 120.17561495798873, 'synch_eval_env_connectors': 0.002051624993328005}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.71351472764167, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.463875580573377e-05, 'module_to_agent_unmapping': 3.713256785232861e-06, 'get_actions': 0.0001349655735841271, 'remove_single_ts_time_rank_from_batch': 1.1727588898774525e-06, 'un_batch_to_individual_items': 2.219344491940759e-05, 'listify_data_for_vector_env': 1.0091239707637664e-05, 'tensor_to_numpy': 4.961788948613323e-05}}, 'connector_pipeline_timer': 0.0003223423043063405}, 'weights_seq_no': 19.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.9822419359079146e-05, 'batch_individual_items': 1.796048236077701e-05, 'add_states_from_episodes_to_batch': 5.084796549077128e-06, 'add_time_dim_to_batch_and_zero_pad': 6.814654505054175e-06, 'agent_to_module_mapping': 4.168732594170137e-06, 'add_observations_from_episodes_to_batch': 1.6509617842848552e-05}}, 'connector_pipeline_timer': 0.00011645108517253699}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'env_to_module_sum_episodes_length_in': 131.71351472764167, 'env_step_timer': 0.0001524003027587353, 'sample': 0.19814572637736128, 'rlmodule_inference_timer': 0.00015422151358774063, 'num_env_steps_sampled_lifetime': 92000, 'time_between_sampling': 3.7234283767257423, 'num_env_steps_sampled_lifetime_throughput': 1006.3884244209027}, 'learners': {'servicer': {'weights_seq_no': 20.0, 'policy_loss': -0.05091344565153122, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 3.8512516021728516, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.753073215484619, 'num_module_steps_trained_lifetime': 926720, 'vf_loss_unclipped': 45874.890625, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.0003906250058207661, 'mean_kl_loss': 0.005992043297737837, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 0.00036019086837768555, 'entropy': 9.800796508789062, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.06950747221708298, 'num_module_steps_trained_lifetime': 926720, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.012500000186264515, 'mean_kl_loss': 0.005264781415462494, 'num_trainable_parameters': 142093.0, 'vf_loss': 8.377192898478825e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 10.61971664428711, 'vf_loss_unclipped': 8.377192898478825e-06, 'weights_seq_no': 20.0, 'policy_loss': 0.14281268417835236, 'gradients_default_optimizer_global_norm': 4.2193284034729}, '__all_modules__': {'num_env_steps_trained_lifetime': 33304000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 8.012765668145059e-06, 'add_time_dim_to_batch_and_zero_pad': 2.7089226426105666e-05, 'add_observations_from_episodes_to_batch': 0.0002452834571672196, 'add_columns_from_episodes_to_train_batch': 0.0811880573816479, 'general_advantage_estimation': 0.027430470278160306, 'agent_to_module_mapping': 0.0040693003733654745, 'add_one_ts_to_episodes_and_truncate': 0.005481183239927822, 'numpy_to_tensor': 0.00017044659320068238, 'batch_individual_items': 0.07070289894318776}}, 'connector_pipeline_timer': 0.1895575955654664}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 1853440, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 92000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1006.3884244209027, 'done': False, 'training_iteration': 20, 'trial_id': 'default', 'date': '2025-04-03_21-39-37', 'timestamp': 1743730777, 'time_this_iter_s': 236.84665179252625, 'time_total_s': 417.4224634170532, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 417.4224634170532, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 13.309198813056382, 'ram_util_percent': 55.33679525222551}})
2025-04-03 21:39:41,580 [__main__] [INFO] Iter: 21/100, Ts(iter): 0, Ts(total): 96600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.89s
2025-04-03 21:39:45,424 [__main__] [INFO] Iter: 22/100, Ts(iter): 0, Ts(total): 101200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.84s
2025-04-03 21:39:49,372 [__main__] [INFO] Iter: 23/100, Ts(iter): 0, Ts(total): 105800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.95s
2025-04-03 21:39:53,194 [__main__] [INFO] Iter: 24/100, Ts(iter): 0, Ts(total): 110400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.82s
2025-04-03 21:39:57,017 [__main__] [INFO] Iter: 25/100, Ts(iter): 0, Ts(total): 115000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.82s
2025-04-03 21:40:00,955 [__main__] [INFO] Iter: 26/100, Ts(iter): 0, Ts(total): 119600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.94s
2025-04-03 21:40:04,819 [__main__] [INFO] Iter: 27/100, Ts(iter): 0, Ts(total): 124200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.86s
2025-04-03 21:40:08,638 [__main__] [INFO] Iter: 28/100, Ts(iter): 0, Ts(total): 128800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.82s
2025-04-03 21:40:12,527 [__main__] [INFO] Iter: 29/100, Ts(iter): 0, Ts(total): 133400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.89s
2025-04-03 21:44:10,155 [__main__] [INFO] Iter: 30/100, Ts(iter): 0, Ts(total): 138000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 237.63s
2025-04-03 21:44:10,156 [__main__] [DEBUG] Full result dict at iter 30: {'timers': {'training_iteration': 3.0619562765077726, 'restore_env_runners': 1.656746213643824e-05, 'training_step': 3.0618276678337555, 'env_runner_sampling_timer': 0.2947217758698207, 'learner_update_timer': 2.760974243745888, 'synch_weights': 0.004933135864467887, 'synch_env_connectors': 0.007975284783073884, 'restore_eval_env_runners': 4.946966491115745e-06, 'evaluation_iteration': 121.34222530965882, 'synch_eval_env_connectors': 0.10243472708345508}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.9188713172039, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.6170499093324793e-05, 'module_to_agent_unmapping': 4.126574738585958e-06, 'get_actions': 0.00014095053885621804, 'remove_single_ts_time_rank_from_batch': 1.195802412969504e-06, 'un_batch_to_individual_items': 2.2963272979073675e-05, 'listify_data_for_vector_env': 1.0920798600718228e-05, 'tensor_to_numpy': 5.0047510792648837e-05}}, 'connector_pipeline_timer': 0.0003344873208958525}, 'weights_seq_no': 29.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.071157313817818e-05, 'batch_individual_items': 1.8196686335580545e-05, 'add_states_from_episodes_to_batch': 4.567686444963403e-06, 'add_time_dim_to_batch_and_zero_pad': 6.9863729160875546e-06, 'agent_to_module_mapping': 4.62384684523563e-06, 'add_observations_from_episodes_to_batch': 1.9165408964046974e-05}}, 'connector_pipeline_timer': 0.0001227131268492078}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 138000, 'target': 138000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 138000, 'target': 138000}, 'env_to_module_sum_episodes_length_in': 131.9188713172039, 'env_step_timer': 0.0001556309561728787, 'sample': 0.19703800100915966, 'rlmodule_inference_timer': 0.00015579979333821368, 'num_env_steps_sampled_lifetime': 138000, 'time_between_sampling': 5.7859921472215845, 'num_env_steps_sampled_lifetime_throughput': 1012.7709683731457}, 'learners': {'servicer': {'weights_seq_no': 30.0, 'policy_loss': -0.0834038183093071, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 5.610424041748047, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.7180585861206055, 'num_module_steps_trained_lifetime': 1390080, 'vf_loss_unclipped': 45385.03125, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 4.882812572759576e-05, 'mean_kl_loss': 0.0044594272039830685, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 0.00031059980392456055, 'entropy': 9.926909446716309, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.15096594393253326, 'num_module_steps_trained_lifetime': 1390080, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.0015625000232830644, 'mean_kl_loss': 0.005718442145735025, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.566467734752223e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 10.945895195007324, 'vf_loss_unclipped': 5.566467734752223e-06, 'weights_seq_no': 30.0, 'policy_loss': 0.0679374486207962, 'gradients_default_optimizer_global_norm': 2.647502899169922}, '__all_modules__': {'num_env_steps_trained_lifetime': 49956000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.932382224283367e-06, 'add_time_dim_to_batch_and_zero_pad': 2.6837844123939114e-05, 'add_observations_from_episodes_to_batch': 0.000244817399088416, 'add_columns_from_episodes_to_train_batch': 0.08116916139506174, 'general_advantage_estimation': 0.02719499122609789, 'agent_to_module_mapping': 0.004069496692006326, 'add_one_ts_to_episodes_and_truncate': 0.005475840478668971, 'numpy_to_tensor': 0.00016950261052498019, 'batch_individual_items': 0.07121851010002754}}, 'connector_pipeline_timer': 0.1898094430376686}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 2780160, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 138000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1012.7709683731457, 'done': False, 'training_iteration': 30, 'trial_id': 'default', 'date': '2025-04-03_21-44-10', 'timestamp': 1743731050, 'time_this_iter_s': 237.6180820465088, 'time_total_s': 689.7911093235016, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 689.7911093235016, 'iterations_since_restore': 30, 'perf': {'cpu_util_percent': 15.82818991097923, 'ram_util_percent': 55.76854599406529}}
2025-04-03 21:44:14,033 [__main__] [INFO] Iter: 31/100, Ts(iter): 0, Ts(total): 142600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.88s
2025-04-03 21:44:18,004 [__main__] [INFO] Iter: 32/100, Ts(iter): 0, Ts(total): 147200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 21:44:21,925 [__main__] [INFO] Iter: 33/100, Ts(iter): 0, Ts(total): 151800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:44:25,849 [__main__] [INFO] Iter: 34/100, Ts(iter): 0, Ts(total): 156400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:44:29,765 [__main__] [INFO] Iter: 35/100, Ts(iter): 0, Ts(total): 161000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:44:33,621 [__main__] [INFO] Iter: 36/100, Ts(iter): 0, Ts(total): 165600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.86s
2025-04-03 21:44:37,420 [__main__] [INFO] Iter: 37/100, Ts(iter): 0, Ts(total): 170200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.80s
2025-04-03 21:44:41,396 [__main__] [INFO] Iter: 38/100, Ts(iter): 0, Ts(total): 174800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.98s
2025-04-03 21:44:45,250 [__main__] [INFO] Iter: 39/100, Ts(iter): 0, Ts(total): 179400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.85s
2025-04-03 21:48:37,682 [__main__] [INFO] Iter: 40/100, Ts(iter): 0, Ts(total): 184000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 232.43s
2025-04-03 21:48:37,682 [__main__] [DEBUG] Full result dict at iter 40: {'timers': {'training_iteration': 3.1480854497977804, 'restore_env_runners': 1.584566224276743e-05, 'training_step': 3.1479555151977934, 'env_runner_sampling_timer': 0.2891394394218826, 'learner_update_timer': 2.852632440510094, 'synch_weights': 0.004952143063301303, 'synch_env_connectors': 0.0079566769125768, 'restore_eval_env_runners': 4.951246798926149e-06, 'evaluation_iteration': 122.50486904322219, 'synch_eval_env_connectors': 0.2018713027226084}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.93922314412805, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.544379576463283e-05, 'module_to_agent_unmapping': 3.886536306597723e-06, 'get_actions': 0.00013625428082343567, 'remove_single_ts_time_rank_from_batch': 1.1911633116389817e-06, 'un_batch_to_individual_items': 2.2314435803925882e-05, 'listify_data_for_vector_env': 1.0063720149486497e-05, 'tensor_to_numpy': 5.0231137761796024e-05}}, 'connector_pipeline_timer': 0.000325031826332281}, 'weights_seq_no': 39.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.154082770234371e-05, 'batch_individual_items': 1.875187933930108e-05, 'add_states_from_episodes_to_batch': 4.055434526644734e-06, 'add_time_dim_to_batch_and_zero_pad': 6.782020364650159e-06, 'agent_to_module_mapping': 4.13901097500171e-06, 'add_observations_from_episodes_to_batch': 1.630872310551799e-05}}, 'connector_pipeline_timer': 0.00011856004468914388}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'env_to_module_sum_episodes_length_in': 131.93922314412805, 'env_step_timer': 0.00015343207130325267, 'sample': 0.19630745824115473, 'rlmodule_inference_timer': 0.00015201220839112267, 'num_env_steps_sampled_lifetime': 184000, 'time_between_sampling': 7.769470764124903, 'num_env_steps_sampled_lifetime_throughput': 979.0354111772215}, 'learners': {'servicer': {'weights_seq_no': 40.0, 'policy_loss': 0.128117635846138, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.014130592346191, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.9268693923950195, 'num_module_steps_trained_lifetime': 1853440, 'vf_loss_unclipped': 48458.359375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 6.10351571594947e-06, 'mean_kl_loss': 0.005000620149075985, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -6.92605972290039e-05, 'entropy': 10.062410354614258, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.2820225954055786, 'num_module_steps_trained_lifetime': 1853440, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.0015625000232830644, 'mean_kl_loss': 0.006348917260766029, 'num_trainable_parameters': 142093.0, 'vf_loss': 2.4131916234182427e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.12097692489624023, 'num_module_steps_trained': 46336, 'entropy': 11.357646942138672, 'vf_loss_unclipped': 2.4131916234182427e-06, 'weights_seq_no': 40.0, 'policy_loss': -0.0548819862306118, 'gradients_default_optimizer_global_norm': 4.376061916351318}, '__all_modules__': {'num_env_steps_trained_lifetime': 66608000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.83071120210066e-06, 'add_time_dim_to_batch_and_zero_pad': 2.6515938558638258e-05, 'add_observations_from_episodes_to_batch': 0.0002442288134098564, 'add_columns_from_episodes_to_train_batch': 0.08114811225471656, 'general_advantage_estimation': 0.026897048342469577, 'agent_to_module_mapping': 0.004070239963321441, 'add_one_ts_to_episodes_and_truncate': 0.005469167979040851, 'numpy_to_tensor': 0.00016831006147836116, 'batch_individual_items': 0.07190797620538655}}, 'connector_pipeline_timer': 0.1901685840712634}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 3706880, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 184000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 979.0354111772215, 'done': False, 'training_iteration': 40, 'trial_id': 'default', 'date': '2025-04-03_21-48-37', 'timestamp': 1743731317, 'time_this_iter_s': 232.4233009815216, 'time_total_s': 957.2194223403931, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 957.2194223403931, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 15.56808510638298, 'ram_util_percent': 56.60577507598784}}
2025-04-03 21:48:37,697 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.1480854497977804, 'restore_env_runners': 1.584566224276743e-05, 'training_step': 3.1479555151977934, 'env_runner_sampling_timer': 0.2891394394218826, 'learner_update_timer': 2.852632440510094, 'synch_weights': 0.004952143063301303, 'synch_env_connectors': 0.0079566769125768, 'restore_eval_env_runners': 4.951246798926149e-06, 'evaluation_iteration': 122.50486904322219, 'synch_eval_env_connectors': 0.2018713027226084}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.93922314412805, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.544379576463283e-05, 'module_to_agent_unmapping': 3.886536306597723e-06, 'get_actions': 0.00013625428082343567, 'remove_single_ts_time_rank_from_batch': 1.1911633116389817e-06, 'un_batch_to_individual_items': 2.2314435803925882e-05, 'listify_data_for_vector_env': 1.0063720149486497e-05, 'tensor_to_numpy': 5.0231137761796024e-05}}, 'connector_pipeline_timer': 0.000325031826332281}, 'weights_seq_no': 39.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.154082770234371e-05, 'batch_individual_items': 1.875187933930108e-05, 'add_states_from_episodes_to_batch': 4.055434526644734e-06, 'add_time_dim_to_batch_and_zero_pad': 6.782020364650159e-06, 'agent_to_module_mapping': 4.13901097500171e-06, 'add_observations_from_episodes_to_batch': 1.630872310551799e-05}}, 'connector_pipeline_timer': 0.00011856004468914388}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'env_to_module_sum_episodes_length_in': 131.93922314412805, 'env_step_timer': 0.00015343207130325267, 'sample': 0.19630745824115473, 'rlmodule_inference_timer': 0.00015201220839112267, 'num_env_steps_sampled_lifetime': 184000, 'time_between_sampling': 7.769470764124903, 'num_env_steps_sampled_lifetime_throughput': 979.0354111772215}, 'learners': {'servicer': {'weights_seq_no': 40.0, 'policy_loss': 0.128117635846138, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.014130592346191, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.9268693923950195, 'num_module_steps_trained_lifetime': 1853440, 'vf_loss_unclipped': 48458.359375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 6.10351571594947e-06, 'mean_kl_loss': 0.005000620149075985, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -6.92605972290039e-05, 'entropy': 10.062410354614258, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.2820225954055786, 'num_module_steps_trained_lifetime': 1853440, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.0015625000232830644, 'mean_kl_loss': 0.006348917260766029, 'num_trainable_parameters': 142093.0, 'vf_loss': 2.4131916234182427e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.12097692489624023, 'num_module_steps_trained': 46336, 'entropy': 11.357646942138672, 'vf_loss_unclipped': 2.4131916234182427e-06, 'weights_seq_no': 40.0, 'policy_loss': -0.0548819862306118, 'gradients_default_optimizer_global_norm': 4.376061916351318}, '__all_modules__': {'num_env_steps_trained_lifetime': 66608000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.83071120210066e-06, 'add_time_dim_to_batch_and_zero_pad': 2.6515938558638258e-05, 'add_observations_from_episodes_to_batch': 0.0002442288134098564, 'add_columns_from_episodes_to_train_batch': 0.08114811225471656, 'general_advantage_estimation': 0.026897048342469577, 'agent_to_module_mapping': 0.004070239963321441, 'add_one_ts_to_episodes_and_truncate': 0.005469167979040851, 'numpy_to_tensor': 0.00016831006147836116, 'batch_individual_items': 0.07190797620538655}}, 'connector_pipeline_timer': 0.1901685840712634}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 3706880, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 184000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 979.0354111772215, 'done': False, 'training_iteration': 40, 'trial_id': 'default', 'date': '2025-04-03_21-48-37', 'timestamp': 1743731317, 'time_this_iter_s': 232.4233009815216, 'time_total_s': 957.2194223403931, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 957.2194223403931, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 15.56808510638298, 'ram_util_percent': 56.60577507598784}})
2025-04-03 21:48:41,642 [__main__] [INFO] Iter: 41/100, Ts(iter): 0, Ts(total): 188600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.94s
2025-04-03 21:48:45,530 [__main__] [INFO] Iter: 42/100, Ts(iter): 0, Ts(total): 193200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.89s
2025-04-03 21:48:49,577 [__main__] [INFO] Iter: 43/100, Ts(iter): 0, Ts(total): 197800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.05s
2025-04-03 21:48:53,520 [__main__] [INFO] Iter: 44/100, Ts(iter): 0, Ts(total): 202400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.94s
2025-04-03 21:48:57,374 [__main__] [INFO] Iter: 45/100, Ts(iter): 0, Ts(total): 207000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.85s
2025-04-03 21:49:01,328 [__main__] [INFO] Iter: 46/100, Ts(iter): 0, Ts(total): 211600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.95s
2025-04-03 21:49:05,355 [__main__] [INFO] Iter: 47/100, Ts(iter): 0, Ts(total): 216200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.03s
2025-04-03 21:49:09,238 [__main__] [INFO] Iter: 48/100, Ts(iter): 0, Ts(total): 220800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.88s
2025-04-03 21:49:13,184 [__main__] [INFO] Iter: 49/100, Ts(iter): 0, Ts(total): 225400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.95s
2025-04-03 21:53:05,622 [__main__] [INFO] Iter: 50/100, Ts(iter): 0, Ts(total): 230000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 232.44s
2025-04-03 21:53:05,623 [__main__] [DEBUG] Full result dict at iter 50: {'timers': {'training_iteration': 3.2293315775091296, 'restore_env_runners': 1.5160260245540086e-05, 'training_step': 3.2292017190374973, 'env_runner_sampling_timer': 0.28399454050504597, 'learner_update_timer': 2.9389958662954094, 'synch_weights': 0.0049586903163745194, 'synch_env_connectors': 0.007891422706553856, 'restore_eval_env_runners': 4.950904233859473e-06, 'evaluation_iteration': 123.6039607632099, 'synch_eval_env_connectors': 0.3003687034454368}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.9412401081808, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.185622849394121e-05, 'module_to_agent_unmapping': 3.467605864331961e-06, 'get_actions': 0.00012672625596035902, 'remove_single_ts_time_rank_from_batch': 1.1251937449780014e-06, 'un_batch_to_individual_items': 2.0987630259152187e-05, 'listify_data_for_vector_env': 9.28017070116749e-06, 'tensor_to_numpy': 4.703514162194146e-05}}, 'connector_pipeline_timer': 0.0003046558809597363}, 'weights_seq_no': 49.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.887895860978775e-05, 'batch_individual_items': 1.6986185308948924e-05, 'add_states_from_episodes_to_batch': 4.31644194113046e-06, 'add_time_dim_to_batch_and_zero_pad': 6.358832552300685e-06, 'agent_to_module_mapping': 4.134940565614421e-06, 'add_observations_from_episodes_to_batch': 1.56686791542813e-05}}, 'connector_pipeline_timer': 0.00011162700786466577}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 230000, 'target': 230000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 230000, 'target': 230000}, 'env_to_module_sum_episodes_length_in': 131.9412401081808, 'env_step_timer': 0.00014394563192809506, 'sample': 0.19516592680958111, 'rlmodule_inference_timer': 0.00014438740912997157, 'num_env_steps_sampled_lifetime': 230000, 'time_between_sampling': 9.534207411709533, 'num_env_steps_sampled_lifetime_throughput': 987.6989522549757}, 'learners': {'servicer': {'weights_seq_no': 50.0, 'policy_loss': -0.000876142643392086, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 6.980094909667969, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.629899024963379, 'num_module_steps_trained_lifetime': 2316800, 'vf_loss_unclipped': 47199.30859375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 3.814697322468419e-07, 'mean_kl_loss': 0.0036166016943752766, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.843752861022949, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 2.187490463256836e-05, 'entropy': 10.648902893066406, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.22182013094425201, 'num_module_steps_trained_lifetime': 2316800, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 0.00019531250291038305, 'mean_kl_loss': 0.005258588120341301, 'num_trainable_parameters': 142093.0, 'vf_loss': 2.1004241261834977e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.031031131744384766, 'num_module_steps_trained': 46336, 'entropy': 11.938619613647461, 'vf_loss_unclipped': 2.1004241261834977e-06, 'weights_seq_no': 50.0, 'policy_loss': 0.016949165612459183, 'gradients_default_optimizer_global_norm': 4.149003028869629}, '__all_modules__': {'num_env_steps_trained_lifetime': 83260000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.712514675900663e-06, 'add_time_dim_to_batch_and_zero_pad': 2.613894113425502e-05, 'add_observations_from_episodes_to_batch': 0.00024351426474660706, 'add_columns_from_episodes_to_train_batch': 0.08112650990212789, 'general_advantage_estimation': 0.02656068310668806, 'agent_to_module_mapping': 0.004072489328039742, 'add_one_ts_to_episodes_and_truncate': 0.005461337528824718, 'numpy_to_tensor': 0.00016696220943389914, 'batch_individual_items': 0.07267976021375405}}, 'connector_pipeline_timer': 0.19057051647003664}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 4633600, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 230000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 987.6989522549757, 'done': False, 'training_iteration': 50, 'trial_id': 'default', 'date': '2025-04-03_21-53-05', 'timestamp': 1743731585, 'time_this_iter_s': 232.42976880073547, 'time_total_s': 1225.0427718162537, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 1225.0427718162537, 'iterations_since_restore': 50, 'perf': {'cpu_util_percent': 15.14255319148936, 'ram_util_percent': 56.687234042553186}}
2025-04-03 21:53:09,633 [__main__] [INFO] Iter: 51/100, Ts(iter): 0, Ts(total): 234600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.01s
2025-04-03 21:53:13,656 [__main__] [INFO] Iter: 52/100, Ts(iter): 0, Ts(total): 239200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.02s
2025-04-03 21:53:17,427 [__main__] [INFO] Iter: 53/100, Ts(iter): 0, Ts(total): 243800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.77s
2025-04-03 21:53:21,481 [__main__] [INFO] Iter: 54/100, Ts(iter): 0, Ts(total): 248400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.05s
2025-04-03 21:53:25,536 [__main__] [INFO] Iter: 55/100, Ts(iter): 0, Ts(total): 253000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.05s
2025-04-03 21:53:29,442 [__main__] [INFO] Iter: 56/100, Ts(iter): 0, Ts(total): 257600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.91s
2025-04-03 21:53:33,474 [__main__] [INFO] Iter: 57/100, Ts(iter): 0, Ts(total): 262200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.03s
2025-04-03 21:53:37,258 [__main__] [INFO] Iter: 58/100, Ts(iter): 0, Ts(total): 266800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.78s
2025-04-03 21:53:41,175 [__main__] [INFO] Iter: 59/100, Ts(iter): 0, Ts(total): 271400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:57:42,317 [__main__] [INFO] Iter: 60/100, Ts(iter): 0, Ts(total): 276000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 241.14s
2025-04-03 21:57:42,317 [__main__] [DEBUG] Full result dict at iter 60: {'timers': {'training_iteration': 3.303195101324642, 'restore_env_runners': 1.452354091641124e-05, 'training_step': 3.3030639541924813, 'env_runner_sampling_timer': 0.27809845843330794, 'learner_update_timer': 3.018714756296366, 'synch_weights': 0.004962221373653631, 'synch_env_connectors': 0.007839316284525702, 'restore_eval_env_runners': 4.943895224098542e-06, 'evaluation_iteration': 124.69212303432784, 'synch_eval_env_connectors': 0.39776312141104087}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94143999903113, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.1399158981282614e-05, 'module_to_agent_unmapping': 3.4538087372819227e-06, 'get_actions': 0.0001264285191925304, 'remove_single_ts_time_rank_from_batch': 1.1421360976446598e-06, 'un_batch_to_individual_items': 2.0933636472319718e-05, 'listify_data_for_vector_env': 9.404465652812398e-06, 'tensor_to_numpy': 4.688455303408621e-05}}, 'connector_pipeline_timer': 0.00030253948994190334}, 'weights_seq_no': 59.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.907614289861852e-05, 'batch_individual_items': 1.7088753692749727e-05, 'add_states_from_episodes_to_batch': 4.069786258880434e-06, 'add_time_dim_to_batch_and_zero_pad': 6.405627891541214e-06, 'agent_to_module_mapping': 4.17104921811894e-06, 'add_observations_from_episodes_to_batch': 1.5637678631549972e-05}}, 'connector_pipeline_timer': 0.00011183981691532954}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'env_to_module_sum_episodes_length_in': 131.94143999903113, 'env_step_timer': 0.00014282509711560122, 'sample': 0.1938086454736973, 'rlmodule_inference_timer': 0.0001441940452181213, 'num_env_steps_sampled_lifetime': 276000, 'time_between_sampling': 11.12985639704142, 'num_env_steps_sampled_lifetime_throughput': 992.2229314252585}, 'learners': {'servicer': {'weights_seq_no': 60.0, 'policy_loss': 0.07437174767255783, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 3.5449724197387695, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.812920093536377, 'num_module_steps_trained_lifetime': 2780160, 'vf_loss_unclipped': 47288.2265625, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 2.3841858265427618e-08, 'mean_kl_loss': 0.004163513425737619, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.960318088531494, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.609325408935547e-05, 'entropy': 11.088488578796387, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.1303776651620865, 'num_module_steps_trained_lifetime': 2780160, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 2.441406286379788e-05, 'mean_kl_loss': 0.005223596468567848, 'num_trainable_parameters': 142093.0, 'vf_loss': 1.0465158993611112e-05, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 12.2524995803833, 'vf_loss_unclipped': 1.0465158993611112e-05, 'weights_seq_no': 60.0, 'policy_loss': 0.11466178297996521, 'gradients_default_optimizer_global_norm': 3.9342823028564453}, '__all_modules__': {'num_env_steps_trained_lifetime': 99912000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.5808953659894325e-06, 'add_time_dim_to_batch_and_zero_pad': 2.572066499571713e-05, 'add_observations_from_episodes_to_batch': 0.0002427957939752742, 'add_columns_from_episodes_to_train_batch': 0.08110684535465898, 'general_advantage_estimation': 0.026189451711808764, 'agent_to_module_mapping': 0.004075278958616808, 'add_one_ts_to_episodes_and_truncate': 0.005452903544577574, 'numpy_to_tensor': 0.00016539763343007292, 'batch_individual_items': 0.07351588557929777}}, 'connector_pipeline_timer': 0.19100309255185546}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 5560320, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 276000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 992.2229314252585, 'done': False, 'training_iteration': 60, 'trial_id': 'default', 'date': '2025-04-03_21-57-42', 'timestamp': 1743731862, 'time_this_iter_s': 241.13308191299438, 'time_total_s': 1501.6404237747192, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 1501.6404237747192, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 14.729154518950438, 'ram_util_percent': 56.87900874635569}}
2025-04-03 21:57:42,330 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.303195101324642, 'restore_env_runners': 1.452354091641124e-05, 'training_step': 3.3030639541924813, 'env_runner_sampling_timer': 0.27809845843330794, 'learner_update_timer': 3.018714756296366, 'synch_weights': 0.004962221373653631, 'synch_env_connectors': 0.007839316284525702, 'restore_eval_env_runners': 4.943895224098542e-06, 'evaluation_iteration': 124.69212303432784, 'synch_eval_env_connectors': 0.39776312141104087}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94143999903113, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.1399158981282614e-05, 'module_to_agent_unmapping': 3.4538087372819227e-06, 'get_actions': 0.0001264285191925304, 'remove_single_ts_time_rank_from_batch': 1.1421360976446598e-06, 'un_batch_to_individual_items': 2.0933636472319718e-05, 'listify_data_for_vector_env': 9.404465652812398e-06, 'tensor_to_numpy': 4.688455303408621e-05}}, 'connector_pipeline_timer': 0.00030253948994190334}, 'weights_seq_no': 59.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.907614289861852e-05, 'batch_individual_items': 1.7088753692749727e-05, 'add_states_from_episodes_to_batch': 4.069786258880434e-06, 'add_time_dim_to_batch_and_zero_pad': 6.405627891541214e-06, 'agent_to_module_mapping': 4.17104921811894e-06, 'add_observations_from_episodes_to_batch': 1.5637678631549972e-05}}, 'connector_pipeline_timer': 0.00011183981691532954}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'env_to_module_sum_episodes_length_in': 131.94143999903113, 'env_step_timer': 0.00014282509711560122, 'sample': 0.1938086454736973, 'rlmodule_inference_timer': 0.0001441940452181213, 'num_env_steps_sampled_lifetime': 276000, 'time_between_sampling': 11.12985639704142, 'num_env_steps_sampled_lifetime_throughput': 992.2229314252585}, 'learners': {'servicer': {'weights_seq_no': 60.0, 'policy_loss': 0.07437174767255783, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 3.5449724197387695, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.812920093536377, 'num_module_steps_trained_lifetime': 2780160, 'vf_loss_unclipped': 47288.2265625, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 2.3841858265427618e-08, 'mean_kl_loss': 0.004163513425737619, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.960318088531494, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.609325408935547e-05, 'entropy': 11.088488578796387, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.1303776651620865, 'num_module_steps_trained_lifetime': 2780160, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 2.441406286379788e-05, 'mean_kl_loss': 0.005223596468567848, 'num_trainable_parameters': 142093.0, 'vf_loss': 1.0465158993611112e-05, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 12.2524995803833, 'vf_loss_unclipped': 1.0465158993611112e-05, 'weights_seq_no': 60.0, 'policy_loss': 0.11466178297996521, 'gradients_default_optimizer_global_norm': 3.9342823028564453}, '__all_modules__': {'num_env_steps_trained_lifetime': 99912000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.5808953659894325e-06, 'add_time_dim_to_batch_and_zero_pad': 2.572066499571713e-05, 'add_observations_from_episodes_to_batch': 0.0002427957939752742, 'add_columns_from_episodes_to_train_batch': 0.08110684535465898, 'general_advantage_estimation': 0.026189451711808764, 'agent_to_module_mapping': 0.004075278958616808, 'add_one_ts_to_episodes_and_truncate': 0.005452903544577574, 'numpy_to_tensor': 0.00016539763343007292, 'batch_individual_items': 0.07351588557929777}}, 'connector_pipeline_timer': 0.19100309255185546}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 5560320, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 276000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 992.2229314252585, 'done': False, 'training_iteration': 60, 'trial_id': 'default', 'date': '2025-04-03_21-57-42', 'timestamp': 1743731862, 'time_this_iter_s': 241.13308191299438, 'time_total_s': 1501.6404237747192, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 1501.6404237747192, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 14.729154518950438, 'ram_util_percent': 56.87900874635569}})
2025-04-03 21:57:46,290 [__main__] [INFO] Iter: 61/100, Ts(iter): 0, Ts(total): 280600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.96s
2025-04-03 21:57:50,211 [__main__] [INFO] Iter: 62/100, Ts(iter): 0, Ts(total): 285200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:57:54,202 [__main__] [INFO] Iter: 63/100, Ts(iter): 0, Ts(total): 289800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.99s
2025-04-03 21:57:58,120 [__main__] [INFO] Iter: 64/100, Ts(iter): 0, Ts(total): 294400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.92s
2025-04-03 21:58:01,988 [__main__] [INFO] Iter: 65/100, Ts(iter): 0, Ts(total): 299000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.87s
2025-04-03 21:58:05,962 [__main__] [INFO] Iter: 66/100, Ts(iter): 0, Ts(total): 303600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 21:58:09,856 [__main__] [INFO] Iter: 67/100, Ts(iter): 0, Ts(total): 308200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.89s
2025-04-03 21:58:13,900 [__main__] [INFO] Iter: 68/100, Ts(iter): 0, Ts(total): 312800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.04s
2025-04-03 21:58:17,872 [__main__] [INFO] Iter: 69/100, Ts(iter): 0, Ts(total): 317400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 22:02:09,960 [__main__] [INFO] Iter: 70/100, Ts(iter): 0, Ts(total): 322000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 232.09s
2025-04-03 22:02:09,961 [__main__] [DEBUG] Full result dict at iter 70: {'timers': {'training_iteration': 3.369413686407604, 'restore_env_runners': 1.3869031006414838e-05, 'training_step': 3.369282854332297, 'env_runner_sampling_timer': 0.2728532196507391, 'learner_update_timer': 3.0901467544805516, 'synch_weights': 0.004961450752132104, 'synch_env_connectors': 0.00781562305677552, 'restore_eval_env_runners': 4.943626174780142e-06, 'evaluation_iteration': 125.85643910690447, 'synch_eval_env_connectors': 0.4945641731169936}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94145980917696, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.4797219035795975e-05, 'module_to_agent_unmapping': 3.516155910144647e-06, 'get_actions': 0.0001288239304273935, 'remove_single_ts_time_rank_from_batch': 1.1339600897375705e-06, 'un_batch_to_individual_items': 2.1297951431737787e-05, 'listify_data_for_vector_env': 9.725751050686857e-06, 'tensor_to_numpy': 4.773194545877588e-05}}, 'connector_pipeline_timer': 0.0003108421446875153}, 'weights_seq_no': 69.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.944469216295433e-05, 'batch_individual_items': 1.797099859545209e-05, 'add_states_from_episodes_to_batch': 4.030171969262571e-06, 'add_time_dim_to_batch_and_zero_pad': 6.67626583896572e-06, 'agent_to_module_mapping': 4.637475815283902e-06, 'add_observations_from_episodes_to_batch': 1.5914614587225906e-05}}, 'connector_pipeline_timer': 0.00011439323442268244}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 322000, 'target': 322000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 322000, 'target': 322000}, 'env_to_module_sum_episodes_length_in': 131.94145980917696, 'env_step_timer': 0.00014890551660944637, 'sample': 0.1926212976955454, 'rlmodule_inference_timer': 0.00014791360037946474, 'num_env_steps_sampled_lifetime': 322000, 'time_between_sampling': 12.645260909129721, 'num_env_steps_sampled_lifetime_throughput': 1004.7118254444978}, 'learners': {'servicer': {'weights_seq_no': 70.0, 'policy_loss': -0.0776369720697403, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.332616329193115, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.619501113891602, 'num_module_steps_trained_lifetime': 3243520, 'vf_loss_unclipped': 45518.390625, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 7.450580707946131e-10, 'mean_kl_loss': 0.0040995278395712376, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.921259880065918, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -9.775161743164062e-06, 'entropy': 11.206123352050781, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.3144304156303406, 'num_module_steps_trained_lifetime': 3243520, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 1.220703143189894e-05, 'mean_kl_loss': 0.009866099804639816, 'num_trainable_parameters': 142093.0, 'vf_loss': 2.9396865102171432e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.41887998580932617, 'num_module_steps_trained': 46336, 'entropy': 13.297371864318848, 'vf_loss_unclipped': 2.9396865102171432e-06, 'weights_seq_no': 70.0, 'policy_loss': -0.04848604276776314, 'gradients_default_optimizer_global_norm': 4.518340587615967}, '__all_modules__': {'num_env_steps_trained_lifetime': 116564000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.4409934335694626e-06, 'add_time_dim_to_batch_and_zero_pad': 2.5276221528268474e-05, 'add_observations_from_episodes_to_batch': 0.000242043579870142, 'add_columns_from_episodes_to_train_batch': 0.08109225178959494, 'general_advantage_estimation': 0.02578303367040553, 'agent_to_module_mapping': 0.004078025578565093, 'add_one_ts_to_episodes_and_truncate': 0.005444218952833258, 'numpy_to_tensor': 0.00016363239612970473, 'batch_individual_items': 0.07446073644559172}}, 'connector_pipeline_timer': 0.19151338034770038}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 6487040, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 322000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1004.7118254444978, 'done': False, 'training_iteration': 70, 'trial_id': 'default', 'date': '2025-04-03_22-02-09', 'timestamp': 1743732129, 'time_this_iter_s': 232.08097004890442, 'time_total_s': 1769.1764867305756, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 1769.1764867305756, 'iterations_since_restore': 70, 'perf': {'cpu_util_percent': 13.841337386018235, 'ram_util_percent': 57.06869300911855}}
2025-04-03 22:02:13,915 [__main__] [INFO] Iter: 71/100, Ts(iter): 0, Ts(total): 326600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.95s
2025-04-03 22:02:17,754 [__main__] [INFO] Iter: 72/100, Ts(iter): 0, Ts(total): 331200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.84s
2025-04-03 22:02:21,724 [__main__] [INFO] Iter: 73/100, Ts(iter): 0, Ts(total): 335800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 22:02:25,696 [__main__] [INFO] Iter: 74/100, Ts(iter): 0, Ts(total): 340400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 22:02:29,580 [__main__] [INFO] Iter: 75/100, Ts(iter): 0, Ts(total): 345000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.88s
2025-04-03 22:02:33,558 [__main__] [INFO] Iter: 76/100, Ts(iter): 0, Ts(total): 349600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.98s
2025-04-03 22:02:37,407 [__main__] [INFO] Iter: 77/100, Ts(iter): 0, Ts(total): 354200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.85s
2025-04-03 22:02:41,378 [__main__] [INFO] Iter: 78/100, Ts(iter): 0, Ts(total): 358800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 22:02:45,373 [__main__] [INFO] Iter: 79/100, Ts(iter): 0, Ts(total): 363400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.99s
2025-04-03 22:06:44,099 [__main__] [INFO] Iter: 80/100, Ts(iter): 0, Ts(total): 368000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 238.73s
2025-04-03 22:06:44,100 [__main__] [DEBUG] Full result dict at iter 80: {'timers': {'training_iteration': 3.4273615982019776, 'restore_env_runners': 1.3293811769734648e-05, 'training_step': 3.4272305291283343, 'env_runner_sampling_timer': 0.26908873437745434, 'learner_update_timer': 3.1517864569923497, 'synch_weights': 0.004995150906015793, 'synch_env_connectors': 0.00778834236199959, 'restore_eval_env_runners': 4.946689876235786e-06, 'evaluation_iteration': 126.91870348917547, 'synch_eval_env_connectors': 0.5899476159658311}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94146177245787, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.595860990891957e-05, 'module_to_agent_unmapping': 3.548915990552649e-06, 'get_actions': 0.00013199152219100295, 'remove_single_ts_time_rank_from_batch': 1.2853561656347188e-06, 'un_batch_to_individual_items': 2.1727101385246112e-05, 'listify_data_for_vector_env': 9.624115355207103e-06, 'tensor_to_numpy': 4.8574241873201676e-05}}, 'connector_pipeline_timer': 0.00031817503610894165}, 'weights_seq_no': 79.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.058508416412729e-05, 'batch_individual_items': 1.8617796645555524e-05, 'add_states_from_episodes_to_batch': 4.162727325736078e-06, 'add_time_dim_to_batch_and_zero_pad': 7.437477190899469e-06, 'agent_to_module_mapping': 4.181835078140027e-06, 'add_observations_from_episodes_to_batch': 1.6235116668858466e-05}}, 'connector_pipeline_timer': 0.0001187520060725531}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'env_to_module_sum_episodes_length_in': 131.94146177245787, 'env_step_timer': 0.00014980060416245892, 'sample': 0.19193043027537232, 'rlmodule_inference_timer': 0.00015034013987976063, 'num_env_steps_sampled_lifetime': 368000, 'time_between_sampling': 13.945969488558228, 'num_env_steps_sampled_lifetime_throughput': 1020.2702278469469}, 'learners': {'servicer': {'weights_seq_no': 80.0, 'policy_loss': 0.046820640563964844, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 3.4838032722473145, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.8151044845581055, 'num_module_steps_trained_lifetime': 3706880, 'vf_loss_unclipped': 47113.5234375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 9.313225884932663e-11, 'mean_kl_loss': 0.005915521178394556, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 2.872943878173828e-05, 'entropy': 11.58582592010498, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.2111782729625702, 'num_module_steps_trained_lifetime': 3706880, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 1.220703143189894e-05, 'mean_kl_loss': 0.008171901106834412, 'num_trainable_parameters': 142093.0, 'vf_loss': 3.4763147596095223e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.2942236661911011, 'num_module_steps_trained': 46336, 'entropy': 14.106700897216797, 'vf_loss_unclipped': 3.4763147596095223e-06, 'weights_seq_no': 80.0, 'policy_loss': 0.07095218449831009, 'gradients_default_optimizer_global_norm': 2.244198799133301}, '__all_modules__': {'num_env_steps_trained_lifetime': 133216000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.2965193729629e-06, 'add_time_dim_to_batch_and_zero_pad': 2.4823590541221148e-05, 'add_observations_from_episodes_to_batch': 0.00024125498414937142, 'add_columns_from_episodes_to_train_batch': 0.08107153864992689, 'general_advantage_estimation': 0.02535195533547401, 'agent_to_module_mapping': 0.00408117401354208, 'add_one_ts_to_episodes_and_truncate': 0.005436446207914549, 'numpy_to_tensor': 0.00016177222008000185, 'batch_individual_items': 0.07545041269652633}}, 'connector_pipeline_timer': 0.19203871241067055}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 7413760, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 368000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1020.2702278469469, 'done': False, 'training_iteration': 80, 'trial_id': 'default', 'date': '2025-04-03_22-06-44', 'timestamp': 1743732404, 'time_this_iter_s': 238.7170398235321, 'time_total_s': 2043.2169568538666, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 2043.2169568538666, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 15.517751479289942, 'ram_util_percent': 57.36479289940829}}
2025-04-03 22:06:44,115 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.4273615982019776, 'restore_env_runners': 1.3293811769734648e-05, 'training_step': 3.4272305291283343, 'env_runner_sampling_timer': 0.26908873437745434, 'learner_update_timer': 3.1517864569923497, 'synch_weights': 0.004995150906015793, 'synch_env_connectors': 0.00778834236199959, 'restore_eval_env_runners': 4.946689876235786e-06, 'evaluation_iteration': 126.91870348917547, 'synch_eval_env_connectors': 0.5899476159658311}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94146177245787, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.595860990891957e-05, 'module_to_agent_unmapping': 3.548915990552649e-06, 'get_actions': 0.00013199152219100295, 'remove_single_ts_time_rank_from_batch': 1.2853561656347188e-06, 'un_batch_to_individual_items': 2.1727101385246112e-05, 'listify_data_for_vector_env': 9.624115355207103e-06, 'tensor_to_numpy': 4.8574241873201676e-05}}, 'connector_pipeline_timer': 0.00031817503610894165}, 'weights_seq_no': 79.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.058508416412729e-05, 'batch_individual_items': 1.8617796645555524e-05, 'add_states_from_episodes_to_batch': 4.162727325736078e-06, 'add_time_dim_to_batch_and_zero_pad': 7.437477190899469e-06, 'agent_to_module_mapping': 4.181835078140027e-06, 'add_observations_from_episodes_to_batch': 1.6235116668858466e-05}}, 'connector_pipeline_timer': 0.0001187520060725531}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'env_to_module_sum_episodes_length_in': 131.94146177245787, 'env_step_timer': 0.00014980060416245892, 'sample': 0.19193043027537232, 'rlmodule_inference_timer': 0.00015034013987976063, 'num_env_steps_sampled_lifetime': 368000, 'time_between_sampling': 13.945969488558228, 'num_env_steps_sampled_lifetime_throughput': 1020.2702278469469}, 'learners': {'servicer': {'weights_seq_no': 80.0, 'policy_loss': 0.046820640563964844, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 3.4838032722473145, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.8151044845581055, 'num_module_steps_trained_lifetime': 3706880, 'vf_loss_unclipped': 47113.5234375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 9.313225884932663e-11, 'mean_kl_loss': 0.005915521178394556, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 2.872943878173828e-05, 'entropy': 11.58582592010498, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.2111782729625702, 'num_module_steps_trained_lifetime': 3706880, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 1.220703143189894e-05, 'mean_kl_loss': 0.008171901106834412, 'num_trainable_parameters': 142093.0, 'vf_loss': 3.4763147596095223e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.2942236661911011, 'num_module_steps_trained': 46336, 'entropy': 14.106700897216797, 'vf_loss_unclipped': 3.4763147596095223e-06, 'weights_seq_no': 80.0, 'policy_loss': 0.07095218449831009, 'gradients_default_optimizer_global_norm': 2.244198799133301}, '__all_modules__': {'num_env_steps_trained_lifetime': 133216000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.2965193729629e-06, 'add_time_dim_to_batch_and_zero_pad': 2.4823590541221148e-05, 'add_observations_from_episodes_to_batch': 0.00024125498414937142, 'add_columns_from_episodes_to_train_batch': 0.08107153864992689, 'general_advantage_estimation': 0.02535195533547401, 'agent_to_module_mapping': 0.00408117401354208, 'add_one_ts_to_episodes_and_truncate': 0.005436446207914549, 'numpy_to_tensor': 0.00016177222008000185, 'batch_individual_items': 0.07545041269652633}}, 'connector_pipeline_timer': 0.19203871241067055}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 7413760, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 368000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1020.2702278469469, 'done': False, 'training_iteration': 80, 'trial_id': 'default', 'date': '2025-04-03_22-06-44', 'timestamp': 1743732404, 'time_this_iter_s': 238.7170398235321, 'time_total_s': 2043.2169568538666, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 2043.2169568538666, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 15.517751479289942, 'ram_util_percent': 57.36479289940829}})
2025-04-03 22:06:48,198 [__main__] [INFO] Iter: 81/100, Ts(iter): 0, Ts(total): 372600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.08s
2025-04-03 22:06:52,225 [__main__] [INFO] Iter: 82/100, Ts(iter): 0, Ts(total): 377200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.03s
2025-04-03 22:06:56,130 [__main__] [INFO] Iter: 83/100, Ts(iter): 0, Ts(total): 381800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.90s
2025-04-03 22:07:00,097 [__main__] [INFO] Iter: 84/100, Ts(iter): 0, Ts(total): 386400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 22:07:04,179 [__main__] [INFO] Iter: 85/100, Ts(iter): 0, Ts(total): 391000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.08s
2025-04-03 22:07:08,108 [__main__] [INFO] Iter: 86/100, Ts(iter): 0, Ts(total): 395600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.93s
2025-04-03 22:07:12,169 [__main__] [INFO] Iter: 87/100, Ts(iter): 0, Ts(total): 400200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.06s
2025-04-03 22:07:16,139 [__main__] [INFO] Iter: 88/100, Ts(iter): 0, Ts(total): 404800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.97s
2025-04-03 22:07:20,230 [__main__] [INFO] Iter: 89/100, Ts(iter): 0, Ts(total): 409400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.09s
2025-04-03 22:11:16,152 [__main__] [INFO] Iter: 90/100, Ts(iter): 0, Ts(total): 414000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 235.92s
2025-04-03 22:11:16,153 [__main__] [DEBUG] Full result dict at iter 90: {'timers': {'training_iteration': 3.488040609736491, 'restore_env_runners': 1.2860281887422276e-05, 'training_step': 3.4879087752618316, 'env_runner_sampling_timer': 0.26562702348860084, 'learner_update_timer': 3.215897039594876, 'synch_weights': 0.005003299546098829, 'synch_env_connectors': 0.007749697431771405, 'restore_eval_env_runners': 4.940142978324582e-06, 'evaluation_iteration': 128.0365976113737, 'synch_eval_env_connectors': 0.6846767118860497}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94146196702835, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.317039956756716e-05, 'module_to_agent_unmapping': 3.5369855859364537e-06, 'get_actions': 0.000129162612856844, 'remove_single_ts_time_rank_from_batch': 1.1548356877139866e-06, 'un_batch_to_individual_items': 2.130286631994184e-05, 'listify_data_for_vector_env': 9.702721871717475e-06, 'tensor_to_numpy': 4.7879085141958635e-05}}, 'connector_pipeline_timer': 0.0003097424148528419}, 'weights_seq_no': 89.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 2.931614878192014e-05, 'batch_individual_items': 1.7848040008768928e-05, 'add_states_from_episodes_to_batch': 4.331335324613511e-06, 'add_time_dim_to_batch_and_zero_pad': 6.583690176385179e-06, 'agent_to_module_mapping': 4.088781674682451e-06, 'add_observations_from_episodes_to_batch': 1.6254934502509447e-05}}, 'connector_pipeline_timer': 0.00011479675302968538}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 414000, 'target': 414000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 414000, 'target': 414000}, 'env_to_module_sum_episodes_length_in': 131.94146196702835, 'env_step_timer': 0.00014855789967508794, 'sample': 0.19125127242801768, 'rlmodule_inference_timer': 0.00014657240878897544, 'num_env_steps_sampled_lifetime': 414000, 'time_between_sampling': 15.175655938601645, 'num_env_steps_sampled_lifetime_throughput': 984.8894758116357}, 'learners': {'servicer': {'weights_seq_no': 90.0, 'policy_loss': 0.06156112626194954, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.464843273162842, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.827103614807129, 'num_module_steps_trained_lifetime': 4170240, 'vf_loss_unclipped': 47110.3046875, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 2.3283064712331658e-11, 'mean_kl_loss': 0.005342113319784403, 'num_trainable_parameters': 142093.0, 'vf_loss': 5.0, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 1.1861324310302734e-05, 'entropy': 11.72287654876709, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.22355277836322784, 'num_module_steps_trained_lifetime': 4170240, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 6.10351571594947e-06, 'mean_kl_loss': 0.008883235976099968, 'num_trainable_parameters': 142093.0, 'vf_loss': 3.3215119401575066e-06, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -0.345416784286499, 'num_module_steps_trained': 46336, 'entropy': 14.368302345275879, 'vf_loss_unclipped': 3.3215119401575066e-06, 'weights_seq_no': 90.0, 'policy_loss': 0.06380985677242279, 'gradients_default_optimizer_global_norm': 7.741454601287842}, '__all_modules__': {'num_env_steps_trained_lifetime': 149868000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.157772972760394e-06, 'add_time_dim_to_batch_and_zero_pad': 2.439570845984987e-05, 'add_observations_from_episodes_to_batch': 0.00024047670702621545, 'add_columns_from_episodes_to_train_batch': 0.08105651614894747, 'general_advantage_estimation': 0.024902751813365195, 'agent_to_module_mapping': 0.004085014234447739, 'add_one_ts_to_episodes_and_truncate': 0.005428849626388648, 'numpy_to_tensor': 0.0001599284875224729, 'batch_individual_items': 0.07645812102144799}}, 'connector_pipeline_timer': 0.19257053986575035}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 8340480, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 414000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 984.8894758116357, 'done': False, 'training_iteration': 90, 'trial_id': 'default', 'date': '2025-04-03_22-11-16', 'timestamp': 1743732676, 'time_this_iter_s': 235.9139940738678, 'time_total_s': 2315.156141281128, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 2315.156141281128, 'iterations_since_restore': 90, 'perf': {'cpu_util_percent': 13.627462686567164, 'ram_util_percent': 57.61970149253732}}
2025-04-03 22:11:20,085 [__main__] [INFO] Iter: 91/100, Ts(iter): 0, Ts(total): 418600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.93s
2025-04-03 22:11:23,997 [__main__] [INFO] Iter: 92/100, Ts(iter): 0, Ts(total): 423200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.91s
2025-04-03 22:11:28,045 [__main__] [INFO] Iter: 93/100, Ts(iter): 0, Ts(total): 427800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.05s
2025-04-03 22:11:32,053 [__main__] [INFO] Iter: 94/100, Ts(iter): 0, Ts(total): 432400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.01s
2025-04-03 22:11:36,074 [__main__] [INFO] Iter: 95/100, Ts(iter): 0, Ts(total): 437000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.02s
2025-04-03 22:11:40,032 [__main__] [INFO] Iter: 96/100, Ts(iter): 0, Ts(total): 441600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.96s
2025-04-03 22:11:44,078 [__main__] [INFO] Iter: 97/100, Ts(iter): 0, Ts(total): 446200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.05s
2025-04-03 22:11:48,114 [__main__] [INFO] Iter: 98/100, Ts(iter): 0, Ts(total): 450800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.03s
2025-04-03 22:11:52,139 [__main__] [INFO] Iter: 99/100, Ts(iter): 0, Ts(total): 455400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.03s
2025-04-03 22:15:44,188 [__main__] [INFO] Iter: 100/100, Ts(iter): 0, Ts(total): 460000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 232.05s
2025-04-03 22:15:44,189 [__main__] [DEBUG] Full result dict at iter 100: {'timers': {'training_iteration': 3.5407897024036834, 'restore_env_runners': 1.2461599084064993e-05, 'training_step': 3.5406575738263157, 'env_runner_sampling_timer': 0.26190290535232064, 'learner_update_timer': 3.2723194581352737, 'synch_weights': 0.005019614432364615, 'synch_env_connectors': 0.00771739450358406, 'restore_eval_env_runners': 4.954491451888679e-06, 'evaluation_iteration': 129.11527980567996, 'synch_eval_env_connectors': 0.7781932135171232}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94146198631134, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.328944015950828e-05, 'module_to_agent_unmapping': 3.635093623712229e-06, 'get_actions': 0.00012739314499618837, 'remove_single_ts_time_rank_from_batch': 1.1362668563883113e-06, 'un_batch_to_individual_items': 2.1357372626096082e-05, 'listify_data_for_vector_env': 9.462739720438742e-06, 'tensor_to_numpy': 4.8044313409478914e-05}}, 'connector_pipeline_timer': 0.000308674559300593}, 'weights_seq_no': 99.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.0007046615131164e-05, 'batch_individual_items': 1.769655731967144e-05, 'add_states_from_episodes_to_batch': 4.283960682450447e-06, 'add_time_dim_to_batch_and_zero_pad': 6.542890581081155e-06, 'agent_to_module_mapping': 3.962970122299557e-06, 'add_observations_from_episodes_to_batch': 1.631276614258472e-05}}, 'connector_pipeline_timer': 0.00011514316496849696}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'env_to_module_sum_episodes_length_in': 131.94146198631134, 'env_step_timer': 0.00014777492007779156, 'sample': 0.19069281143288597, 'rlmodule_inference_timer': 0.0001464322712282441, 'num_env_steps_sampled_lifetime': 460000, 'time_between_sampling': 16.269916817552726, 'num_env_steps_sampled_lifetime_throughput': 1006.63630454613}, 'learners': {'servicer': {'weights_seq_no': 100.0, 'policy_loss': 0.018489759415388107, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.7638959884643555, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.733792781829834, 'num_module_steps_trained_lifetime': 4633600, 'vf_loss_unclipped': 46746.68359375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 1.1641532356165829e-11, 'mean_kl_loss': 0.006125627551227808, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.9609375, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 9.59634780883789e-06, 'entropy': 12.281729698181152, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.4071328938007355, 'num_module_steps_trained_lifetime': 4633600, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 7.629394644936838e-07, 'mean_kl_loss': 0.0078773507848382, 'num_trainable_parameters': 142093.0, 'vf_loss': 1.790845453797374e-05, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 15.117605209350586, 'vf_loss_unclipped': 1.790845453797374e-05, 'weights_seq_no': 100.0, 'policy_loss': -0.10479867458343506, 'gradients_default_optimizer_global_norm': 7.210796356201172}, '__all_modules__': {'num_env_steps_trained_lifetime': 166520000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.01525896296299e-06, 'add_time_dim_to_batch_and_zero_pad': 2.3961881591419742e-05, 'add_observations_from_episodes_to_batch': 0.00023966170083645978, 'add_columns_from_episodes_to_train_batch': 0.08105216286802329, 'general_advantage_estimation': 0.02444531070033365, 'agent_to_module_mapping': 0.004088734655423484, 'add_one_ts_to_episodes_and_truncate': 0.00542088659002302, 'numpy_to_tensor': 0.00015812883145410544, 'batch_individual_items': 0.07752980796887923}}, 'connector_pipeline_timer': 0.19316821032181086}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 9267200, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1006.63630454613, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_22-15-44', 'timestamp': 1743732944, 'time_this_iter_s': 232.04036784172058, 'time_total_s': 2583.096843481064, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 2583.096843481064, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 15.004878048780489, 'ram_util_percent': 57.614939024390246}}
2025-04-03 22:15:44,201 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.5407897024036834, 'restore_env_runners': 1.2461599084064993e-05, 'training_step': 3.5406575738263157, 'env_runner_sampling_timer': 0.26190290535232064, 'learner_update_timer': 3.2723194581352737, 'synch_weights': 0.005019614432364615, 'synch_env_connectors': 0.00771739450358406, 'restore_eval_env_runners': 4.954491451888679e-06, 'evaluation_iteration': 129.11527980567996, 'synch_eval_env_connectors': 0.7781932135171232}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94146198631134, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.328944015950828e-05, 'module_to_agent_unmapping': 3.635093623712229e-06, 'get_actions': 0.00012739314499618837, 'remove_single_ts_time_rank_from_batch': 1.1362668563883113e-06, 'un_batch_to_individual_items': 2.1357372626096082e-05, 'listify_data_for_vector_env': 9.462739720438742e-06, 'tensor_to_numpy': 4.8044313409478914e-05}}, 'connector_pipeline_timer': 0.000308674559300593}, 'weights_seq_no': 99.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.0007046615131164e-05, 'batch_individual_items': 1.769655731967144e-05, 'add_states_from_episodes_to_batch': 4.283960682450447e-06, 'add_time_dim_to_batch_and_zero_pad': 6.542890581081155e-06, 'agent_to_module_mapping': 3.962970122299557e-06, 'add_observations_from_episodes_to_batch': 1.631276614258472e-05}}, 'connector_pipeline_timer': 0.00011514316496849696}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'env_to_module_sum_episodes_length_in': 131.94146198631134, 'env_step_timer': 0.00014777492007779156, 'sample': 0.19069281143288597, 'rlmodule_inference_timer': 0.0001464322712282441, 'num_env_steps_sampled_lifetime': 460000, 'time_between_sampling': 16.269916817552726, 'num_env_steps_sampled_lifetime_throughput': 1006.63630454613}, 'learners': {'servicer': {'weights_seq_no': 100.0, 'policy_loss': 0.018489759415388107, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.7638959884643555, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.733792781829834, 'num_module_steps_trained_lifetime': 4633600, 'vf_loss_unclipped': 46746.68359375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 1.1641532356165829e-11, 'mean_kl_loss': 0.006125627551227808, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.9609375, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 9.59634780883789e-06, 'entropy': 12.281729698181152, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.4071328938007355, 'num_module_steps_trained_lifetime': 4633600, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 7.629394644936838e-07, 'mean_kl_loss': 0.0078773507848382, 'num_trainable_parameters': 142093.0, 'vf_loss': 1.790845453797374e-05, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 15.117605209350586, 'vf_loss_unclipped': 1.790845453797374e-05, 'weights_seq_no': 100.0, 'policy_loss': -0.10479867458343506, 'gradients_default_optimizer_global_norm': 7.210796356201172}, '__all_modules__': {'num_env_steps_trained_lifetime': 166520000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.01525896296299e-06, 'add_time_dim_to_batch_and_zero_pad': 2.3961881591419742e-05, 'add_observations_from_episodes_to_batch': 0.00023966170083645978, 'add_columns_from_episodes_to_train_batch': 0.08105216286802329, 'general_advantage_estimation': 0.02444531070033365, 'agent_to_module_mapping': 0.004088734655423484, 'add_one_ts_to_episodes_and_truncate': 0.00542088659002302, 'numpy_to_tensor': 0.00015812883145410544, 'batch_individual_items': 0.07752980796887923}}, 'connector_pipeline_timer': 0.19316821032181086}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 9267200, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1006.63630454613, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_22-15-44', 'timestamp': 1743732944, 'time_this_iter_s': 232.04036784172058, 'time_total_s': 2583.096843481064, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 2583.096843481064, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 15.004878048780489, 'ram_util_percent': 57.614939024390246}})
2025-04-03 22:15:44,202 [__main__] [INFO] 
--- Training Finished ---
2025-04-03 22:15:44,202 [__main__] [INFO] Total Training Time: 2584.15 seconds
2025-04-03 22:15:44,203 [__main__] [INFO] Using last checkpoint: TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.5407897024036834, 'restore_env_runners': 1.2461599084064993e-05, 'training_step': 3.5406575738263157, 'env_runner_sampling_timer': 0.26190290535232064, 'learner_update_timer': 3.2723194581352737, 'synch_weights': 0.005019614432364615, 'synch_env_connectors': 0.00771739450358406, 'restore_eval_env_runners': 4.954491451888679e-06, 'evaluation_iteration': 129.11527980567996, 'synch_eval_env_connectors': 0.7781932135171232}, 'env_runners': {'connector_pipeline_timer': 0.0004095924352599389, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 2.660699892262726e-05, 'add_time_dim_to_batch_and_zero_pad': 2.0293520798947178e-05, 'add_observations_from_episodes_to_batch': 4.1793345387660615e-05, 'agent_to_module_mapping': 7.576045311946905e-06, 'numpy_to_tensor': 6.132247938734034e-05, 'batch_individual_items': 3.898912868664964e-05}}, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.94146198631134, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': 5.328944015950828e-05, 'module_to_agent_unmapping': 3.635093623712229e-06, 'get_actions': 0.00012739314499618837, 'remove_single_ts_time_rank_from_batch': 1.1362668563883113e-06, 'un_batch_to_individual_items': 2.1357372626096082e-05, 'listify_data_for_vector_env': 9.462739720438742e-06, 'tensor_to_numpy': 4.8044313409478914e-05}}, 'connector_pipeline_timer': 0.000308674559300593}, 'weights_seq_no': 99.0, 'env_to_module_connector': {'timers': {'connectors': {'numpy_to_tensor': 3.0007046615131164e-05, 'batch_individual_items': 1.769655731967144e-05, 'add_states_from_episodes_to_batch': 4.283960682450447e-06, 'add_time_dim_to_batch_and_zero_pad': 6.542890581081155e-06, 'agent_to_module_mapping': 3.962970122299557e-06, 'add_observations_from_episodes_to_batch': 1.631276614258472e-05}}, 'connector_pipeline_timer': 0.00011514316496849696}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_reset_timer': 0.0005903043480509001, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'env_to_module_sum_episodes_length_in': 131.94146198631134, 'env_step_timer': 0.00014777492007779156, 'sample': 0.19069281143288597, 'rlmodule_inference_timer': 0.0001464322712282441, 'num_env_steps_sampled_lifetime': 460000, 'time_between_sampling': 16.269916817552726, 'num_env_steps_sampled_lifetime_throughput': 1006.63630454613}, 'learners': {'servicer': {'weights_seq_no': 100.0, 'policy_loss': 0.018489759415388107, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'gradients_default_optimizer_global_norm': 4.7638959884643555, 'default_optimizer_learning_rate': 1e-05, 'total_loss': 4.733792781829834, 'num_module_steps_trained_lifetime': 4633600, 'vf_loss_unclipped': 46746.68359375, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 1.1641532356165829e-11, 'mean_kl_loss': 0.006125627551227808, 'num_trainable_parameters': 142093.0, 'vf_loss': 4.9609375, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': 9.59634780883789e-06, 'entropy': 12.281729698181152, 'num_module_steps_trained': 46336}, 'target': {'diff_num_grad_updates_vs_sampler_policy': 1.0, 'default_optimizer_learning_rate': 1e-05, 'total_loss': -0.4071328938007355, 'num_module_steps_trained_lifetime': 4633600, 'curr_entropy_coeff': 0.02, 'curr_kl_coeff': 7.629394644936838e-07, 'mean_kl_loss': 0.0078773507848382, 'num_trainable_parameters': 142093.0, 'vf_loss': 1.790845453797374e-05, 'module_train_batch_size_mean': 128.0, 'vf_explained_var': -1.0, 'num_module_steps_trained': 46336, 'entropy': 15.117605209350586, 'vf_loss_unclipped': 1.790845453797374e-05, 'weights_seq_no': 100.0, 'policy_loss': -0.10479867458343506, 'gradients_default_optimizer_global_norm': 7.210796356201172}, '__all_modules__': {'num_env_steps_trained_lifetime': 166520000, 'learner_connector': {'timers': {'connectors': {'add_states_from_episodes_to_batch': 7.01525896296299e-06, 'add_time_dim_to_batch_and_zero_pad': 2.3961881591419742e-05, 'add_observations_from_episodes_to_batch': 0.00023966170083645978, 'add_columns_from_episodes_to_train_batch': 0.08105216286802329, 'general_advantage_estimation': 0.02444531070033365, 'agent_to_module_mapping': 0.004088734655423484, 'add_one_ts_to_episodes_and_truncate': 0.00542088659002302, 'numpy_to_tensor': 0.00015812883145410544, 'batch_individual_items': 0.07752980796887923}}, 'connector_pipeline_timer': 0.19316821032181086}, 'learner_connector_sum_episodes_length_out': 4600.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained_lifetime': 9267200, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained': 1665200, 'num_module_steps_trained': 92672, 'num_non_trainable_parameters': 0.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'num_env_steps_sampled_per_second': 0.0}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 1, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1006.63630454613, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_22-15-44', 'timestamp': 1743732944, 'time_this_iter_s': 232.04036784172058, 'time_total_s': 2583.096843481064, 'pid': 81191, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.96, 'lr': 1e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c849440>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 2583.096843481064, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 15.004878048780489, 'ram_util_percent': 57.614939024390246}})
2025-04-03 22:15:44,204 [__main__] [INFO] 
--- Running Evaluation & Recording Video ---
2025-04-03 22:15:44,205 [__main__] [INFO] Successfully retrieved RLModules for evaluation.
2025-04-03 22:15:44,205 [__main__] [INFO] Evaluation Episode: 1/5
2025-04-03 22:15:44,280 [src.satellite_marl_env] [INFO] MuJoCo Renderer initialized for rgb_array.
2025-04-03 22:20:36,355 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 22:20:36,360 [__main__] [INFO] Evaluation Episode 1 Rewards: {'servicer': -3755783951.4954586, 'target': -13.080741962589197}
2025-04-03 22:20:36,360 [__main__] [INFO] Evaluation Episode: 2/5
2025-04-03 22:25:37,826 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 22:25:37,829 [__main__] [INFO] Evaluation Episode 2 Rewards: {'servicer': -3755783951.4954586, 'target': -13.080741962589197}
2025-04-03 22:25:37,830 [__main__] [INFO] Evaluation Episode: 3/5
