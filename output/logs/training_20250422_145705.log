2025-04-22 14:57:05,594 [__main__] [INFO] Logging setup complete. Log file: output/logs/training_20250422_145705.log
2025-04-22 14:57:05,595 [__main__] [INFO] Registered RLlib environment 'satellite_marl'
2025-04-22 14:57:05,595 [__main__] [INFO] --- Starting MARL Training Script ---
2025-04-22 14:57:05,595 [__main__] [INFO] Environment Config: src.config
2025-04-22 14:57:05,595 [__main__] [INFO] RLlib PPO Algorithm
2025-04-22 14:57:05,595 [__main__] [INFO] Training Iterations: 100
2025-04-22 14:57:05,595 [__main__] [INFO] Results Directory: output/ray_results
2025-04-22 14:57:05,596 [__main__] [INFO] Detected 16 CPUs.
2025-04-22 14:57:05,691 [filelock] [DEBUG] Attempting to acquire lock 5725732048 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/node_ip_address.json.lock
2025-04-22 14:57:05,691 [filelock] [DEBUG] Lock 5725732048 acquired on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/node_ip_address.json.lock
2025-04-22 14:57:05,693 [filelock] [DEBUG] Attempting to release lock 5725732048 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/node_ip_address.json.lock
2025-04-22 14:57:05,693 [filelock] [DEBUG] Lock 5725732048 released on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/node_ip_address.json.lock
2025-04-22 14:57:05,694 [filelock] [DEBUG] Attempting to acquire lock 4830789200 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,694 [filelock] [DEBUG] Lock 4830789200 acquired on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,695 [filelock] [DEBUG] Attempting to release lock 4830789200 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,695 [filelock] [DEBUG] Lock 4830789200 released on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,696 [filelock] [DEBUG] Attempting to acquire lock 5725732176 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,696 [filelock] [DEBUG] Lock 5725732176 acquired on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,697 [filelock] [DEBUG] Attempting to release lock 5725732176 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,697 [filelock] [DEBUG] Lock 5725732176 released on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,698 [filelock] [DEBUG] Attempting to acquire lock 5723988752 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,698 [filelock] [DEBUG] Lock 5723988752 acquired on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,699 [filelock] [DEBUG] Attempting to release lock 5723988752 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,699 [filelock] [DEBUG] Lock 5723988752 released on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,699 [filelock] [DEBUG] Attempting to acquire lock 5723632976 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,700 [filelock] [DEBUG] Lock 5723632976 acquired on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,701 [filelock] [DEBUG] Attempting to release lock 5723632976 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,701 [filelock] [DEBUG] Lock 5723632976 released on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,701 [filelock] [DEBUG] Attempting to acquire lock 5725732624 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,702 [filelock] [DEBUG] Lock 5725732624 acquired on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,703 [filelock] [DEBUG] Attempting to release lock 5725732624 on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:05,703 [filelock] [DEBUG] Lock 5725732624 released on /tmp/ray/session_2025-04-22_14-57-05_689702_74408/ports_by_node.json.lock
2025-04-22 14:57:09,381 [__main__] [INFO] Ray initialized successfully.
2025-04-22 14:57:09,381 [__main__] [INFO] Creating temporary environment to get action/observation spaces...
2025-04-22 14:57:09,381 [__main__] [DEBUG] Creating RllibSatelliteEnv with config: {}
2025-04-22 14:57:09,385 [src.satellite_marl_env] [INFO] MuJoCo model loaded successfully from /Users/leo/RL-Spacecraft-Docking/src/xml_references/satellites.xml
2025-04-22 14:57:09,386 [src.satellite_marl_env] [DEBUG] MuJoCo IDs retrieved successfully.
2025-04-22 14:57:09,386 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-22 14:57:09,387 [__main__] [INFO] Observation/Action spaces retrieved successfully:
2025-04-22 14:57:09,387 [__main__] [INFO]   Agent 'servicer': Obs=Box(-inf, inf, (13,), float32), Act=Box(-1.0, 1.0, (6,), float32)
2025-04-22 14:57:09,387 [__main__] [INFO]   Agent 'target': Obs=Box(-inf, inf, (13,), float32), Act=Box(-1.0, 1.0, (6,), float32)
2025-04-22 14:57:09,387 [__main__] [INFO] Configuring RLlib PPO Algorithm...
2025-04-22 14:57:09,388 [__main__] [INFO] Absolute results path: /Users/leo/RL-Spacecraft-Docking/output/ray_results
2025-04-22 14:57:09,388 [__main__] [INFO] Using 14 environment runners (workers).
2025-04-22 14:57:09,388 [__main__] [INFO] Setting rollout_fragment_length: 200
2025-04-22 14:57:09,388 [__main__] [INFO] Setting train_batch_size: 4000
2025-04-22 14:57:09,389 [__main__] [INFO] PPO configuration object created.
2025-04-22 14:57:09,390 [__main__] [INFO] Building Algorithm...
2025-04-22 14:57:09,429 [__main__] [ERROR] Failed during RLlib configuration or algorithm build. Exiting.
Traceback (most recent call last):
  File "/Users/leo/RL-Spacecraft-Docking/src/train_marl.py", line 496, in <module>
    algo = config.build()
           ^^^^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/utils/deprecation.py", line 128, in _ctor
    return obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 5418, in build
    return self.build_algo(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 958, in build_algo
    return algo_class(
           ^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm.py", line 456, in __init__
    config.validate()
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/ppo/ppo.py", line 292, in validate
    self.validate_train_batch_size_vs_rollout_fragment_length()
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 3993, in validate_train_batch_size_vs_rollout_fragment_length
    self._value_error(
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 4468, in _value_error
    raise ValueError(msg)
ValueError: Your desired `total_train_batch_size` (4000=0 learners x 4000) or a value 10% off of that cannot be achieved with your other settings (num_env_runners=14; num_envs_per_env_runner=1; rollout_fragment_length=285)! Try setting `rollout_fragment_length` to 'auto' OR to a value of 285.
To suppress all validation errors, set `config.experimental(_validate_config=False)` at your own risk.
