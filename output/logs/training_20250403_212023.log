2025-04-03 21:20:23,495 [__main__] [INFO] Initializing Ray...
2025-04-03 21:20:30,040 [__main__] [INFO] Creating temporary environment to get action/observation spaces...
2025-04-03 21:20:30,042 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:20:30,042 [__main__] [INFO] Spaces retrieved.
2025-04-03 21:20:30,042 [__main__] [INFO] Configuring RLlib PPO Algorithm...
2025-04-03 21:20:30,042 [__main__] [INFO] Using 23 environment runners (workers).
2025-04-03 21:20:30,042 [__main__] [INFO] Setting train_batch_size to 4600 (min required estimate: 4600)
2025-04-03 21:20:30,043 [__main__] [INFO] Building Algorithm...
2025-04-03 21:20:43,600 [__main__] [INFO] Algorithm Built. Using Policy/Module Class: DefaultPPOTorchRLModule
2025-04-03 21:20:43,600 [__main__] [INFO] 
--- Starting Training for 100 iterations ---
2025-04-03 21:20:46,260 [__main__] [INFO] Iter: 1/100, Ts(iter): 0, Ts(total): 4600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.66s
2025-04-03 21:20:48,798 [__main__] [INFO] Iter: 2/100, Ts(iter): 0, Ts(total): 9200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.54s
2025-04-03 21:20:51,398 [__main__] [INFO] Iter: 3/100, Ts(iter): 0, Ts(total): 13800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.60s
2025-04-03 21:20:54,197 [__main__] [INFO] Iter: 4/100, Ts(iter): 0, Ts(total): 18400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.80s
2025-04-03 21:20:56,824 [__main__] [INFO] Iter: 5/100, Ts(iter): 0, Ts(total): 23000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.63s
2025-04-03 21:20:59,928 [__main__] [INFO] Iter: 6/100, Ts(iter): 0, Ts(total): 27600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.10s
2025-04-03 21:21:03,389 [__main__] [INFO] Iter: 7/100, Ts(iter): 0, Ts(total): 32200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.46s
2025-04-03 21:21:06,895 [__main__] [INFO] Iter: 8/100, Ts(iter): 0, Ts(total): 36800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.51s
2025-04-03 21:21:10,192 [__main__] [INFO] Iter: 9/100, Ts(iter): 0, Ts(total): 41400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.30s
2025-04-03 21:21:14,356 [__main__] [INFO] Iter: 10/100, Ts(iter): 0, Ts(total): 46000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.16s
2025-04-03 21:21:14,357 [__main__] [DEBUG] Full result dict at iter 10: {'timers': {'training_iteration': 2.6823762012957326, 'restore_env_runners': 2.331787755334849e-05, 'training_step': 2.682251858184655, 'env_runner_sampling_timer': 0.34708682924462414, 'learner_update_timer': 2.3292559196231175, 'synch_weights': 0.004768114480219054, 'synch_env_connectors': 0.007188433698225915, 'restore_eval_env_runners': 3.875000402331352e-06, 'evaluation_iteration': 3.0877342080057133, 'synch_eval_env_connectors': 0.0021500830043805763}, 'env_runners': {'env_to_module_sum_episodes_length_out': 129.0551495455431, 'env_step_timer': 0.00015173058947275353, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.356381045921506e-06, 'batch_individual_items': 1.843418639237675e-05, 'numpy_to_tensor': 3.008506697257587e-05, 'add_time_dim_to_batch_and_zero_pad': 7.287402636751e-06, 'add_observations_from_episodes_to_batch': 1.760508249109058e-05, 'add_states_from_episodes_to_batch': 4.063038080844669e-06}}, 'connector_pipeline_timer': 0.00011911247809818625}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 46000, 'target': 46000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.2165655971014381, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1647185958702872e-06, 'module_to_agent_unmapping': 3.898710789999031e-06, 'tensor_to_numpy': 5.508973878388539e-05, 'listify_data_for_vector_env': 9.683996392719082e-06, 'un_batch_to_individual_items': 2.1669243195415566e-05, 'get_actions': 0.00014259308316308937, 'normalize_and_clip_actions': 5.9012250168522694e-05}}, 'connector_pipeline_timer': 0.00034301850199159163}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 46000, 'num_module_steps_sampled_lifetime': {'servicer': 46000, 'target': 46000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 9.0, 'rlmodule_inference_timer': 0.00016585912289460234, 'env_to_module_sum_episodes_length_in': 129.0551495455431, 'time_between_sampling': 2.4505233630283896, 'num_episodes_lifetime': 46, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -15.569136902378954, 'servicer': -1102.7469368199884}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1102.7469368199884, 'target': -15.569136902378954}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1118.316073722367, 'episode_return_max': -1111.55415230976, 'episode_duration_sec_mean': 0.8994795327820138, 'episode_return_min': -1128.1418116150974, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1106.6728805211183}, 'learners': {'servicer': {'mean_kl_loss': 0.009685762226581573, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.2045862674713135, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.02500000037252903, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 10.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 6.059073448181152, 'total_loss': 0.25509515404701233, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 9.184669494628906, 'vf_loss': 0.5972107648849487, 'vf_explained_var': 0.016093671321868896, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 463360, 'policy_loss': -0.15866442024707794}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 10.0, 'vf_loss_unclipped': 0.001025569741614163, 'total_loss': -0.3213472366333008, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 0.001025569741614163, 'entropy': 6.595478057861328, 'vf_explained_var': 0.11954206228256226, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 463360, 'policy_loss': -0.1914231926202774, 'mean_kl_loss': 0.00959918461740017, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.0323424339294434, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.1905657035556035, 'timers': {'connectors': {'batch_individual_items': 0.07158842230983437, 'numpy_to_tensor': 0.00019330336606042227, 'add_time_dim_to_batch_and_zero_pad': 2.594589596048327e-05, 'add_one_ts_to_episodes_and_truncate': 0.005759088302410883, 'add_observations_from_episodes_to_batch': 0.0002235476584487262, 'add_states_from_episodes_to_batch': 7.444059048497926e-06, 'general_advantage_estimation': 0.030470383148718718, 'agent_to_module_mapping': 0.003900558669710484, 'add_columns_from_episodes_to_train_batch': 0.07815847460376474}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 16652000, 'num_module_steps_trained_lifetime': 926720, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011336190718124686, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0491891881058987e-06, 'batch_individual_items': 1.2636935414091553e-05, 'numpy_to_tensor': 2.0397172557210384e-05, 'add_time_dim_to_batch_and_zero_pad': 4.628756103967806e-06, 'add_observations_from_episodes_to_batch': 1.2104040047338343e-05, 'add_states_from_episodes_to_batch': 3.0832750460018225e-06}}, 'connector_pipeline_timer': 8.253132594101131e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 5000, 'target': 5000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.000002031214535e-06, 'agent_to_module_mapping': 6.624992238357663e-06, 'batch_individual_items': 3.058298898395151e-05, 'numpy_to_tensor': 3.4083001082763076e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6291989595629275e-05, 'add_observations_from_episodes_to_batch': 2.954198862425983e-05}}, 'sample': 2.8956307909975294, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.535768495252811e-07, 'module_to_agent_unmapping': 2.6237812527723208e-06, 'tensor_to_numpy': 3.4941779652642065e-05, 'listify_data_for_vector_env': 7.046117404164064e-06, 'un_batch_to_individual_items': 1.5037461495798646e-05, 'get_actions': 3.717558264960272e-05, 'normalize_and_clip_actions': 3.829556059496128e-05}}, 'connector_pipeline_timer': 0.00016774956345500238}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -2.298700378686186, 'servicer': -1091.1174926610238}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1091.1174926610238, 'target': -2.298700378686186}, 'num_env_steps_sampled_lifetime': 5000, 'num_module_steps_sampled_lifetime': {'servicer': 5000, 'target': 5000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.00024745799601078033, 'env_reset_timer': 0.00014020799426361918, 'episode_return_mean': -1093.41619303971, 'episode_return_max': -1093.41619303971, 'weights_seq_no': 9.0, 'episode_duration_sec_mean': 0.5642808579956181, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011403847205966457, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 46000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1106.6728805211183, 'done': False, 'training_iteration': 10, 'trial_id': 'default', 'date': '2025-04-03_21-21-14', 'timestamp': 1743729674, 'time_this_iter_s': 4.149722099304199, 'time_total_s': 30.65812110900879, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 30.65812110900879, 'iterations_since_restore': 10, 'perf': {'cpu_util_percent': 79.13333333333334, 'ram_util_percent': 55.03333333333334}}
2025-04-03 21:21:17,915 [__main__] [INFO] Iter: 11/100, Ts(iter): 0, Ts(total): 50600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.56s
2025-04-03 21:21:21,058 [__main__] [INFO] Iter: 12/100, Ts(iter): 0, Ts(total): 55200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.14s
2025-04-03 21:21:24,620 [__main__] [INFO] Iter: 13/100, Ts(iter): 0, Ts(total): 59800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.56s
2025-04-03 21:21:27,821 [__main__] [INFO] Iter: 14/100, Ts(iter): 0, Ts(total): 64400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.20s
2025-04-03 21:21:31,183 [__main__] [INFO] Iter: 15/100, Ts(iter): 0, Ts(total): 69000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.36s
2025-04-03 21:21:34,115 [__main__] [INFO] Iter: 16/100, Ts(iter): 0, Ts(total): 73600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.93s
2025-04-03 21:21:37,229 [__main__] [INFO] Iter: 17/100, Ts(iter): 0, Ts(total): 78200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:21:39,884 [__main__] [INFO] Iter: 18/100, Ts(iter): 0, Ts(total): 82800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.65s
2025-04-03 21:21:42,500 [__main__] [INFO] Iter: 19/100, Ts(iter): 0, Ts(total): 87400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.62s
2025-04-03 21:21:46,491 [__main__] [INFO] Iter: 20/100, Ts(iter): 0, Ts(total): 92000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.99s
2025-04-03 21:21:46,491 [__main__] [DEBUG] Full result dict at iter 20: {'timers': {'training_iteration': 2.730588845882734, 'restore_env_runners': 2.20102539067104e-05, 'training_step': 2.730462875532241, 'env_runner_sampling_timer': 0.33759130949471294, 'learner_update_timer': 2.3868761231009388, 'synch_weights': 0.004797660009913395, 'synch_env_connectors': 0.007193482811818912, 'restore_eval_env_runners': 3.882920427713543e-06, 'evaluation_iteration': 3.0879419809256796, 'synch_eval_env_connectors': 0.002144403424317716}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.05545602565746, 'env_step_timer': 0.00015490775567371907, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.5645547251639215e-06, 'batch_individual_items': 1.8265058099224805e-05, 'numpy_to_tensor': 3.119533100599275e-05, 'add_time_dim_to_batch_and_zero_pad': 7.195116931613308e-06, 'add_observations_from_episodes_to_batch': 1.7381783378671345e-05, 'add_states_from_episodes_to_batch': 4.083096857881526e-06}}, 'connector_pipeline_timer': 0.00012034460797196591}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.21419384411519873, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.2236911931412874e-06, 'module_to_agent_unmapping': 3.812188618218652e-06, 'tensor_to_numpy': 5.189044916598e-05, 'listify_data_for_vector_env': 9.855923896060049e-06, 'un_batch_to_individual_items': 2.176754196707344e-05, 'get_actions': 0.00013727760092450614, 'normalize_and_clip_actions': 5.670115091398642e-05}}, 'connector_pipeline_timer': 0.0003298695498610187}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 92000, 'num_module_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 19.0, 'rlmodule_inference_timer': 0.00015844318891912692, 'env_to_module_sum_episodes_length_in': 131.05545602565746, 'time_between_sampling': 2.5092701367494916, 'num_episodes_lifetime': 92, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -12.506512860804795, 'servicer': -1103.8762127613084}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1103.8762127613084, 'target': -12.506512860804795}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1116.3827256221132, 'episode_return_max': -1108.2741191091325, 'episode_duration_sec_mean': 0.9283813113959141, 'episode_return_min': -1125.4514316585835, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1152.9288237122314}, 'learners': {'servicer': {'mean_kl_loss': 0.006399353034794331, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.5147960186004639, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0062500000931322575, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 20.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.9395647048950195, 'total_loss': 0.36581164598464966, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 10.045527458190918, 'vf_loss': 0.6088874340057373, 'vf_explained_var': 0.0033090710639953613, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 926720, 'policy_loss': -0.04220527783036232}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 20.0, 'vf_loss_unclipped': 0.00035671278601512313, 'total_loss': -0.10320955514907837, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 0.00035671278601512313, 'entropy': 4.457467555999756, 'vf_explained_var': -0.06418418884277344, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 926720, 'policy_loss': -0.015284735709428787, 'mean_kl_loss': 0.008678218349814415, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 3.2131550312042236, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.1907395552655091, 'timers': {'connectors': {'batch_individual_items': 0.07194068354196363, 'numpy_to_tensor': 0.0001925501634843542, 'add_time_dim_to_batch_and_zero_pad': 2.578950409632244e-05, 'add_one_ts_to_episodes_and_truncate': 0.005752697463312545, 'add_observations_from_episodes_to_batch': 0.0002234937598911356, 'add_states_from_episodes_to_batch': 7.402632641991371e-06, 'general_advantage_estimation': 0.030279931686125607, 'agent_to_module_mapping': 0.0039016946225223672, 'add_columns_from_episodes_to_train_batch': 0.07817832081506361}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 33304000, 'num_module_steps_trained_lifetime': 1853440, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011327435177600695, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0467998278465303e-06, 'batch_individual_items': 1.2624230894945665e-05, 'numpy_to_tensor': 2.0372418163209152e-05, 'add_time_dim_to_batch_and_zero_pad': 4.625670668598052e-06, 'add_observations_from_episodes_to_batch': 1.2085996658466393e-05, 'add_states_from_episodes_to_batch': 3.0809577099308507e-06}}, 'connector_pipeline_timer': 8.245111454515941e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 10, 'num_agent_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.000597831734922e-06, 'agent_to_module_mapping': 6.625079740479123e-06, 'batch_individual_items': 3.0582876584958286e-05, 'numpy_to_tensor': 3.4084509483363946e-05, 'add_time_dim_to_batch_and_zero_pad': 1.633498539595166e-05, 'add_observations_from_episodes_to_batch': 2.9544005324714814e-05}}, 'sample': 2.895630267672631, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.527778846728868e-07, 'module_to_agent_unmapping': 2.622152340196981e-06, 'tensor_to_numpy': 3.4918399088556615e-05, 'listify_data_for_vector_env': 7.041501534599716e-06, 'un_batch_to_individual_items': 1.5028009425053461e-05, 'get_actions': 3.7137833771931034e-05, 'normalize_and_clip_actions': 3.825440368442634e-05}}, 'connector_pipeline_timer': 0.00016761557829256393}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.8309827127555975, 'servicer': -1088.641168906682}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1088.641168906682, 'target': -1.8309827127555975}, 'num_env_steps_sampled_lifetime': 10000, 'num_module_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.00024750154611101607, 'env_reset_timer': 0.00014022030256455765, 'episode_return_mean': -1090.472151619437, 'episode_return_max': -1084.5840687788923, 'weights_seq_no': 19.0, 'episode_duration_sec_mean': 0.5600655053295971, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.000113920623768743, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3103626070747, 'time_between_sampling': 29.4388676249946}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 92000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1152.9288237122314, 'done': False, 'training_iteration': 20, 'trial_id': 'default', 'date': '2025-04-03_21-21-46', 'timestamp': 1743729706, 'time_this_iter_s': 3.9774200916290283, 'time_total_s': 62.65741562843323, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 62.65741562843323, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 75.68333333333334, 'ram_util_percent': 55.1}}
2025-04-03 21:21:46,508 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.730588845882734, 'restore_env_runners': 2.20102539067104e-05, 'training_step': 2.730462875532241, 'env_runner_sampling_timer': 0.33759130949471294, 'learner_update_timer': 2.3868761231009388, 'synch_weights': 0.004797660009913395, 'synch_env_connectors': 0.007193482811818912, 'restore_eval_env_runners': 3.882920427713543e-06, 'evaluation_iteration': 3.0879419809256796, 'synch_eval_env_connectors': 0.002144403424317716}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.05545602565746, 'env_step_timer': 0.00015490775567371907, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.5645547251639215e-06, 'batch_individual_items': 1.8265058099224805e-05, 'numpy_to_tensor': 3.119533100599275e-05, 'add_time_dim_to_batch_and_zero_pad': 7.195116931613308e-06, 'add_observations_from_episodes_to_batch': 1.7381783378671345e-05, 'add_states_from_episodes_to_batch': 4.083096857881526e-06}}, 'connector_pipeline_timer': 0.00012034460797196591}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.21419384411519873, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.2236911931412874e-06, 'module_to_agent_unmapping': 3.812188618218652e-06, 'tensor_to_numpy': 5.189044916598e-05, 'listify_data_for_vector_env': 9.855923896060049e-06, 'un_batch_to_individual_items': 2.176754196707344e-05, 'get_actions': 0.00013727760092450614, 'normalize_and_clip_actions': 5.670115091398642e-05}}, 'connector_pipeline_timer': 0.0003298695498610187}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 92000, 'num_module_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 19.0, 'rlmodule_inference_timer': 0.00015844318891912692, 'env_to_module_sum_episodes_length_in': 131.05545602565746, 'time_between_sampling': 2.5092701367494916, 'num_episodes_lifetime': 92, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -12.506512860804795, 'servicer': -1103.8762127613084}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1103.8762127613084, 'target': -12.506512860804795}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1116.3827256221132, 'episode_return_max': -1108.2741191091325, 'episode_duration_sec_mean': 0.9283813113959141, 'episode_return_min': -1125.4514316585835, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1152.9288237122314}, 'learners': {'servicer': {'mean_kl_loss': 0.006399353034794331, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.5147960186004639, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0062500000931322575, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 20.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.9395647048950195, 'total_loss': 0.36581164598464966, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 10.045527458190918, 'vf_loss': 0.6088874340057373, 'vf_explained_var': 0.0033090710639953613, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 926720, 'policy_loss': -0.04220527783036232}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 20.0, 'vf_loss_unclipped': 0.00035671278601512313, 'total_loss': -0.10320955514907837, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 0.00035671278601512313, 'entropy': 4.457467555999756, 'vf_explained_var': -0.06418418884277344, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 926720, 'policy_loss': -0.015284735709428787, 'mean_kl_loss': 0.008678218349814415, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 3.2131550312042236, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.1907395552655091, 'timers': {'connectors': {'batch_individual_items': 0.07194068354196363, 'numpy_to_tensor': 0.0001925501634843542, 'add_time_dim_to_batch_and_zero_pad': 2.578950409632244e-05, 'add_one_ts_to_episodes_and_truncate': 0.005752697463312545, 'add_observations_from_episodes_to_batch': 0.0002234937598911356, 'add_states_from_episodes_to_batch': 7.402632641991371e-06, 'general_advantage_estimation': 0.030279931686125607, 'agent_to_module_mapping': 0.0039016946225223672, 'add_columns_from_episodes_to_train_batch': 0.07817832081506361}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 33304000, 'num_module_steps_trained_lifetime': 1853440, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011327435177600695, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0467998278465303e-06, 'batch_individual_items': 1.2624230894945665e-05, 'numpy_to_tensor': 2.0372418163209152e-05, 'add_time_dim_to_batch_and_zero_pad': 4.625670668598052e-06, 'add_observations_from_episodes_to_batch': 1.2085996658466393e-05, 'add_states_from_episodes_to_batch': 3.0809577099308507e-06}}, 'connector_pipeline_timer': 8.245111454515941e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 10, 'num_agent_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.000597831734922e-06, 'agent_to_module_mapping': 6.625079740479123e-06, 'batch_individual_items': 3.0582876584958286e-05, 'numpy_to_tensor': 3.4084509483363946e-05, 'add_time_dim_to_batch_and_zero_pad': 1.633498539595166e-05, 'add_observations_from_episodes_to_batch': 2.9544005324714814e-05}}, 'sample': 2.895630267672631, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.527778846728868e-07, 'module_to_agent_unmapping': 2.622152340196981e-06, 'tensor_to_numpy': 3.4918399088556615e-05, 'listify_data_for_vector_env': 7.041501534599716e-06, 'un_batch_to_individual_items': 1.5028009425053461e-05, 'get_actions': 3.7137833771931034e-05, 'normalize_and_clip_actions': 3.825440368442634e-05}}, 'connector_pipeline_timer': 0.00016761557829256393}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.8309827127555975, 'servicer': -1088.641168906682}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1088.641168906682, 'target': -1.8309827127555975}, 'num_env_steps_sampled_lifetime': 10000, 'num_module_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.00024750154611101607, 'env_reset_timer': 0.00014022030256455765, 'episode_return_mean': -1090.472151619437, 'episode_return_max': -1084.5840687788923, 'weights_seq_no': 19.0, 'episode_duration_sec_mean': 0.5600655053295971, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.000113920623768743, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3103626070747, 'time_between_sampling': 29.4388676249946}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 92000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1152.9288237122314, 'done': False, 'training_iteration': 20, 'trial_id': 'default', 'date': '2025-04-03_21-21-46', 'timestamp': 1743729706, 'time_this_iter_s': 3.9774200916290283, 'time_total_s': 62.65741562843323, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 62.65741562843323, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 75.68333333333334, 'ram_util_percent': 55.1}})
2025-04-03 21:21:49,096 [__main__] [INFO] Iter: 21/100, Ts(iter): 0, Ts(total): 96600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.59s
2025-04-03 21:21:52,048 [__main__] [INFO] Iter: 22/100, Ts(iter): 0, Ts(total): 101200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.95s
2025-04-03 21:21:54,561 [__main__] [INFO] Iter: 23/100, Ts(iter): 0, Ts(total): 105800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.51s
2025-04-03 21:21:57,662 [__main__] [INFO] Iter: 24/100, Ts(iter): 0, Ts(total): 110400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.10s
2025-04-03 21:22:00,319 [__main__] [INFO] Iter: 25/100, Ts(iter): 0, Ts(total): 115000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.66s
2025-04-03 21:22:03,214 [__main__] [INFO] Iter: 26/100, Ts(iter): 0, Ts(total): 119600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.89s
2025-04-03 21:22:06,206 [__main__] [INFO] Iter: 27/100, Ts(iter): 0, Ts(total): 124200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:22:09,078 [__main__] [INFO] Iter: 28/100, Ts(iter): 0, Ts(total): 128800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.87s
2025-04-03 21:22:11,978 [__main__] [INFO] Iter: 29/100, Ts(iter): 0, Ts(total): 133400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.90s
2025-04-03 21:22:15,857 [__main__] [INFO] Iter: 30/100, Ts(iter): 0, Ts(total): 138000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.88s
2025-04-03 21:22:15,858 [__main__] [DEBUG] Full result dict at iter 30: {'timers': {'training_iteration': 2.7484482711114158, 'restore_env_runners': 2.0712417173930276e-05, 'training_step': 2.748322231550741, 'env_runner_sampling_timer': 0.32711706679932195, 'learner_update_timer': 2.415170354223672, 'synch_weights': 0.004798881241169109, 'synch_env_connectors': 0.007193539991486862, 'restore_eval_env_runners': 3.894501095055603e-06, 'evaluation_iteration': 3.0874171665364205, 'synch_eval_env_connectors': 0.002135662720068649}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.25369603132646, 'env_step_timer': 0.00014310469937758389, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.07667456145993e-06, 'batch_individual_items': 1.7111616022403054e-05, 'numpy_to_tensor': 2.8891336486984846e-05, 'add_time_dim_to_batch_and_zero_pad': 6.397127212596447e-06, 'add_observations_from_episodes_to_batch': 1.552444645365107e-05, 'add_states_from_episodes_to_batch': 4.114085290350772e-06}}, 'connector_pipeline_timer': 0.00011138328738735386}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 138000, 'target': 138000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.2112847076099791, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1211759396521195e-06, 'module_to_agent_unmapping': 3.591609989538868e-06, 'tensor_to_numpy': 4.7096077389477996e-05, 'listify_data_for_vector_env': 9.271473937087551e-06, 'un_batch_to_individual_items': 2.075407488904544e-05, 'get_actions': 0.0001250015731126835, 'normalize_and_clip_actions': 5.162771227343956e-05}}, 'connector_pipeline_timer': 0.00030138308934046874}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 138000, 'num_module_steps_sampled_lifetime': {'servicer': 138000, 'target': 138000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 29.0, 'rlmodule_inference_timer': 0.0001440435861005635, 'env_to_module_sum_episodes_length_in': 131.25369603132646, 'time_between_sampling': 2.536709746723927, 'num_episodes_lifetime': 138, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -9.18613500431828, 'servicer': -1097.97846814087}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1097.97846814087, 'target': -9.18613500431828}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1107.1646031451885, 'episode_return_max': -1102.0058824614412, 'episode_duration_sec_mean': 0.856131945696214, 'episode_return_min': -1115.3558547993607, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1186.0134847798276}, 'learners': {'servicer': {'mean_kl_loss': 0.007830794900655746, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.65714430809021, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0062500000931322575, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 30.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.439976930618286, 'total_loss': 0.3652324378490448, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 10.725409507751465, 'vf_loss': 0.6119809150695801, 'vf_explained_var': 0.0012969374656677246, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 1390080, 'policy_loss': -0.03228925168514252}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 30.0, 'vf_loss_unclipped': 0.0002674368442967534, 'total_loss': -0.1506117731332779, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 0.0002674368442967534, 'entropy': 2.245851993560791, 'vf_explained_var': 0.013658702373504639, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 1390080, 'policy_loss': -0.10696019977331161, 'mean_kl_loss': 0.00998021475970745, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 4.93214225769043, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19099448973320177, 'timers': {'connectors': {'batch_individual_items': 0.0724777778158005, 'numpy_to_tensor': 0.00019135383678713937, 'add_time_dim_to_batch_and_zero_pad': 2.5548873623517874e-05, 'add_one_ts_to_episodes_and_truncate': 0.005743020672172491, 'add_observations_from_episodes_to_batch': 0.00022357021187180035, 'add_states_from_episodes_to_batch': 7.339681295033207e-06, 'general_advantage_estimation': 0.02997562887434698, 'agent_to_module_mapping': 0.0039042656124453176, 'add_columns_from_episodes_to_train_batch': 0.07821137062914715}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 49956000, 'num_module_steps_trained_lifetime': 2780160, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011319055118297715, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0456403347579646e-06, 'batch_individual_items': 1.2616658934359694e-05, 'numpy_to_tensor': 2.0354447413529337e-05, 'add_time_dim_to_batch_and_zero_pad': 4.621605688393734e-06, 'add_observations_from_episodes_to_batch': 1.2071273830364395e-05, 'add_states_from_episodes_to_batch': 3.0792633775577745e-06}}, 'connector_pipeline_timer': 8.239346531924033e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 15, 'num_agent_steps_sampled_lifetime': {'servicer': 15000, 'target': 15000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.001023416145473e-06, 'agent_to_module_mapping': 6.625052994611906e-06, 'batch_individual_items': 3.058194983575959e-05, 'numpy_to_tensor': 3.408630031583016e-05, 'add_time_dim_to_batch_and_zero_pad': 1.637665878111147e-05, 'add_observations_from_episodes_to_batch': 2.954586089134682e-05}}, 'sample': 2.895625899393431, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.538085747997327e-07, 'module_to_agent_unmapping': 2.6204252443168763e-06, 'tensor_to_numpy': 3.49066650464732e-05, 'listify_data_for_vector_env': 7.041145851788885e-06, 'un_batch_to_individual_items': 1.5023765363827975e-05, 'get_actions': 3.710386029600064e-05, 'normalize_and_clip_actions': 3.82209007280927e-05}}, 'connector_pipeline_timer': 0.0001675189696470617}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.5713633570695895, 'servicer': -1088.1583595137915}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1088.1583595137915, 'target': -1.5713633570695895}, 'num_env_steps_sampled_lifetime': 15000, 'num_module_steps_sampled_lifetime': {'servicer': 15000, 'target': 15000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475349419095146, 'env_reset_timer': 0.00014023025219939882, 'episode_return_mean': -1089.729722870861, 'episode_return_max': -1084.5840687788923, 'weights_seq_no': 29.0, 'episode_duration_sec_mean': 0.5588752067633322, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011382169273858178, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.309273050197, 'time_between_sampling': 29.438578499823702}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 138000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1186.0134847798276, 'done': False, 'training_iteration': 30, 'trial_id': 'default', 'date': '2025-04-03_21-22-15', 'timestamp': 1743729735, 'time_this_iter_s': 3.8659398555755615, 'time_total_s': 91.87463665008545, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 91.87463665008545, 'iterations_since_restore': 30, 'perf': {'cpu_util_percent': 74.21666666666667, 'ram_util_percent': 55.13333333333333}}
2025-04-03 21:22:18,377 [__main__] [INFO] Iter: 31/100, Ts(iter): 0, Ts(total): 142600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.52s
2025-04-03 21:22:21,362 [__main__] [INFO] Iter: 32/100, Ts(iter): 0, Ts(total): 147200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.98s
2025-04-03 21:22:24,281 [__main__] [INFO] Iter: 33/100, Ts(iter): 0, Ts(total): 151800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.92s
2025-04-03 21:22:27,219 [__main__] [INFO] Iter: 34/100, Ts(iter): 0, Ts(total): 156400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.94s
2025-04-03 21:22:30,357 [__main__] [INFO] Iter: 35/100, Ts(iter): 0, Ts(total): 161000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.14s
2025-04-03 21:22:33,315 [__main__] [INFO] Iter: 36/100, Ts(iter): 0, Ts(total): 165600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.96s
2025-04-03 21:22:36,263 [__main__] [INFO] Iter: 37/100, Ts(iter): 0, Ts(total): 170200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.95s
2025-04-03 21:22:39,531 [__main__] [INFO] Iter: 38/100, Ts(iter): 0, Ts(total): 174800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.27s
2025-04-03 21:22:42,573 [__main__] [INFO] Iter: 39/100, Ts(iter): 0, Ts(total): 179400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.04s
2025-04-03 21:22:46,658 [__main__] [INFO] Iter: 40/100, Ts(iter): 0, Ts(total): 184000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.08s
2025-04-03 21:22:46,659 [__main__] [DEBUG] Full result dict at iter 40: {'timers': {'training_iteration': 2.7785323099409363, 'restore_env_runners': 1.9553598797198475e-05, 'training_step': 2.778405698265007, 'env_runner_sampling_timer': 0.317551514891221, 'learner_update_timer': 2.454775599904374, 'synch_weights': 0.004799732911328362, 'synch_env_connectors': 0.007203979104621795, 'restore_eval_env_runners': 3.902225967991399e-06, 'evaluation_iteration': 3.0873416019610205, 'synch_eval_env_connectors': 0.002126886502979658}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27334257051677, 'env_step_timer': 0.0001434255272015321, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.030634579279313e-06, 'batch_individual_items': 1.671928878684755e-05, 'numpy_to_tensor': 2.8649451232167936e-05, 'add_time_dim_to_batch_and_zero_pad': 6.325095942190869e-06, 'add_observations_from_episodes_to_batch': 1.5254794523379597e-05, 'add_states_from_episodes_to_batch': 4.001132249315566e-06}}, 'connector_pipeline_timer': 0.0001096113308952618}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.20792399105946435, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1658165409977364e-06, 'module_to_agent_unmapping': 3.549790553265294e-06, 'tensor_to_numpy': 4.6438369858784744e-05, 'listify_data_for_vector_env': 9.497711605285853e-06, 'un_batch_to_individual_items': 2.0328019040695204e-05, 'get_actions': 0.00012442916668107144, 'normalize_and_clip_actions': 5.0573891132069454e-05}}, 'connector_pipeline_timer': 0.0002995705296154391}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 184000, 'num_module_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 39.0, 'rlmodule_inference_timer': 0.00014418133778442414, 'env_to_module_sum_episodes_length_in': 131.27334257051677, 'time_between_sampling': 2.5650300901786123, 'num_episodes_lifetime': 184, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -6.409692782928113, 'servicer': -1096.1476957524553}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1096.1476957524553, 'target': -6.409692782928113}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1102.557388535383, 'episode_return_max': -1096.073611419149, 'episode_duration_sec_mean': 0.8697623568726197, 'episode_return_min': -1108.5403056760142, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1126.4119597805234}, 'learners': {'servicer': {'mean_kl_loss': 0.0036947678308933973, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.4081494808197021, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0003906250058207661, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 40.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 2.750356674194336, 'total_loss': 0.33388009667396545, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 11.46776008605957, 'vf_loss': 0.5030543208122253, 'vf_explained_var': 0.009409487247467041, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 1853440, 'policy_loss': 0.06017806753516197}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 40.0, 'vf_loss_unclipped': 6.432965165004134e-05, 'total_loss': 0.1460438072681427, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 6.432965165004134e-05, 'entropy': 0.053955934941768646, 'vf_explained_var': 0.08936077356338501, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 1853440, 'policy_loss': 0.14616140723228455, 'mean_kl_loss': 0.008971747942268848, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.7248408794403076, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19125933781250035, 'timers': {'connectors': {'batch_individual_items': 0.07309910972936925, 'numpy_to_tensor': 0.00018983522820542977, 'add_time_dim_to_batch_and_zero_pad': 2.524872400544197e-05, 'add_one_ts_to_episodes_and_truncate': 0.0057307568985758015, 'add_observations_from_episodes_to_batch': 0.00022373201093999268, 'add_states_from_episodes_to_batch': 7.260749674528958e-06, 'general_advantage_estimation': 0.029593715714683243, 'agent_to_module_mapping': 0.003907247272703605, 'add_columns_from_episodes_to_train_batch': 0.07825082639694153}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 66608000, 'num_module_steps_trained_lifetime': 3706880, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011314730728924169, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0457880186093336e-06, 'batch_individual_items': 1.2613112766748814e-05, 'numpy_to_tensor': 2.0348099515281536e-05, 'add_time_dim_to_batch_and_zero_pad': 4.618639013219934e-06, 'add_observations_from_episodes_to_batch': 1.2064804848132109e-05, 'add_states_from_episodes_to_batch': 3.0796173746381142e-06}}, 'connector_pipeline_timer': 8.237053725345829e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 20, 'num_agent_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.001182128426882e-06, 'agent_to_module_mapping': 6.624776775918581e-06, 'batch_individual_items': 3.0580162433715304e-05, 'numpy_to_tensor': 3.408952187998439e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6416998500276094e-05, 'add_observations_from_episodes_to_batch': 2.954704994635511e-05}}, 'sample': 2.895619809328049, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.53458220798402e-07, 'module_to_agent_unmapping': 2.619917406009589e-06, 'tensor_to_numpy': 3.4902390984593604e-05, 'listify_data_for_vector_env': 7.039321379293762e-06, 'un_batch_to_individual_items': 1.50220215030149e-05, 'get_actions': 3.709415747214579e-05, 'normalize_and_clip_actions': 3.820070156552035e-05}}, 'connector_pipeline_timer': 0.00016747800550091183}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.3902352343536892, 'servicer': -1087.2412561361455}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1087.2412561361455, 'target': -1.3902352343536892}, 'num_env_steps_sampled_lifetime': 20000, 'num_module_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.00024755802383713354, 'env_reset_timer': 0.0001402386891123606, 'episode_return_mean': -1088.631491370499, 'episode_return_max': -1080.9746941129663, 'weights_seq_no': 39.0, 'episode_duration_sec_mean': 0.5587808089971077, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011377948596673328, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.310946787257, 'time_between_sampling': 29.438127414314522}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 184000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1126.4119597805234, 'done': False, 'training_iteration': 40, 'trial_id': 'default', 'date': '2025-04-03_21-22-46', 'timestamp': 1743729766, 'time_this_iter_s': 4.070349216461182, 'time_total_s': 122.5363655090332, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 122.5363655090332, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 77.7, 'ram_util_percent': 55.199999999999996}}
2025-04-03 21:22:46,676 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.7785323099409363, 'restore_env_runners': 1.9553598797198475e-05, 'training_step': 2.778405698265007, 'env_runner_sampling_timer': 0.317551514891221, 'learner_update_timer': 2.454775599904374, 'synch_weights': 0.004799732911328362, 'synch_env_connectors': 0.007203979104621795, 'restore_eval_env_runners': 3.902225967991399e-06, 'evaluation_iteration': 3.0873416019610205, 'synch_eval_env_connectors': 0.002126886502979658}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27334257051677, 'env_step_timer': 0.0001434255272015321, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.030634579279313e-06, 'batch_individual_items': 1.671928878684755e-05, 'numpy_to_tensor': 2.8649451232167936e-05, 'add_time_dim_to_batch_and_zero_pad': 6.325095942190869e-06, 'add_observations_from_episodes_to_batch': 1.5254794523379597e-05, 'add_states_from_episodes_to_batch': 4.001132249315566e-06}}, 'connector_pipeline_timer': 0.0001096113308952618}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.20792399105946435, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1658165409977364e-06, 'module_to_agent_unmapping': 3.549790553265294e-06, 'tensor_to_numpy': 4.6438369858784744e-05, 'listify_data_for_vector_env': 9.497711605285853e-06, 'un_batch_to_individual_items': 2.0328019040695204e-05, 'get_actions': 0.00012442916668107144, 'normalize_and_clip_actions': 5.0573891132069454e-05}}, 'connector_pipeline_timer': 0.0002995705296154391}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 184000, 'num_module_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 39.0, 'rlmodule_inference_timer': 0.00014418133778442414, 'env_to_module_sum_episodes_length_in': 131.27334257051677, 'time_between_sampling': 2.5650300901786123, 'num_episodes_lifetime': 184, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -6.409692782928113, 'servicer': -1096.1476957524553}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1096.1476957524553, 'target': -6.409692782928113}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1102.557388535383, 'episode_return_max': -1096.073611419149, 'episode_duration_sec_mean': 0.8697623568726197, 'episode_return_min': -1108.5403056760142, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1126.4119597805234}, 'learners': {'servicer': {'mean_kl_loss': 0.0036947678308933973, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.4081494808197021, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0003906250058207661, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 40.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 2.750356674194336, 'total_loss': 0.33388009667396545, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 11.46776008605957, 'vf_loss': 0.5030543208122253, 'vf_explained_var': 0.009409487247467041, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 1853440, 'policy_loss': 0.06017806753516197}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 40.0, 'vf_loss_unclipped': 6.432965165004134e-05, 'total_loss': 0.1460438072681427, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 6.432965165004134e-05, 'entropy': 0.053955934941768646, 'vf_explained_var': 0.08936077356338501, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 1853440, 'policy_loss': 0.14616140723228455, 'mean_kl_loss': 0.008971747942268848, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.7248408794403076, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19125933781250035, 'timers': {'connectors': {'batch_individual_items': 0.07309910972936925, 'numpy_to_tensor': 0.00018983522820542977, 'add_time_dim_to_batch_and_zero_pad': 2.524872400544197e-05, 'add_one_ts_to_episodes_and_truncate': 0.0057307568985758015, 'add_observations_from_episodes_to_batch': 0.00022373201093999268, 'add_states_from_episodes_to_batch': 7.260749674528958e-06, 'general_advantage_estimation': 0.029593715714683243, 'agent_to_module_mapping': 0.003907247272703605, 'add_columns_from_episodes_to_train_batch': 0.07825082639694153}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 66608000, 'num_module_steps_trained_lifetime': 3706880, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011314730728924169, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0457880186093336e-06, 'batch_individual_items': 1.2613112766748814e-05, 'numpy_to_tensor': 2.0348099515281536e-05, 'add_time_dim_to_batch_and_zero_pad': 4.618639013219934e-06, 'add_observations_from_episodes_to_batch': 1.2064804848132109e-05, 'add_states_from_episodes_to_batch': 3.0796173746381142e-06}}, 'connector_pipeline_timer': 8.237053725345829e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 20, 'num_agent_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.001182128426882e-06, 'agent_to_module_mapping': 6.624776775918581e-06, 'batch_individual_items': 3.0580162433715304e-05, 'numpy_to_tensor': 3.408952187998439e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6416998500276094e-05, 'add_observations_from_episodes_to_batch': 2.954704994635511e-05}}, 'sample': 2.895619809328049, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.53458220798402e-07, 'module_to_agent_unmapping': 2.619917406009589e-06, 'tensor_to_numpy': 3.4902390984593604e-05, 'listify_data_for_vector_env': 7.039321379293762e-06, 'un_batch_to_individual_items': 1.50220215030149e-05, 'get_actions': 3.709415747214579e-05, 'normalize_and_clip_actions': 3.820070156552035e-05}}, 'connector_pipeline_timer': 0.00016747800550091183}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.3902352343536892, 'servicer': -1087.2412561361455}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1087.2412561361455, 'target': -1.3902352343536892}, 'num_env_steps_sampled_lifetime': 20000, 'num_module_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.00024755802383713354, 'env_reset_timer': 0.0001402386891123606, 'episode_return_mean': -1088.631491370499, 'episode_return_max': -1080.9746941129663, 'weights_seq_no': 39.0, 'episode_duration_sec_mean': 0.5587808089971077, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011377948596673328, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.310946787257, 'time_between_sampling': 29.438127414314522}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 184000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1126.4119597805234, 'done': False, 'training_iteration': 40, 'trial_id': 'default', 'date': '2025-04-03_21-22-46', 'timestamp': 1743729766, 'time_this_iter_s': 4.070349216461182, 'time_total_s': 122.5363655090332, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 122.5363655090332, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 77.7, 'ram_util_percent': 55.199999999999996}})
2025-04-03 21:22:49,818 [__main__] [INFO] Iter: 41/100, Ts(iter): 0, Ts(total): 188600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.14s
2025-04-03 21:22:52,884 [__main__] [INFO] Iter: 42/100, Ts(iter): 0, Ts(total): 193200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.07s
2025-04-03 21:22:55,937 [__main__] [INFO] Iter: 43/100, Ts(iter): 0, Ts(total): 197800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.05s
2025-04-03 21:22:59,286 [__main__] [INFO] Iter: 44/100, Ts(iter): 0, Ts(total): 202400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.35s
2025-04-03 21:23:02,194 [__main__] [INFO] Iter: 45/100, Ts(iter): 0, Ts(total): 207000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.91s
2025-04-03 21:23:05,106 [__main__] [INFO] Iter: 46/100, Ts(iter): 0, Ts(total): 211600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.91s
2025-04-03 21:23:08,001 [__main__] [INFO] Iter: 47/100, Ts(iter): 0, Ts(total): 216200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.90s
2025-04-03 21:23:10,637 [__main__] [INFO] Iter: 48/100, Ts(iter): 0, Ts(total): 220800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.64s
2025-04-03 21:23:13,588 [__main__] [INFO] Iter: 49/100, Ts(iter): 0, Ts(total): 225400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.95s
2025-04-03 21:23:17,695 [__main__] [INFO] Iter: 50/100, Ts(iter): 0, Ts(total): 230000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.11s
2025-04-03 21:23:17,696 [__main__] [DEBUG] Full result dict at iter 50: {'timers': {'training_iteration': 2.8073293714579832, 'restore_env_runners': 1.8529210373824e-05, 'training_step': 2.807202619512999, 'env_runner_sampling_timer': 0.3101244735857092, 'learner_update_timer': 2.490962998338628, 'synch_weights': 0.004788351423837287, 'synch_env_connectors': 0.0072075801456557426, 'restore_eval_env_runners': 3.905703595369997e-06, 'evaluation_iteration': 3.086587045111444, 'synch_eval_env_connectors': 0.0021176968080691117}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27528963715886, 'env_step_timer': 0.0001425829180507959, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.008129904847019e-06, 'batch_individual_items': 1.7003052322977276e-05, 'numpy_to_tensor': 2.8402636321515892e-05, 'add_time_dim_to_batch_and_zero_pad': 6.443317838744633e-06, 'add_observations_from_episodes_to_batch': 1.5613805320853404e-05, 'add_states_from_episodes_to_batch': 3.971692360863223e-06}}, 'connector_pipeline_timer': 0.0001102768034733682}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 230000, 'target': 230000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.2053260559294839, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1177441173587373e-06, 'module_to_agent_unmapping': 3.5323305831781515e-06, 'tensor_to_numpy': 4.6513075801452693e-05, 'listify_data_for_vector_env': 9.426273413157106e-06, 'un_batch_to_individual_items': 2.0594972819981875e-05, 'get_actions': 0.00012408298608148488, 'normalize_and_clip_actions': 5.138400893792503e-05}}, 'connector_pipeline_timer': 0.00029924655351677324}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 230000, 'num_module_steps_sampled_lifetime': {'servicer': 230000, 'target': 230000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 49.0, 'rlmodule_inference_timer': 0.0001421947786542752, 'env_to_module_sum_episodes_length_in': 131.27528963715886, 'time_between_sampling': 2.601590648280851, 'num_episodes_lifetime': 230, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -4.421246157583335, 'servicer': -1091.3416781327771}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1091.3416781327771, 'target': -4.421246157583335}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1095.7629242903606, 'episode_return_max': -1092.5855454397674, 'episode_duration_sec_mean': 0.8491762537798977, 'episode_return_min': -1099.292730546199, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1120.2037699359416}, 'learners': {'servicer': {'mean_kl_loss': 0.007501853629946709, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.7452051639556885, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0003906250058207661, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 50.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 1.6536309719085693, 'total_loss': 0.3418149948120117, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 12.855895042419434, 'vf_loss': 0.4899824857711792, 'vf_explained_var': -0.009155988693237305, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 2316800, 'policy_loss': 0.10894748568534851}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 50.0, 'vf_loss_unclipped': 7.729578646831214e-05, 'total_loss': -0.01316078845411539, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 7.729578646831214e-05, 'entropy': -2.1026196479797363, 'vf_explained_var': -0.05946815013885498, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 2316800, 'policy_loss': -0.05705711618065834, 'mean_kl_loss': 0.017666475847363472, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 11.46053695678711, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.10000000149011612}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.191502794881626, 'timers': {'connectors': {'batch_individual_items': 0.07375344527509085, 'numpy_to_tensor': 0.00018814014298773745, 'add_time_dim_to_batch_and_zero_pad': 2.4894663231869648e-05, 'add_one_ts_to_episodes_and_truncate': 0.00571699784091148, 'add_observations_from_episodes_to_batch': 0.00022390843740219268, 'add_states_from_episodes_to_batch': 7.168709672712053e-06, 'general_advantage_estimation': 0.02914936643822838, 'agent_to_module_mapping': 0.0039106932308354105, 'add_columns_from_episodes_to_train_batch': 0.07830005168857737}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 83260000, 'num_module_steps_trained_lifetime': 4633600, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011309118616735563, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0438938995220414e-06, 'batch_individual_items': 1.2614910145367507e-05, 'numpy_to_tensor': 2.033278715498696e-05, 'add_time_dim_to_batch_and_zero_pad': 4.6156988673799035e-06, 'add_observations_from_episodes_to_batch': 1.2058381881798662e-05, 'add_states_from_episodes_to_batch': 3.078478757082019e-06}}, 'connector_pipeline_timer': 8.234117805662794e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 25, 'num_agent_steps_sampled_lifetime': {'servicer': 25000, 'target': 25000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.001108364383365e-06, 'agent_to_module_mapping': 6.624281076720619e-06, 'batch_individual_items': 3.057743168525101e-05, 'numpy_to_tensor': 3.409344958373817e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6455822958629493e-05, 'add_observations_from_episodes_to_batch': 2.9547606535331343e-05}}, 'sample': 2.895606349949036, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.531256606753473e-07, 'module_to_agent_unmapping': 2.6211820462257892e-06, 'tensor_to_numpy': 3.489421526049874e-05, 'listify_data_for_vector_env': 7.037298971448976e-06, 'un_batch_to_individual_items': 1.5021766183632807e-05, 'get_actions': 3.707246835747063e-05, 'normalize_and_clip_actions': 3.818003568038971e-05}}, 'connector_pipeline_timer': 0.0001674217217496798}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.2511643409381294, 'servicer': -1086.424255090919}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1086.424255090919, 'target': -1.2511643409381294}, 'num_env_steps_sampled_lifetime': 25000, 'num_module_steps_sampled_lifetime': {'servicer': 25000, 'target': 25000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475698406320023, 'env_reset_timer': 0.00014024575926200122, 'episode_return_mean': -1087.6754194318573, 'episode_return_max': -1080.8798012930438, 'weights_seq_no': 49.0, 'episode_duration_sec_mean': 0.5581846148509066, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011371035100263614, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3130001637685, 'time_between_sampling': 29.43755407769884}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 230000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1120.2037699359416, 'done': False, 'training_iteration': 50, 'trial_id': 'default', 'date': '2025-04-03_21-23-17', 'timestamp': 1743729797, 'time_this_iter_s': 4.093424081802368, 'time_total_s': 153.42183184623718, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 153.42183184623718, 'iterations_since_restore': 50, 'perf': {'cpu_util_percent': 76.32, 'ram_util_percent': 55.220000000000006}}
2025-04-03 21:23:20,700 [__main__] [INFO] Iter: 51/100, Ts(iter): 0, Ts(total): 234600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.00s
2025-04-03 21:23:23,745 [__main__] [INFO] Iter: 52/100, Ts(iter): 0, Ts(total): 239200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.05s
2025-04-03 21:23:26,425 [__main__] [INFO] Iter: 53/100, Ts(iter): 0, Ts(total): 243800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.68s
2025-04-03 21:23:29,411 [__main__] [INFO] Iter: 54/100, Ts(iter): 0, Ts(total): 248400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:23:32,523 [__main__] [INFO] Iter: 55/100, Ts(iter): 0, Ts(total): 253000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:23:35,372 [__main__] [INFO] Iter: 56/100, Ts(iter): 0, Ts(total): 257600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.85s
2025-04-03 21:23:38,483 [__main__] [INFO] Iter: 57/100, Ts(iter): 0, Ts(total): 262200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:23:41,182 [__main__] [INFO] Iter: 58/100, Ts(iter): 0, Ts(total): 266800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.70s
2025-04-03 21:23:44,202 [__main__] [INFO] Iter: 59/100, Ts(iter): 0, Ts(total): 271400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:23:48,251 [__main__] [INFO] Iter: 60/100, Ts(iter): 0, Ts(total): 276000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.05s
2025-04-03 21:23:48,251 [__main__] [DEBUG] Full result dict at iter 60: {'timers': {'training_iteration': 2.8291165184370426, 'restore_env_runners': 1.7577288953779945e-05, 'training_step': 2.8289892945100346, 'env_runner_sampling_timer': 0.3014615657285246, 'learner_update_timer': 2.5213698978916455, 'synch_weights': 0.004782998694840092, 'synch_env_connectors': 0.007245365995295494, 'restore_eval_env_runners': 3.960816513952779e-06, 'evaluation_iteration': 3.0862756246603835, 'synch_eval_env_connectors': 0.0021088290099672553}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27548260083915, 'env_step_timer': 0.00014391544525863548, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.080120919442346e-06, 'batch_individual_items': 1.685803812105825e-05, 'numpy_to_tensor': 2.8837757015184925e-05, 'add_time_dim_to_batch_and_zero_pad': 6.3181467078433575e-06, 'add_observations_from_episodes_to_batch': 1.5616105354982433e-05, 'add_states_from_episodes_to_batch': 3.99266684197427e-06}}, 'connector_pipeline_timer': 0.0001111950929103656}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.20236363473478006, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.132135578317793e-06, 'module_to_agent_unmapping': 3.690486709419115e-06, 'tensor_to_numpy': 4.6912882811657335e-05, 'listify_data_for_vector_env': 9.191720315030639e-06, 'un_batch_to_individual_items': 2.0942723687994137e-05, 'get_actions': 0.0001243950286110361, 'normalize_and_clip_actions': 5.0455894576542e-05}}, 'connector_pipeline_timer': 0.0002993521846132648}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 276000, 'num_module_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 59.0, 'rlmodule_inference_timer': 0.00014322825989611973, 'env_to_module_sum_episodes_length_in': 131.27548260083915, 'time_between_sampling': 2.628440470575835, 'num_episodes_lifetime': 276, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -3.174927994736835, 'servicer': -1093.969434616046}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1093.969434616046, 'target': -3.174927994736835}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1097.1443626107832, 'episode_return_max': -1094.8813877561101, 'episode_duration_sec_mean': 0.8679664527830344, 'episode_return_min': -1099.0946718789223, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1134.0176281470335}, 'learners': {'servicer': {'mean_kl_loss': 0.0059152632020413876, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.3803181648254395, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0003906250058207661, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 60.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 2.8626604080200195, 'total_loss': 0.18269430100917816, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 13.939949035644531, 'vf_loss': 0.38303378224372864, 'vf_explained_var': 0.011474967002868652, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 2780160, 'policy_loss': 0.07845722138881683}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 60.0, 'vf_loss_unclipped': 2.4350978492293507e-05, 'total_loss': 0.2529577910900116, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 2.4350978492293507e-05, 'entropy': -4.161376953125, 'vf_explained_var': 0.012602269649505615, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 2780160, 'policy_loss': 0.1669541448354721, 'mean_kl_loss': 0.012230080552399158, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 11.63060188293457, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.22500000894069672}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19176927157494206, 'timers': {'connectors': {'batch_individual_items': 0.0744874689172011, 'numpy_to_tensor': 0.00018625707374015458, 'add_time_dim_to_batch_and_zero_pad': 2.449515086369677e-05, 'add_one_ts_to_episodes_and_truncate': 0.005701550240993754, 'add_observations_from_episodes_to_batch': 0.000224087512044337, 'add_states_from_episodes_to_batch': 7.066958924516639e-06, 'general_advantage_estimation': 0.028651498764499437, 'agent_to_module_mapping': 0.003914354482776385, 'add_columns_from_episodes_to_train_batch': 0.07834825715097336}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 99912000, 'num_module_steps_trained_lifetime': 5560320, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011304235039646498, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0417690248766635e-06, 'batch_individual_items': 1.2609165954067655e-05, 'numpy_to_tensor': 2.0315531261191798e-05, 'add_time_dim_to_batch_and_zero_pad': 4.61191257809545e-06, 'add_observations_from_episodes_to_batch': 1.2049009446988238e-05, 'add_states_from_episodes_to_batch': 3.0764011419291385e-06}}, 'connector_pipeline_timer': 8.229555517786166e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 30, 'num_agent_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.000790057892276e-06, 'agent_to_module_mapping': 6.623586913619683e-06, 'batch_individual_items': 3.05737267360628e-05, 'numpy_to_tensor': 3.409813558189353e-05, 'add_time_dim_to_batch_and_zero_pad': 1.649324592808225e-05, 'add_observations_from_episodes_to_batch': 2.954775978667287e-05}}, 'sample': 2.895587043714171, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.525573486134523e-07, 'module_to_agent_unmapping': 2.6194820341136827e-06, 'tensor_to_numpy': 3.487889624486644e-05, 'listify_data_for_vector_env': 7.034328862304003e-06, 'un_batch_to_individual_items': 1.5015927884678722e-05, 'get_actions': 3.704965510632134e-05, 'normalize_and_clip_actions': 3.8150050774095336e-05}}, 'connector_pipeline_timer': 0.00016733442989192256}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.0895618890989558, 'servicer': -1085.5533938285753}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1085.5533938285753, 'target': -1.0895618890989558}, 'num_env_steps_sampled_lifetime': 30000, 'num_module_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475712402889767, 'env_reset_timer': 0.00014025073083959332, 'episode_return_mean': -1086.6429557176746, 'episode_return_max': -1080.8798012930438, 'weights_seq_no': 59.0, 'episode_duration_sec_mean': 0.5573311436282529, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011364496946454372, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3189921273417, 'time_between_sampling': 29.436830736082342}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 276000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1134.0176281470335, 'done': False, 'training_iteration': 60, 'trial_id': 'default', 'date': '2025-04-03_21-23-48', 'timestamp': 1743729828, 'time_this_iter_s': 4.035305976867676, 'time_total_s': 183.84239172935486, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 183.84239172935486, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 75.61666666666666, 'ram_util_percent': 55.199999999999996}}
2025-04-03 21:23:48,270 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.8291165184370426, 'restore_env_runners': 1.7577288953779945e-05, 'training_step': 2.8289892945100346, 'env_runner_sampling_timer': 0.3014615657285246, 'learner_update_timer': 2.5213698978916455, 'synch_weights': 0.004782998694840092, 'synch_env_connectors': 0.007245365995295494, 'restore_eval_env_runners': 3.960816513952779e-06, 'evaluation_iteration': 3.0862756246603835, 'synch_eval_env_connectors': 0.0021088290099672553}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27548260083915, 'env_step_timer': 0.00014391544525863548, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.080120919442346e-06, 'batch_individual_items': 1.685803812105825e-05, 'numpy_to_tensor': 2.8837757015184925e-05, 'add_time_dim_to_batch_and_zero_pad': 6.3181467078433575e-06, 'add_observations_from_episodes_to_batch': 1.5616105354982433e-05, 'add_states_from_episodes_to_batch': 3.99266684197427e-06}}, 'connector_pipeline_timer': 0.0001111950929103656}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.20236363473478006, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.132135578317793e-06, 'module_to_agent_unmapping': 3.690486709419115e-06, 'tensor_to_numpy': 4.6912882811657335e-05, 'listify_data_for_vector_env': 9.191720315030639e-06, 'un_batch_to_individual_items': 2.0942723687994137e-05, 'get_actions': 0.0001243950286110361, 'normalize_and_clip_actions': 5.0455894576542e-05}}, 'connector_pipeline_timer': 0.0002993521846132648}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 276000, 'num_module_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 59.0, 'rlmodule_inference_timer': 0.00014322825989611973, 'env_to_module_sum_episodes_length_in': 131.27548260083915, 'time_between_sampling': 2.628440470575835, 'num_episodes_lifetime': 276, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -3.174927994736835, 'servicer': -1093.969434616046}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1093.969434616046, 'target': -3.174927994736835}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1097.1443626107832, 'episode_return_max': -1094.8813877561101, 'episode_duration_sec_mean': 0.8679664527830344, 'episode_return_min': -1099.0946718789223, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1134.0176281470335}, 'learners': {'servicer': {'mean_kl_loss': 0.0059152632020413876, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.3803181648254395, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0003906250058207661, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 60.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 2.8626604080200195, 'total_loss': 0.18269430100917816, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 13.939949035644531, 'vf_loss': 0.38303378224372864, 'vf_explained_var': 0.011474967002868652, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 2780160, 'policy_loss': 0.07845722138881683}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 60.0, 'vf_loss_unclipped': 2.4350978492293507e-05, 'total_loss': 0.2529577910900116, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 2.4350978492293507e-05, 'entropy': -4.161376953125, 'vf_explained_var': 0.012602269649505615, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 2780160, 'policy_loss': 0.1669541448354721, 'mean_kl_loss': 0.012230080552399158, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 11.63060188293457, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.22500000894069672}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19176927157494206, 'timers': {'connectors': {'batch_individual_items': 0.0744874689172011, 'numpy_to_tensor': 0.00018625707374015458, 'add_time_dim_to_batch_and_zero_pad': 2.449515086369677e-05, 'add_one_ts_to_episodes_and_truncate': 0.005701550240993754, 'add_observations_from_episodes_to_batch': 0.000224087512044337, 'add_states_from_episodes_to_batch': 7.066958924516639e-06, 'general_advantage_estimation': 0.028651498764499437, 'agent_to_module_mapping': 0.003914354482776385, 'add_columns_from_episodes_to_train_batch': 0.07834825715097336}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 99912000, 'num_module_steps_trained_lifetime': 5560320, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011304235039646498, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0417690248766635e-06, 'batch_individual_items': 1.2609165954067655e-05, 'numpy_to_tensor': 2.0315531261191798e-05, 'add_time_dim_to_batch_and_zero_pad': 4.61191257809545e-06, 'add_observations_from_episodes_to_batch': 1.2049009446988238e-05, 'add_states_from_episodes_to_batch': 3.0764011419291385e-06}}, 'connector_pipeline_timer': 8.229555517786166e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 30, 'num_agent_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.000790057892276e-06, 'agent_to_module_mapping': 6.623586913619683e-06, 'batch_individual_items': 3.05737267360628e-05, 'numpy_to_tensor': 3.409813558189353e-05, 'add_time_dim_to_batch_and_zero_pad': 1.649324592808225e-05, 'add_observations_from_episodes_to_batch': 2.954775978667287e-05}}, 'sample': 2.895587043714171, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.525573486134523e-07, 'module_to_agent_unmapping': 2.6194820341136827e-06, 'tensor_to_numpy': 3.487889624486644e-05, 'listify_data_for_vector_env': 7.034328862304003e-06, 'un_batch_to_individual_items': 1.5015927884678722e-05, 'get_actions': 3.704965510632134e-05, 'normalize_and_clip_actions': 3.8150050774095336e-05}}, 'connector_pipeline_timer': 0.00016733442989192256}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -1.0895618890989558, 'servicer': -1085.5533938285753}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1085.5533938285753, 'target': -1.0895618890989558}, 'num_env_steps_sampled_lifetime': 30000, 'num_module_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475712402889767, 'env_reset_timer': 0.00014025073083959332, 'episode_return_mean': -1086.6429557176746, 'episode_return_max': -1080.8798012930438, 'weights_seq_no': 59.0, 'episode_duration_sec_mean': 0.5573311436282529, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011364496946454372, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3189921273417, 'time_between_sampling': 29.436830736082342}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 276000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1134.0176281470335, 'done': False, 'training_iteration': 60, 'trial_id': 'default', 'date': '2025-04-03_21-23-48', 'timestamp': 1743729828, 'time_this_iter_s': 4.035305976867676, 'time_total_s': 183.84239172935486, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 183.84239172935486, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 75.61666666666666, 'ram_util_percent': 55.199999999999996}})
2025-04-03 21:23:51,229 [__main__] [INFO] Iter: 61/100, Ts(iter): 0, Ts(total): 280600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.96s
2025-04-03 21:23:54,369 [__main__] [INFO] Iter: 62/100, Ts(iter): 0, Ts(total): 285200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.14s
2025-04-03 21:23:57,481 [__main__] [INFO] Iter: 63/100, Ts(iter): 0, Ts(total): 289800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:24:00,448 [__main__] [INFO] Iter: 64/100, Ts(iter): 0, Ts(total): 294400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.97s
2025-04-03 21:24:03,616 [__main__] [INFO] Iter: 65/100, Ts(iter): 0, Ts(total): 299000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.17s
2025-04-03 21:24:06,486 [__main__] [INFO] Iter: 66/100, Ts(iter): 0, Ts(total): 303600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.87s
2025-04-03 21:24:09,328 [__main__] [INFO] Iter: 67/100, Ts(iter): 0, Ts(total): 308200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.84s
2025-04-03 21:24:12,270 [__main__] [INFO] Iter: 68/100, Ts(iter): 0, Ts(total): 312800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.94s
2025-04-03 21:24:15,285 [__main__] [INFO] Iter: 69/100, Ts(iter): 0, Ts(total): 317400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:24:19,305 [__main__] [INFO] Iter: 70/100, Ts(iter): 0, Ts(total): 322000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.02s
2025-04-03 21:24:19,305 [__main__] [DEBUG] Full result dict at iter 70: {'timers': {'training_iteration': 2.853189318334373, 'restore_env_runners': 1.6805727161864166e-05, 'training_step': 2.8530609208122897, 'env_runner_sampling_timer': 0.29523438222789894, 'learner_update_timer': 2.551626670532774, 'synch_weights': 0.00479369892324724, 'synch_env_connectors': 0.0073014676130611815, 'restore_eval_env_runners': 3.985798334226729e-06, 'evaluation_iteration': 3.0860951717437386, 'synch_eval_env_connectors': 0.002104021969858735}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27550172446908, 'env_step_timer': 0.00014953715000973233, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.259391581403542e-06, 'batch_individual_items': 1.75464431029129e-05, 'numpy_to_tensor': 2.988258576896843e-05, 'add_time_dim_to_batch_and_zero_pad': 6.572146944434933e-06, 'add_observations_from_episodes_to_batch': 1.657974285344818e-05, 'add_states_from_episodes_to_batch': 4.088319373582772e-06}}, 'connector_pipeline_timer': 0.00011570763787155767}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 322000, 'target': 322000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.20018019628223638, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1642289570846158e-06, 'module_to_agent_unmapping': 3.7055373454146423e-06, 'tensor_to_numpy': 4.9615071895227e-05, 'listify_data_for_vector_env': 9.403522739958753e-06, 'un_batch_to_individual_items': 2.1256525405171553e-05, 'get_actions': 0.00012993304892005962, 'normalize_and_clip_actions': 5.2942190231547083e-05}}, 'connector_pipeline_timer': 0.0003126246756549432}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 322000, 'num_module_steps_sampled_lifetime': {'servicer': 322000, 'target': 322000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 69.0, 'rlmodule_inference_timer': 0.0001513838190070944, 'env_to_module_sum_episodes_length_in': 131.27550172446908, 'time_between_sampling': 2.6558505519882867, 'num_episodes_lifetime': 322, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -2.2805023356786243, 'servicer': -1096.3032792758488}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1096.3032792758488, 'target': -2.2805023356786243}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1098.5837816115272, 'episode_return_max': -1096.39721921613, 'episode_duration_sec_mean': 0.9288667426988704, 'episode_return_min': -1100.5351531857177, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1143.143153297238}, 'learners': {'servicer': {'mean_kl_loss': 0.006764611694961786, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.3625850677490234, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.0003906250058207661, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 70.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 1.9554998874664307, 'total_loss': 0.26732438802719116, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 14.951576232910156, 'vf_loss': 0.49064746499061584, 'vf_explained_var': 0.010296881198883057, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 3243520, 'policy_loss': 0.07570580393075943}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 70.0, 'vf_loss_unclipped': 1.6863774362718686e-05, 'total_loss': 0.0804181843996048, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 1.6863774362718686e-05, 'entropy': -6.0273118019104, 'vf_explained_var': 0.04402869939804077, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 3243520, 'policy_loss': -0.060531135648489, 'mean_kl_loss': 0.02684604935348034, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 40.03138732910156, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 1.139062523841858}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19203453116051308, 'timers': {'connectors': {'batch_individual_items': 0.0752660200362584, 'numpy_to_tensor': 0.0001842019473888062, 'add_time_dim_to_batch_and_zero_pad': 2.407163365969166e-05, 'add_one_ts_to_episodes_and_truncate': 0.00568376890176427, 'add_observations_from_episodes_to_batch': 0.00022414086709197833, 'add_states_from_episodes_to_batch': 6.958779144852221e-06, 'general_advantage_estimation': 0.028113956507134878, 'agent_to_module_mapping': 0.0039191218689161225, 'add_columns_from_episodes_to_train_batch': 0.07839226335936023}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 116564000, 'num_module_steps_trained_lifetime': 6487040, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.000112942946182926, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0386742831612685e-06, 'batch_individual_items': 1.259525041215028e-05, 'numpy_to_tensor': 2.0290029003166395e-05, 'add_time_dim_to_batch_and_zero_pad': 4.6051452914848495e-06, 'add_observations_from_episodes_to_batch': 1.2031108177433657e-05, 'add_states_from_episodes_to_batch': 3.0748044809006534e-06}}, 'connector_pipeline_timer': 8.221206478919033e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 35, 'num_agent_steps_sampled_lifetime': {'servicer': 35000, 'target': 35000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 6.00021550635408e-06, 'agent_to_module_mapping': 6.622669204543679e-06, 'batch_individual_items': 3.05690839426097e-05, 'numpy_to_tensor': 3.410322681613255e-05, 'add_time_dim_to_batch_and_zero_pad': 1.652913735514163e-05, 'add_observations_from_episodes_to_batch': 2.9547446912040334e-05}}, 'sample': 2.895562016664909, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.516477508193289e-07, 'module_to_agent_unmapping': 2.6170590403914457e-06, 'tensor_to_numpy': 3.4857680112860955e-05, 'listify_data_for_vector_env': 7.029914614807268e-06, 'un_batch_to_individual_items': 1.5009430182581705e-05, 'get_actions': 3.7008505399635305e-05, 'normalize_and_clip_actions': 3.810967195157306e-05}}, 'connector_pipeline_timer': 0.00016720231498976613}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.8580072348527601, 'servicer': -1084.3770367517427}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1084.3770367517427, 'target': -0.8580072348527601}, 'num_env_steps_sampled_lifetime': 35000, 'num_module_steps_sampled_lifetime': {'servicer': 35000, 'target': 35000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475615966697166, 'env_reset_timer': 0.00014025336180996682, 'episode_return_mean': -1085.2350439865957, 'episode_return_max': -1080.8798012930438, 'weights_seq_no': 69.0, 'episode_duration_sec_mean': 0.5566480986692477, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.0001135267313020465, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3265587426793, 'time_between_sampling': 29.436004193457105}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 322000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1143.143153297238, 'done': False, 'training_iteration': 70, 'trial_id': 'default', 'date': '2025-04-03_21-24-19', 'timestamp': 1743729859, 'time_this_iter_s': 4.006596088409424, 'time_total_s': 214.736718416214, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 214.736718416214, 'iterations_since_restore': 70, 'perf': {'cpu_util_percent': 76.38333333333334, 'ram_util_percent': 55.28333333333333}}
2025-04-03 21:24:22,388 [__main__] [INFO] Iter: 71/100, Ts(iter): 0, Ts(total): 326600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.08s
2025-04-03 21:24:25,379 [__main__] [INFO] Iter: 72/100, Ts(iter): 0, Ts(total): 331200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:24:28,421 [__main__] [INFO] Iter: 73/100, Ts(iter): 0, Ts(total): 335800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.04s
2025-04-03 21:24:31,352 [__main__] [INFO] Iter: 74/100, Ts(iter): 0, Ts(total): 340400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.93s
2025-04-03 21:24:34,246 [__main__] [INFO] Iter: 75/100, Ts(iter): 0, Ts(total): 345000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.89s
2025-04-03 21:24:37,155 [__main__] [INFO] Iter: 76/100, Ts(iter): 0, Ts(total): 349600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.91s
2025-04-03 21:24:39,917 [__main__] [INFO] Iter: 77/100, Ts(iter): 0, Ts(total): 354200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.76s
2025-04-03 21:24:42,941 [__main__] [INFO] Iter: 78/100, Ts(iter): 0, Ts(total): 358800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:24:45,936 [__main__] [INFO] Iter: 79/100, Ts(iter): 0, Ts(total): 363400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:24:50,017 [__main__] [INFO] Iter: 80/100, Ts(iter): 0, Ts(total): 368000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.08s
2025-04-03 21:24:50,017 [__main__] [DEBUG] Full result dict at iter 80: {'timers': {'training_iteration': 2.8720603105842297, 'restore_env_runners': 1.5983336198626836e-05, 'training_step': 2.8719322222610817, 'env_runner_sampling_timer': 0.28905705632815615, 'learner_update_timer': 2.576630286832129, 'synch_weights': 0.004805657576192035, 'synch_env_connectors': 0.007286019403856992, 'restore_eval_env_runners': 4.017610425133148e-06, 'evaluation_iteration': 3.086509735856358, 'synch_eval_env_connectors': 0.0021018625801901046}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.2755036197129, 'env_step_timer': 0.00015115190350446556, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.2903995086546505e-06, 'batch_individual_items': 1.7847266390037525e-05, 'numpy_to_tensor': 2.9646705236563982e-05, 'add_time_dim_to_batch_and_zero_pad': 6.5428895380593165e-06, 'add_observations_from_episodes_to_batch': 1.732322298965404e-05, 'add_states_from_episodes_to_batch': 4.162015691361117e-06}}, 'connector_pipeline_timer': 0.00011617093888919707}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.19839999163165933, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1880490725301717e-06, 'module_to_agent_unmapping': 3.79656471579723e-06, 'tensor_to_numpy': 4.9288138600539445e-05, 'listify_data_for_vector_env': 9.707966642837337e-06, 'un_batch_to_individual_items': 2.134857752032867e-05, 'get_actions': 0.00013046952800620416, 'normalize_and_clip_actions': 5.22805287797189e-05}}, 'connector_pipeline_timer': 0.00031390649708157916}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 368000, 'num_module_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 79.0, 'rlmodule_inference_timer': 0.00015065524705651395, 'env_to_module_sum_episodes_length_in': 131.2755036197129, 'time_between_sampling': 2.6782606564859663, 'num_episodes_lifetime': 368, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -1.8795472769649784, 'servicer': -1089.8193336946836}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1089.8193336946836, 'target': -1.8795472769649784}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1091.6988809716486, 'episode_return_max': -1090.0252644317875, 'episode_duration_sec_mean': 0.8958577573465172, 'episode_return_min': -1092.8299560226249, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1127.5792264976726}, 'learners': {'servicer': {'mean_kl_loss': 0.006328707095235586, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.8559937477111816, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.00019531250291038305, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 80.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.210973024368286, 'total_loss': 0.18078993260860443, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 15.936217308044434, 'vf_loss': 0.49014490842819214, 'vf_explained_var': 0.004191160202026367, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 3706880, 'policy_loss': 0.009368146769702435}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 80.0, 'vf_loss_unclipped': 7.643775461474434e-06, 'total_loss': 0.19243939220905304, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 7.643775461474434e-06, 'entropy': -7.2094244956970215, 'vf_explained_var': 0.13855814933776855, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 3706880, 'policy_loss': 0.038788314908742905, 'mean_kl_loss': 0.01660131849348545, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 31.807857513427734, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.569531261920929}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19230710054465971, 'timers': {'connectors': {'batch_individual_items': 0.07608611994714075, 'numpy_to_tensor': 0.0001820730539768471, 'add_time_dim_to_batch_and_zero_pad': 2.3630726236818765e-05, 'add_one_ts_to_episodes_and_truncate': 0.0056648360206762215, 'add_observations_from_episodes_to_batch': 0.00022435038969202025, 'add_states_from_episodes_to_batch': 6.845836060577987e-06, 'general_advantage_estimation': 0.027547082546334308, 'agent_to_module_mapping': 0.003924373416225848, 'add_columns_from_episodes_to_train_batch': 0.07843217574146102}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 133216000, 'num_module_steps_trained_lifetime': 7413760, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011287122887738224, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.036564334943833e-06, 'batch_individual_items': 1.2585708934162321e-05, 'numpy_to_tensor': 2.0269523789310602e-05, 'add_time_dim_to_batch_and_zero_pad': 4.599818306986554e-06, 'add_observations_from_episodes_to_batch': 1.2017952388809198e-05, 'add_states_from_episodes_to_batch': 3.0727084386280107e-06}}, 'connector_pipeline_timer': 8.214673720469019e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 40, 'num_agent_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 5.9993981669128135e-06, 'agent_to_module_mapping': 6.621615891220166e-06, 'batch_individual_items': 3.0563539132049834e-05, 'numpy_to_tensor': 3.410921891225814e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6563728328109005e-05, 'add_observations_from_episodes_to_batch': 2.9546560519543904e-05}}, 'sample': 2.895539905052261, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.509690003238476e-07, 'module_to_agent_unmapping': 2.615166518418704e-06, 'tensor_to_numpy': 3.484680940017689e-05, 'listify_data_for_vector_env': 7.027189714852238e-06, 'un_batch_to_individual_items': 1.5003543448191665e-05, 'get_actions': 3.698043650242074e-05, 'normalize_and_clip_actions': 3.80803250955362e-05}}, 'connector_pipeline_timer': 0.00016710983577174093}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.7396298380158833, 'servicer': -1083.5769506820554}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1083.5769506820554, 'target': -0.7396298380158833}, 'num_env_steps_sampled_lifetime': 40000, 'num_module_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475419637991995, 'env_reset_timer': 0.00014025549008789704, 'episode_return_mean': -1084.3165805200715, 'episode_return_max': -1078.9954447608318, 'weights_seq_no': 79.0, 'episode_duration_sec_mean': 0.5556911749599385, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011343077499194408, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3349969969872, 'time_between_sampling': 29.435029541402365}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 368000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1127.5792264976726, 'done': False, 'training_iteration': 80, 'trial_id': 'default', 'date': '2025-04-03_21-24-50', 'timestamp': 1743729890, 'time_this_iter_s': 4.066218137741089, 'time_total_s': 245.31302976608276, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 245.31302976608276, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 76.56666666666668, 'ram_util_percent': 55.21666666666667}}
2025-04-03 21:24:50,036 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.8720603105842297, 'restore_env_runners': 1.5983336198626836e-05, 'training_step': 2.8719322222610817, 'env_runner_sampling_timer': 0.28905705632815615, 'learner_update_timer': 2.576630286832129, 'synch_weights': 0.004805657576192035, 'synch_env_connectors': 0.007286019403856992, 'restore_eval_env_runners': 4.017610425133148e-06, 'evaluation_iteration': 3.086509735856358, 'synch_eval_env_connectors': 0.0021018625801901046}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.2755036197129, 'env_step_timer': 0.00015115190350446556, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.2903995086546505e-06, 'batch_individual_items': 1.7847266390037525e-05, 'numpy_to_tensor': 2.9646705236563982e-05, 'add_time_dim_to_batch_and_zero_pad': 6.5428895380593165e-06, 'add_observations_from_episodes_to_batch': 1.732322298965404e-05, 'add_states_from_episodes_to_batch': 4.162015691361117e-06}}, 'connector_pipeline_timer': 0.00011617093888919707}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.19839999163165933, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1880490725301717e-06, 'module_to_agent_unmapping': 3.79656471579723e-06, 'tensor_to_numpy': 4.9288138600539445e-05, 'listify_data_for_vector_env': 9.707966642837337e-06, 'un_batch_to_individual_items': 2.134857752032867e-05, 'get_actions': 0.00013046952800620416, 'normalize_and_clip_actions': 5.22805287797189e-05}}, 'connector_pipeline_timer': 0.00031390649708157916}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 368000, 'num_module_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 79.0, 'rlmodule_inference_timer': 0.00015065524705651395, 'env_to_module_sum_episodes_length_in': 131.2755036197129, 'time_between_sampling': 2.6782606564859663, 'num_episodes_lifetime': 368, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -1.8795472769649784, 'servicer': -1089.8193336946836}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1089.8193336946836, 'target': -1.8795472769649784}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1091.6988809716486, 'episode_return_max': -1090.0252644317875, 'episode_duration_sec_mean': 0.8958577573465172, 'episode_return_min': -1092.8299560226249, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1127.5792264976726}, 'learners': {'servicer': {'mean_kl_loss': 0.006328707095235586, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 1.8559937477111816, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.00019531250291038305, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 80.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.210973024368286, 'total_loss': 0.18078993260860443, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 15.936217308044434, 'vf_loss': 0.49014490842819214, 'vf_explained_var': 0.004191160202026367, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 3706880, 'policy_loss': 0.009368146769702435}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 80.0, 'vf_loss_unclipped': 7.643775461474434e-06, 'total_loss': 0.19243939220905304, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 7.643775461474434e-06, 'entropy': -7.2094244956970215, 'vf_explained_var': 0.13855814933776855, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 3706880, 'policy_loss': 0.038788314908742905, 'mean_kl_loss': 0.01660131849348545, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 31.807857513427734, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.569531261920929}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19230710054465971, 'timers': {'connectors': {'batch_individual_items': 0.07608611994714075, 'numpy_to_tensor': 0.0001820730539768471, 'add_time_dim_to_batch_and_zero_pad': 2.3630726236818765e-05, 'add_one_ts_to_episodes_and_truncate': 0.0056648360206762215, 'add_observations_from_episodes_to_batch': 0.00022435038969202025, 'add_states_from_episodes_to_batch': 6.845836060577987e-06, 'general_advantage_estimation': 0.027547082546334308, 'agent_to_module_mapping': 0.003924373416225848, 'add_columns_from_episodes_to_train_batch': 0.07843217574146102}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 133216000, 'num_module_steps_trained_lifetime': 7413760, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011287122887738224, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.036564334943833e-06, 'batch_individual_items': 1.2585708934162321e-05, 'numpy_to_tensor': 2.0269523789310602e-05, 'add_time_dim_to_batch_and_zero_pad': 4.599818306986554e-06, 'add_observations_from_episodes_to_batch': 1.2017952388809198e-05, 'add_states_from_episodes_to_batch': 3.0727084386280107e-06}}, 'connector_pipeline_timer': 8.214673720469019e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 40, 'num_agent_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 5.9993981669128135e-06, 'agent_to_module_mapping': 6.621615891220166e-06, 'batch_individual_items': 3.0563539132049834e-05, 'numpy_to_tensor': 3.410921891225814e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6563728328109005e-05, 'add_observations_from_episodes_to_batch': 2.9546560519543904e-05}}, 'sample': 2.895539905052261, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.509690003238476e-07, 'module_to_agent_unmapping': 2.615166518418704e-06, 'tensor_to_numpy': 3.484680940017689e-05, 'listify_data_for_vector_env': 7.027189714852238e-06, 'un_batch_to_individual_items': 1.5003543448191665e-05, 'get_actions': 3.698043650242074e-05, 'normalize_and_clip_actions': 3.80803250955362e-05}}, 'connector_pipeline_timer': 0.00016710983577174093}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.7396298380158833, 'servicer': -1083.5769506820554}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1083.5769506820554, 'target': -0.7396298380158833}, 'num_env_steps_sampled_lifetime': 40000, 'num_module_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002475419637991995, 'env_reset_timer': 0.00014025549008789704, 'episode_return_mean': -1084.3165805200715, 'episode_return_max': -1078.9954447608318, 'weights_seq_no': 79.0, 'episode_duration_sec_mean': 0.5556911749599385, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011343077499194408, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3349969969872, 'time_between_sampling': 29.435029541402365}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 368000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1127.5792264976726, 'done': False, 'training_iteration': 80, 'trial_id': 'default', 'date': '2025-04-03_21-24-50', 'timestamp': 1743729890, 'time_this_iter_s': 4.066218137741089, 'time_total_s': 245.31302976608276, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 245.31302976608276, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 76.56666666666668, 'ram_util_percent': 55.21666666666667}})
2025-04-03 21:24:53,168 [__main__] [INFO] Iter: 81/100, Ts(iter): 0, Ts(total): 372600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.13s
2025-04-03 21:24:56,161 [__main__] [INFO] Iter: 82/100, Ts(iter): 0, Ts(total): 377200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:24:59,098 [__main__] [INFO] Iter: 83/100, Ts(iter): 0, Ts(total): 381800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.94s
2025-04-03 21:25:02,192 [__main__] [INFO] Iter: 84/100, Ts(iter): 0, Ts(total): 386400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.09s
2025-04-03 21:25:05,196 [__main__] [INFO] Iter: 85/100, Ts(iter): 0, Ts(total): 391000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.00s
2025-04-03 21:25:08,144 [__main__] [INFO] Iter: 86/100, Ts(iter): 0, Ts(total): 395600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.95s
2025-04-03 21:25:11,194 [__main__] [INFO] Iter: 87/100, Ts(iter): 0, Ts(total): 400200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.05s
2025-04-03 21:25:14,238 [__main__] [INFO] Iter: 88/100, Ts(iter): 0, Ts(total): 404800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.04s
2025-04-03 21:25:17,339 [__main__] [INFO] Iter: 89/100, Ts(iter): 0, Ts(total): 409400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.10s
2025-04-03 21:25:21,141 [__main__] [INFO] Iter: 90/100, Ts(iter): 0, Ts(total): 414000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.80s
2025-04-03 21:25:21,141 [__main__] [DEBUG] Full result dict at iter 90: {'timers': {'training_iteration': 2.892776568460267, 'restore_env_runners': 1.5305456420150735e-05, 'training_step': 2.8926474468102215, 'env_runner_sampling_timer': 0.2833363258161858, 'learner_update_timer': 2.6030292404183233, 'synch_weights': 0.004798410248492484, 'synch_env_connectors': 0.007276280551085007, 'restore_eval_env_runners': 4.016604293178621e-06, 'evaluation_iteration': 3.0857543434978623, 'synch_eval_env_connectors': 0.0020936264543681524}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27550380754067, 'env_step_timer': 0.00014200460614002307, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.993219786372812e-06, 'batch_individual_items': 1.6785370763595016e-05, 'numpy_to_tensor': 2.795179820081059e-05, 'add_time_dim_to_batch_and_zero_pad': 6.182037770804562e-06, 'add_observations_from_episodes_to_batch': 1.5633060370114724e-05, 'add_states_from_episodes_to_batch': 4.230060869743765e-06}}, 'connector_pipeline_timer': 0.0001093119439191956}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 414000, 'target': 414000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.1965566936832823, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1527450517742585e-06, 'module_to_agent_unmapping': 3.558747423585898e-06, 'tensor_to_numpy': 4.660200336524199e-05, 'listify_data_for_vector_env': 9.085258922336371e-06, 'un_batch_to_individual_items': 2.015610951166531e-05, 'get_actions': 0.00012264550075333463, 'normalize_and_clip_actions': 5.0321692660988565e-05}}, 'connector_pipeline_timer': 0.0002961811639800354}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 414000, 'num_module_steps_sampled_lifetime': {'servicer': 414000, 'target': 414000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 89.0, 'rlmodule_inference_timer': 0.00014004541559265937, 'env_to_module_sum_episodes_length_in': 131.27550380754067, 'time_between_sampling': 2.7020953305176145, 'num_episodes_lifetime': 414, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -1.466963175659918, 'servicer': -1093.3441582972985}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1093.3441582972985, 'target': -1.466963175659918}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1094.8111214729586, 'episode_return_max': -1093.962506135524, 'episode_duration_sec_mean': 0.8612925251319489, 'episode_return_min': -1095.844248694139, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1209.9526231214345}, 'learners': {'servicer': {'mean_kl_loss': 0.005394089035689831, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.2018303871154785, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 1.220703143189894e-05, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 90.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.352402925491333, 'total_loss': 0.15988513827323914, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 16.731704711914062, 'vf_loss': 0.4840898811817169, 'vf_explained_var': 0.004643738269805908, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4170240, 'policy_loss': 0.010429332964122295}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 90.0, 'vf_loss_unclipped': 3.932268555217888e-06, 'total_loss': 0.3509754538536072, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 3.932268555217888e-06, 'entropy': -8.697877883911133, 'vf_explained_var': 0.32201600074768066, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4170240, 'policy_loss': 0.17013618350028992, 'mean_kl_loss': 0.012076280079782009, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 24.13492202758789, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.569531261920929}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19260422919594214, 'timers': {'connectors': {'batch_individual_items': 0.0769563579570599, 'numpy_to_tensor': 0.00017983580307515533, 'add_time_dim_to_batch_and_zero_pad': 2.3170730296949037e-05, 'add_one_ts_to_episodes_and_truncate': 0.005645259913304698, 'add_observations_from_episodes_to_batch': 0.00022459006583327602, 'add_states_from_episodes_to_batch': 6.72875777071684e-06, 'general_advantage_estimation': 0.026959246587934155, 'agent_to_module_mapping': 0.003930113010874865, 'add_columns_from_episodes_to_train_batch': 0.07846790425665773}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 149868000, 'num_module_steps_trained_lifetime': 8340480, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011278217664085389, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.033653032838535e-06, 'batch_individual_items': 1.25746092369948e-05, 'numpy_to_tensor': 2.0246747907220746e-05, 'add_time_dim_to_batch_and_zero_pad': 4.5937889196136975e-06, 'add_observations_from_episodes_to_batch': 1.2001271758826611e-05, 'add_states_from_episodes_to_batch': 3.070524539006978e-06}}, 'connector_pipeline_timer': 8.207072259726362e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 45, 'num_agent_steps_sampled_lifetime': {'servicer': 45000, 'target': 45000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 5.998355452876872e-06, 'agent_to_module_mapping': 6.620396377949171e-06, 'batch_individual_items': 3.055708170953981e-05, 'numpy_to_tensor': 3.411651004382249e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6597116267494588e-05, 'add_observations_from_episodes_to_batch': 2.9545053711082124e-05}}, 'sample': 2.8955110867577, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.502952541240041e-07, 'module_to_agent_unmapping': 2.613250496192589e-06, 'tensor_to_numpy': 3.482778721393975e-05, 'listify_data_for_vector_env': 7.023071789654767e-06, 'un_batch_to_individual_items': 1.4997666333960336e-05, 'get_actions': 3.694256986718276e-05, 'normalize_and_clip_actions': 3.804312164715242e-05}}, 'connector_pipeline_timer': 0.0001669915866740696}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.6875251306872808, 'servicer': -1083.2333526774798}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1083.2333526774798, 'target': -0.6875251306872808}, 'num_env_steps_sampled_lifetime': 45000, 'num_module_steps_sampled_lifetime': {'servicer': 45000, 'target': 45000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.00024751289662624994, 'env_reset_timer': 0.0001402561129637021, 'episode_return_mean': -1083.9208778081675, 'episode_return_max': -1078.9954447608318, 'weights_seq_no': 89.0, 'episode_duration_sec_mean': 0.5552594953800144, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011330831114984696, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3411747392238, 'time_between_sampling': 29.433976953711074}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 414000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1209.9526231214345, 'done': False, 'training_iteration': 90, 'trial_id': 'default', 'date': '2025-04-03_21-25-21', 'timestamp': 1743729921, 'time_this_iter_s': 3.7890219688415527, 'time_total_s': 276.2790153026581, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 276.2790153026581, 'iterations_since_restore': 90, 'perf': {'cpu_util_percent': 75.61666666666666, 'ram_util_percent': 55.31666666666666}}
2025-04-03 21:25:24,177 [__main__] [INFO] Iter: 91/100, Ts(iter): 0, Ts(total): 418600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.04s
2025-04-03 21:25:27,404 [__main__] [INFO] Iter: 92/100, Ts(iter): 0, Ts(total): 423200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.23s
2025-04-03 21:25:30,287 [__main__] [INFO] Iter: 93/100, Ts(iter): 0, Ts(total): 427800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.88s
2025-04-03 21:25:33,130 [__main__] [INFO] Iter: 94/100, Ts(iter): 0, Ts(total): 432400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.84s
2025-04-03 21:25:35,745 [__main__] [INFO] Iter: 95/100, Ts(iter): 0, Ts(total): 437000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.61s
2025-04-03 21:25:38,739 [__main__] [INFO] Iter: 96/100, Ts(iter): 0, Ts(total): 441600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:25:41,337 [__main__] [INFO] Iter: 97/100, Ts(iter): 0, Ts(total): 446200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.60s
2025-04-03 21:25:44,149 [__main__] [INFO] Iter: 98/100, Ts(iter): 0, Ts(total): 450800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.81s
2025-04-03 21:25:47,071 [__main__] [INFO] Iter: 99/100, Ts(iter): 0, Ts(total): 455400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.92s
2025-04-03 21:25:51,395 [__main__] [INFO] Iter: 100/100, Ts(iter): 0, Ts(total): 460000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.32s
2025-04-03 21:25:51,396 [__main__] [DEBUG] Full result dict at iter 100: {'timers': {'training_iteration': 2.903528834337326, 'restore_env_runners': 1.4614919716304288e-05, 'training_step': 2.903399999418112, 'env_runner_sampling_timer': 0.2786140702147078, 'learner_update_timer': 2.618477025760204, 'synch_weights': 0.004800036698189671, 'synch_env_connectors': 0.007260962777994703, 'restore_eval_env_runners': 4.022688165859696e-06, 'evaluation_iteration': 3.085085487982901, 'synch_eval_env_connectors': 0.0020897947797577673}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27550382615527, 'env_step_timer': 0.00014371789378607913, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.994592848947372e-06, 'batch_individual_items': 1.7385846053677543e-05, 'numpy_to_tensor': 2.8759562796024705e-05, 'add_time_dim_to_batch_and_zero_pad': 6.186252347947682e-06, 'add_observations_from_episodes_to_batch': 1.559634285050093e-05, 'add_states_from_episodes_to_batch': 3.981094116050526e-06}}, 'connector_pipeline_timer': 0.00011109948587322832}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.19482688209390303, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1404656624227333e-06, 'module_to_agent_unmapping': 3.5514509801308952e-06, 'tensor_to_numpy': 4.682337581626482e-05, 'listify_data_for_vector_env': 9.40109675704041e-06, 'un_batch_to_individual_items': 2.057486829519967e-05, 'get_actions': 0.00012510948677428707, 'normalize_and_clip_actions': 5.1110921040417996e-05}}, 'connector_pipeline_timer': 0.0003004006015067006}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 460000, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 99.0, 'rlmodule_inference_timer': 0.0001442064406174127, 'env_to_module_sum_episodes_length_in': 131.27550382615527, 'time_between_sampling': 2.7170194945742736, 'num_episodes_lifetime': 460, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -1.196937385663876, 'servicer': -1092.6678057765125}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1092.6678057765125, 'target': -1.196937385663876}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1093.8647431621764, 'episode_return_max': -1093.0266908080753, 'episode_duration_sec_mean': 0.8974426863892206, 'episode_return_min': -1094.8702397270802, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1063.8558876261864}, 'learners': {'servicer': {'mean_kl_loss': 0.00552379572764039, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.2421395778656006, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 3.051757857974735e-06, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 100.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.9399328231811523, 'total_loss': 0.07526646554470062, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 17.873214721679688, 'vf_loss': 0.4483713209629059, 'vf_explained_var': 0.0045746564865112305, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4633600, 'policy_loss': -0.015640582889318466}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 100.0, 'vf_loss_unclipped': 3.4941406283905962e-06, 'total_loss': 0.2653428614139557, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 3.4941406283905962e-06, 'entropy': -10.081868171691895, 'vf_explained_var': 0.3031662702560425, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4633600, 'policy_loss': 0.05465922877192497, 'mean_kl_loss': 0.015877556055784225, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 57.606346130371094, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.569531261920929}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19290521724956913, 'timers': {'connectors': {'batch_individual_items': 0.07782883964044214, 'numpy_to_tensor': 0.00017753634191295571, 'add_time_dim_to_batch_and_zero_pad': 2.2703273770411942e-05, 'add_one_ts_to_episodes_and_truncate': 0.005625412430895947, 'add_observations_from_episodes_to_batch': 0.0002248971741361735, 'add_states_from_episodes_to_batch': 6.610728153982125e-06, 'general_advantage_estimation': 0.026372071231424526, 'agent_to_module_mapping': 0.003936510497177882, 'add_columns_from_episodes_to_train_batch': 0.07850389967905046}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 166520000, 'num_module_steps_trained_lifetime': 9267200, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011269765391804776, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0312103218318418e-06, 'batch_individual_items': 1.2564645209524567e-05, 'numpy_to_tensor': 2.02286012774637e-05, 'add_time_dim_to_batch_and_zero_pad': 4.5876850298963344e-06, 'add_observations_from_episodes_to_batch': 1.1984382304466233e-05, 'add_states_from_episodes_to_batch': 3.0682897368002657e-06}}, 'connector_pipeline_timer': 8.200165831379264e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 50, 'num_agent_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 5.9972086540114606e-06, 'agent_to_module_mapping': 6.619005793648528e-06, 'batch_individual_items': 3.055027618153113e-05, 'numpy_to_tensor': 3.412461113029588e-05, 'add_time_dim_to_batch_and_zero_pad': 1.662977587611857e-05, 'add_observations_from_episodes_to_batch': 2.9543330782289548e-05}}, 'sample': 2.8954758974801242, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.504769835949586e-07, 'module_to_agent_unmapping': 2.6115093054663506e-06, 'tensor_to_numpy': 3.480928735599767e-05, 'listify_data_for_vector_env': 7.019651011220488e-06, 'un_batch_to_individual_items': 1.4991005729120265e-05, 'get_actions': 3.690618917128299e-05, 'normalize_and_clip_actions': 3.800748552503605e-05}}, 'connector_pipeline_timer': 0.00016687675090403325}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.6832559259571127, 'servicer': -1083.1494214950924}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1083.1494214950924, 'target': -0.6832559259571127}, 'num_env_steps_sampled_lifetime': 50000, 'num_module_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002474762400008086, 'env_reset_timer': 0.0001402546228335632, 'episode_return_mean': -1083.8326774210493, 'episode_return_max': -1078.9954447608318, 'weights_seq_no': 99.0, 'episode_duration_sec_mean': 0.5554010303493123, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011319745170727192, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3512563468219, 'time_between_sampling': 29.43269330765287}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1063.8558876261864, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_21-25-51', 'timestamp': 1743729951, 'time_this_iter_s': 4.31228494644165, 'time_total_s': 306.39930391311646, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 306.39930391311646, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 76.01428571428572, 'ram_util_percent': 55.300000000000004}}
2025-04-03 21:25:51,414 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.903528834337326, 'restore_env_runners': 1.4614919716304288e-05, 'training_step': 2.903399999418112, 'env_runner_sampling_timer': 0.2786140702147078, 'learner_update_timer': 2.618477025760204, 'synch_weights': 0.004800036698189671, 'synch_env_connectors': 0.007260962777994703, 'restore_eval_env_runners': 4.022688165859696e-06, 'evaluation_iteration': 3.085085487982901, 'synch_eval_env_connectors': 0.0020897947797577673}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27550382615527, 'env_step_timer': 0.00014371789378607913, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.994592848947372e-06, 'batch_individual_items': 1.7385846053677543e-05, 'numpy_to_tensor': 2.8759562796024705e-05, 'add_time_dim_to_batch_and_zero_pad': 6.186252347947682e-06, 'add_observations_from_episodes_to_batch': 1.559634285050093e-05, 'add_states_from_episodes_to_batch': 3.981094116050526e-06}}, 'connector_pipeline_timer': 0.00011109948587322832}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.19482688209390303, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1404656624227333e-06, 'module_to_agent_unmapping': 3.5514509801308952e-06, 'tensor_to_numpy': 4.682337581626482e-05, 'listify_data_for_vector_env': 9.40109675704041e-06, 'un_batch_to_individual_items': 2.057486829519967e-05, 'get_actions': 0.00012510948677428707, 'normalize_and_clip_actions': 5.1110921040417996e-05}}, 'connector_pipeline_timer': 0.0003004006015067006}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 460000, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 99.0, 'rlmodule_inference_timer': 0.0001442064406174127, 'env_to_module_sum_episodes_length_in': 131.27550382615527, 'time_between_sampling': 2.7170194945742736, 'num_episodes_lifetime': 460, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -1.196937385663876, 'servicer': -1092.6678057765125}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1092.6678057765125, 'target': -1.196937385663876}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1093.8647431621764, 'episode_return_max': -1093.0266908080753, 'episode_duration_sec_mean': 0.8974426863892206, 'episode_return_min': -1094.8702397270802, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1063.8558876261864}, 'learners': {'servicer': {'mean_kl_loss': 0.00552379572764039, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.2421395778656006, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 3.051757857974735e-06, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 100.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.9399328231811523, 'total_loss': 0.07526646554470062, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 17.873214721679688, 'vf_loss': 0.4483713209629059, 'vf_explained_var': 0.0045746564865112305, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4633600, 'policy_loss': -0.015640582889318466}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 100.0, 'vf_loss_unclipped': 3.4941406283905962e-06, 'total_loss': 0.2653428614139557, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 3.4941406283905962e-06, 'entropy': -10.081868171691895, 'vf_explained_var': 0.3031662702560425, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4633600, 'policy_loss': 0.05465922877192497, 'mean_kl_loss': 0.015877556055784225, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 57.606346130371094, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.569531261920929}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19290521724956913, 'timers': {'connectors': {'batch_individual_items': 0.07782883964044214, 'numpy_to_tensor': 0.00017753634191295571, 'add_time_dim_to_batch_and_zero_pad': 2.2703273770411942e-05, 'add_one_ts_to_episodes_and_truncate': 0.005625412430895947, 'add_observations_from_episodes_to_batch': 0.0002248971741361735, 'add_states_from_episodes_to_batch': 6.610728153982125e-06, 'general_advantage_estimation': 0.026372071231424526, 'agent_to_module_mapping': 0.003936510497177882, 'add_columns_from_episodes_to_train_batch': 0.07850389967905046}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 166520000, 'num_module_steps_trained_lifetime': 9267200, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011269765391804776, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0312103218318418e-06, 'batch_individual_items': 1.2564645209524567e-05, 'numpy_to_tensor': 2.02286012774637e-05, 'add_time_dim_to_batch_and_zero_pad': 4.5876850298963344e-06, 'add_observations_from_episodes_to_batch': 1.1984382304466233e-05, 'add_states_from_episodes_to_batch': 3.0682897368002657e-06}}, 'connector_pipeline_timer': 8.200165831379264e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 50, 'num_agent_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 5.9972086540114606e-06, 'agent_to_module_mapping': 6.619005793648528e-06, 'batch_individual_items': 3.055027618153113e-05, 'numpy_to_tensor': 3.412461113029588e-05, 'add_time_dim_to_batch_and_zero_pad': 1.662977587611857e-05, 'add_observations_from_episodes_to_batch': 2.9543330782289548e-05}}, 'sample': 2.8954758974801242, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.504769835949586e-07, 'module_to_agent_unmapping': 2.6115093054663506e-06, 'tensor_to_numpy': 3.480928735599767e-05, 'listify_data_for_vector_env': 7.019651011220488e-06, 'un_batch_to_individual_items': 1.4991005729120265e-05, 'get_actions': 3.690618917128299e-05, 'normalize_and_clip_actions': 3.800748552503605e-05}}, 'connector_pipeline_timer': 0.00016687675090403325}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.6832559259571127, 'servicer': -1083.1494214950924}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1083.1494214950924, 'target': -0.6832559259571127}, 'num_env_steps_sampled_lifetime': 50000, 'num_module_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002474762400008086, 'env_reset_timer': 0.0001402546228335632, 'episode_return_mean': -1083.8326774210493, 'episode_return_max': -1078.9954447608318, 'weights_seq_no': 99.0, 'episode_duration_sec_mean': 0.5554010303493123, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011319745170727192, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3512563468219, 'time_between_sampling': 29.43269330765287}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1063.8558876261864, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_21-25-51', 'timestamp': 1743729951, 'time_this_iter_s': 4.31228494644165, 'time_total_s': 306.39930391311646, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 306.39930391311646, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 76.01428571428572, 'ram_util_percent': 55.300000000000004}})
2025-04-03 21:25:51,415 [__main__] [INFO] 
--- Training Finished ---
2025-04-03 21:25:51,415 [__main__] [INFO] Total Training Time: 307.81 seconds
2025-04-03 21:25:51,415 [__main__] [INFO] Using last checkpoint: TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 2.903528834337326, 'restore_env_runners': 1.4614919716304288e-05, 'training_step': 2.903399999418112, 'env_runner_sampling_timer': 0.2786140702147078, 'learner_update_timer': 2.618477025760204, 'synch_weights': 0.004800036698189671, 'synch_env_connectors': 0.007260962777994703, 'restore_eval_env_runners': 4.022688165859696e-06, 'evaluation_iteration': 3.085085487982901, 'synch_eval_env_connectors': 0.0020897947797577673}, 'env_runners': {'env_to_module_sum_episodes_length_out': 131.27550382615527, 'env_step_timer': 0.00014371789378607913, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.994592848947372e-06, 'batch_individual_items': 1.7385846053677543e-05, 'numpy_to_tensor': 2.8759562796024705e-05, 'add_time_dim_to_batch_and_zero_pad': 6.186252347947682e-06, 'add_observations_from_episodes_to_batch': 1.559634285050093e-05, 'add_states_from_episodes_to_batch': 3.981094116050526e-06}}, 'connector_pipeline_timer': 0.00011109948587322832}, 'num_module_steps_sampled': {'target': 4600, 'servicer': 4600}, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 1.0840563766617814e-05, 'agent_to_module_mapping': 9.28986928952129e-06, 'batch_individual_items': 7.140230319118533e-05, 'numpy_to_tensor': 0.00014528987294002235, 'add_time_dim_to_batch_and_zero_pad': 8.479160896968096e-05, 'add_observations_from_episodes_to_batch': 7.70326081217955e-05}}, 'sample': 0.19482688209390303, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.1404656624227333e-06, 'module_to_agent_unmapping': 3.5514509801308952e-06, 'tensor_to_numpy': 4.682337581626482e-05, 'listify_data_for_vector_env': 9.40109675704041e-06, 'un_batch_to_individual_items': 2.057486829519967e-05, 'get_actions': 0.00012510948677428707, 'normalize_and_clip_actions': 5.1110921040417996e-05}}, 'connector_pipeline_timer': 0.0003004006015067006}, 'num_env_steps_sampled': 4600, 'num_env_steps_sampled_lifetime': 460000, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'connector_pipeline_timer': 0.0007001594336622435, 'env_reset_timer': 0.00043957078267577225, 'weights_seq_no': 99.0, 'rlmodule_inference_timer': 0.0001442064406174127, 'env_to_module_sum_episodes_length_in': 131.27550382615527, 'time_between_sampling': 2.7170194945742736, 'num_episodes_lifetime': 460, 'num_episodes': 23, 'module_episode_returns_mean': {'target': -1.196937385663876, 'servicer': -1092.6678057765125}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1092.6678057765125, 'target': -1.196937385663876}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'episode_return_mean': -1093.8647431621764, 'episode_return_max': -1093.0266908080753, 'episode_duration_sec_mean': 0.8974426863892206, 'episode_return_min': -1094.8702397270802, 'episode_len_mean': 1000.0, 'num_env_steps_sampled_lifetime_throughput': 1063.8558876261864}, 'learners': {'servicer': {'mean_kl_loss': 0.00552379572764039, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 2.2421395778656006, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 3.051757857974735e-06, 'default_optimizer_learning_rate': 3e-05, 'weights_seq_no': 100.0, 'module_train_batch_size_mean': 128.0, 'vf_loss_unclipped': 3.9399328231811523, 'total_loss': 0.07526646554470062, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'entropy': 17.873214721679688, 'vf_loss': 0.4483713209629059, 'vf_explained_var': 0.0045746564865112305, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4633600, 'policy_loss': -0.015640582889318466}, 'target': {'default_optimizer_learning_rate': 3e-05, 'module_train_batch_size_mean': 128.0, 'weights_seq_no': 100.0, 'vf_loss_unclipped': 3.4941406283905962e-06, 'total_loss': 0.2653428614139557, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 3.4941406283905962e-06, 'entropy': -10.081868171691895, 'vf_explained_var': 0.3031662702560425, 'num_trainable_parameters': 142093.0, 'num_module_steps_trained_lifetime': 4633600, 'policy_loss': 0.05465922877192497, 'mean_kl_loss': 0.015877556055784225, 'curr_entropy_coeff': 0.02, 'gradients_default_optimizer_global_norm': 57.606346130371094, 'num_module_steps_trained': 46336, 'curr_kl_coeff': 0.569531261920929}, '__all_modules__': {'learner_connector': {'connector_pipeline_timer': 0.19290521724956913, 'timers': {'connectors': {'batch_individual_items': 0.07782883964044214, 'numpy_to_tensor': 0.00017753634191295571, 'add_time_dim_to_batch_and_zero_pad': 2.2703273770411942e-05, 'add_one_ts_to_episodes_and_truncate': 0.005625412430895947, 'add_observations_from_episodes_to_batch': 0.0002248971741361735, 'add_states_from_episodes_to_batch': 6.610728153982125e-06, 'general_advantage_estimation': 0.026372071231424526, 'agent_to_module_mapping': 0.003936510497177882, 'add_columns_from_episodes_to_train_batch': 0.07850389967905046}}}, 'num_trainable_parameters': 284186.0, 'num_env_steps_trained_lifetime': 166520000, 'num_module_steps_trained_lifetime': 9267200, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_module_steps_trained': 92672, 'num_env_steps_trained': 1665200, 'num_non_trainable_parameters': 0.0, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_out': 901.0423566894266, 'env_step_timer': 0.00011269765391804776, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.0312103218318418e-06, 'batch_individual_items': 1.2564645209524567e-05, 'numpy_to_tensor': 2.02286012774637e-05, 'add_time_dim_to_batch_and_zero_pad': 4.5876850298963344e-06, 'add_observations_from_episodes_to_batch': 1.1984382304466233e-05, 'add_states_from_episodes_to_batch': 3.0682897368002657e-06}}, 'connector_pipeline_timer': 8.200165831379264e-05}, 'num_module_steps_sampled': {'target': 5000, 'servicer': 5000}, 'num_episodes_lifetime': 50, 'num_agent_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'timers': {'connectors': {'add_states_from_episodes_to_batch': 5.9972086540114606e-06, 'agent_to_module_mapping': 6.619005793648528e-06, 'batch_individual_items': 3.055027618153113e-05, 'numpy_to_tensor': 3.412461113029588e-05, 'add_time_dim_to_batch_and_zero_pad': 1.662977587611857e-05, 'add_observations_from_episodes_to_batch': 2.9543330782289548e-05}}, 'sample': 2.8954758974801242, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.504769835949586e-07, 'module_to_agent_unmapping': 2.6115093054663506e-06, 'tensor_to_numpy': 3.480928735599767e-05, 'listify_data_for_vector_env': 7.019651011220488e-06, 'un_batch_to_individual_items': 1.4991005729120265e-05, 'get_actions': 3.690618917128299e-05, 'normalize_and_clip_actions': 3.800748552503605e-05}}, 'connector_pipeline_timer': 0.00016687675090403325}, 'num_episodes': 5, 'num_env_steps_sampled': 5000, 'module_episode_returns_mean': {'target': -0.6832559259571127, 'servicer': -1083.1494214950924}, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'agent_episode_returns_mean': {'servicer': -1083.1494214950924, 'target': -0.6832559259571127}, 'num_env_steps_sampled_lifetime': 50000, 'num_module_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'episode_len_max': 1000, 'episode_len_min': 1000, 'connector_pipeline_timer': 0.0002474762400008086, 'env_reset_timer': 0.0001402546228335632, 'episode_return_mean': -1083.8326774210493, 'episode_return_max': -1078.9954447608318, 'weights_seq_no': 99.0, 'episode_duration_sec_mean': 0.5554010303493123, 'episode_return_min': -1093.41619303971, 'rlmodule_inference_timer': 0.00011319745170727192, 'episode_len_mean': 1000.0, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'num_env_steps_sampled_per_second': 1619.3512563468219, 'time_between_sampling': 29.43269330765287}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1063.8558876261864, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_21-25-51', 'timestamp': 1743729951, 'time_this_iter_s': 4.31228494644165, 'time_total_s': 306.39930391311646, 'pid': 79978, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.9, 'lr': 3e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x366fd8ae0>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 306.39930391311646, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 76.01428571428572, 'ram_util_percent': 55.300000000000004}})
2025-04-03 21:25:51,416 [__main__] [INFO] 
--- Running Evaluation & Recording Video ---
2025-04-03 21:25:51,417 [__main__] [INFO] Successfully retrieved RLModules for evaluation.
2025-04-03 21:25:51,417 [__main__] [INFO] Evaluation Episode: 1/5
2025-04-03 21:25:51,492 [src.satellite_marl_env] [INFO] MuJoCo Renderer initialized for rgb_array.
2025-04-03 21:25:54,289 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:25:54,292 [__main__] [INFO] Evaluation Episode 1 Rewards: {'servicer': -1086.9302350827165, 'target': -0.3991633385047321}
2025-04-03 21:25:54,292 [__main__] [INFO] Evaluation Episode: 2/5
2025-04-03 21:25:57,038 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:25:57,042 [__main__] [INFO] Evaluation Episode 2 Rewards: {'servicer': -1086.9302350827165, 'target': -0.3991633385047321}
2025-04-03 21:25:57,042 [__main__] [INFO] Evaluation Episode: 3/5
2025-04-03 21:25:59,771 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:25:59,775 [__main__] [INFO] Evaluation Episode 3 Rewards: {'servicer': -1086.9302350827165, 'target': -0.3991633385047321}
2025-04-03 21:25:59,775 [__main__] [INFO] Evaluation Episode: 4/5
2025-04-03 21:26:02,536 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:26:02,539 [__main__] [INFO] Evaluation Episode 4 Rewards: {'servicer': -1086.9302350827165, 'target': -0.3991633385047321}
2025-04-03 21:26:02,539 [__main__] [INFO] Evaluation Episode: 5/5
2025-04-03 21:26:05,284 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:26:05,287 [__main__] [INFO] Evaluation Episode 5 Rewards: {'servicer': -1086.9302350827165, 'target': -0.3991633385047321}
2025-04-03 21:26:05,295 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:26:05,295 [__main__] [INFO] Average Evaluation Rewards over 5 episodes: {'servicer': -1086.9302350827165, 'target': -0.3991633385047321}
2025-04-03 21:26:05,295 [__main__] [INFO] Saving evaluation video to: /Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results/evaluation_video.mp4
2025-04-03 21:26:08,696 [__main__] [INFO] Shutting down Ray...
2025-04-03 21:26:09,401 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:26:09,414 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:26:11,270 [__main__] [INFO] Script finished.
