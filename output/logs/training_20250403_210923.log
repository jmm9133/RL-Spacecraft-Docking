2025-04-03 21:09:23,501 [__main__] [INFO] Initializing Ray...
2025-04-03 21:09:28,618 [__main__] [INFO] Creating temporary environment to get action/observation spaces...
2025-04-03 21:09:28,620 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:09:28,621 [__main__] [INFO] Spaces retrieved.
2025-04-03 21:09:28,621 [__main__] [INFO] Configuring RLlib PPO Algorithm...
2025-04-03 21:09:28,621 [__main__] [INFO] Using 23 environment runners (workers).
2025-04-03 21:09:28,621 [__main__] [INFO] Setting train_batch_size to 4600 (min required estimate: 4600)
2025-04-03 21:09:28,621 [__main__] [INFO] Building Algorithm...
2025-04-03 21:09:41,810 [__main__] [INFO] Algorithm Built. Using Policy/Module Class: DefaultPPOTorchRLModule
2025-04-03 21:09:41,810 [__main__] [INFO] 
--- Starting Training for 100 iterations ---
2025-04-03 21:09:44,923 [__main__] [INFO] Iter: 1/100, Ts(iter): 0, Ts(total): 4600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:09:47,851 [__main__] [INFO] Iter: 2/100, Ts(iter): 0, Ts(total): 9200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.93s
2025-04-03 21:09:50,959 [__main__] [INFO] Iter: 3/100, Ts(iter): 0, Ts(total): 13800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:09:53,987 [__main__] [INFO] Iter: 4/100, Ts(iter): 0, Ts(total): 18400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.03s
2025-04-03 21:09:57,158 [__main__] [INFO] Iter: 5/100, Ts(iter): 0, Ts(total): 23000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.17s
2025-04-03 21:10:00,403 [__main__] [INFO] Iter: 6/100, Ts(iter): 0, Ts(total): 27600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.24s
2025-04-03 21:10:03,511 [__main__] [INFO] Iter: 7/100, Ts(iter): 0, Ts(total): 32200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:10:06,651 [__main__] [INFO] Iter: 8/100, Ts(iter): 0, Ts(total): 36800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.14s
2025-04-03 21:10:09,965 [__main__] [INFO] Iter: 9/100, Ts(iter): 0, Ts(total): 41400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.31s
2025-04-03 21:10:14,068 [__main__] [INFO] Iter: 10/100, Ts(iter): 0, Ts(total): 46000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.10s
2025-04-03 21:10:14,069 [__main__] [DEBUG] Full result dict at iter 10: {'timers': {'training_iteration': 3.103768205294688, 'restore_env_runners': 1.9005461450794607e-05, 'training_step': 3.1036169246442897, 'env_runner_sampling_timer': 0.3595945105334906, 'learner_update_timer': 2.736453795150285, 'synch_weights': 0.005970406583014575, 'synch_env_connectors': 0.007272929743119437, 'restore_eval_env_runners': 8.374991011805832e-06, 'evaluation_iteration': 3.1043106249999255, 'synch_eval_env_connectors': 0.002367332999710925}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.42705298533906e-06, 'add_observations_from_episodes_to_batch': 1.762967980487256e-05, 'batch_individual_items': 1.9239409112893414e-05, 'add_time_dim_to_batch_and_zero_pad': 6.9023907588638515e-06, 'add_states_from_episodes_to_batch': 4.082131265889226e-06, 'numpy_to_tensor': 3.160760298389568e-05}}, 'connector_pipeline_timer': 0.00012146335324034439}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.22480873498075873, 'num_module_steps_sampled_lifetime': {'servicer': 46000, 'target': 46000}, 'num_agent_steps_sampled_lifetime': {'servicer': 46000, 'target': 46000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.384803464637924e-05, 'normalize_and_clip_actions': 6.710417008139921e-05, 'module_to_agent_unmapping': 3.7692708409745137e-06, 'get_actions': 0.00014664598345436288, 'un_batch_to_individual_items': 2.2484452074756184e-05, 'listify_data_for_vector_env': 1.0288731285440605e-05, 'remove_single_ts_time_rank_from_batch': 1.2119932826011e-06}}, 'connector_pipeline_timer': 0.0003534883808273954}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 46000, 'weights_seq_no': 9.0, 'env_step_timer': 0.0001538377118692568, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 129.0551495455431, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 129.0551495455431, 'rlmodule_inference_timer': 0.00017839867657629778, 'time_between_sampling': 2.886991484236171, 'episode_return_min': -1132.1083479196616, 'num_episodes_lifetime': 46, 'episode_return_mean': -1119.8906901149498, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1102.670416165485, 'target': -17.220273949465025}, 'episode_duration_sec_mean': 0.9106089003964926, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1102.670416165485, 'target': -17.220273949465025}, 'episode_len_min': 1000, 'episode_return_max': -1106.8229652717873, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1121.982085514535}, 'learners': {'servicer': {'policy_loss': -0.02326831966638565, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.818276882171631, 'total_loss': 4.611644744873047, 'gradients_default_optimizer_global_norm': 1.7105395793914795, 'curr_kl_coeff': 0.0015625000232830644, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 10.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.004700641147792339, 'vf_loss_unclipped': 4332.21533203125, 'num_module_steps_trained_lifetime': 463360, 'vf_explained_var': -2.002716064453125e-05, 'entropy': 9.168923377990723}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07975622729688794, 'agent_to_module_mapping': 0.003843134068103435, 'add_observations_from_episodes_to_batch': 0.00025076576604111505, 'general_advantage_estimation': 0.029886388686795298, 'batch_individual_items': 0.07325395119657366, 'add_time_dim_to_batch_and_zero_pad': 2.956592629775684e-05, 'add_states_from_episodes_to_batch': 8.609459338434012e-06, 'add_one_ts_to_episodes_and_truncate': 0.006154322782598853, 'numpy_to_tensor': 0.00018827302893578075}}, 'connector_pipeline_timer': 0.19364915312065595}, 'num_module_steps_trained_lifetime': 926720, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 16652000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.12659557163715363, 'vf_loss': 0.18235661089420319, 'curr_kl_coeff': 0.0015625000232830644, 'gradients_default_optimizer_global_norm': 3.1248815059661865, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 10.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.004068785347044468, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.18235661089420319, 'num_module_steps_trained_lifetime': 463360, 'vf_explained_var': 0.12730693817138672, 'policy_loss': -0.1362803429365158, 'entropy': 8.63422966003418, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6915993657894433e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6582998796366155e-05, 'add_states_from_episodes_to_batch': 4.999994416721165e-06, 'numpy_to_tensor': 4.6832996304146945e-05, 'agent_to_module_mapping': 5.2919931476935744e-06, 'add_observations_from_episodes_to_batch': 3.0041002901270986e-05}}, 'episode_return_min': -1080.942038345945, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.306994867866933e-07, 'tensor_to_numpy': 3.437280623799754e-05, 'normalize_and_clip_actions': 3.665479130926278e-05, 'module_to_agent_unmapping': 2.675840622923613e-06, 'get_actions': 3.701648328196064e-05, 'un_batch_to_individual_items': 1.4823755484090948e-05, 'listify_data_for_vector_env': 6.874076819981026e-06}}, 'connector_pipeline_timer': 0.00016448147054252876}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4630252064194176e-06, 'add_observations_from_episodes_to_batch': 1.1727930965696292e-05, 'batch_individual_items': 1.2323452613757028e-05, 'add_time_dim_to_batch_and_zero_pad': 4.379383094842016e-06, 'add_states_from_episodes_to_batch': 2.9654859065378724e-06, 'numpy_to_tensor': 1.9721748302187992e-05}}, 'connector_pipeline_timer': 8.062873843363907e-05}, 'env_reset_timer': 0.0001630830083740875, 'sample': 2.8685680409980705, 'num_episodes_lifetime': 5, 'num_module_steps_sampled_lifetime': {'servicer': 5000, 'target': 5000}, 'episode_return_mean': -1080.942038345945, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 5000, 'target': 5000}, 'module_episode_returns_mean': {'servicer': -1078.3964205357554, 'target': -2.5456178101897264}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 5000, 'weights_seq_no': 9.0, 'env_step_timer': 0.0001047259598673806, 'episode_duration_sec_mean': 0.5600139752001269, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1078.3964205357554, 'target': -2.5456178101897264}, 'connector_pipeline_timer': 0.0002415830094832927, 'episode_len_min': 1000, 'episode_return_max': -1080.942038345945, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011283791016481465, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 46000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1121.982085514535, 'done': False, 'training_iteration': 10, 'trial_id': 'default', 'date': '2025-04-03_21-10-14', 'timestamp': 1743729014, 'time_this_iter_s': 4.089184999465942, 'time_total_s': 32.138128995895386, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 32.138128995895386, 'iterations_since_restore': 10, 'perf': {'cpu_util_percent': 80.78333333333333, 'ram_util_percent': 52.650000000000006}}
2025-04-03 21:10:17,132 [__main__] [INFO] Iter: 11/100, Ts(iter): 0, Ts(total): 50600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.06s
2025-04-03 21:10:20,264 [__main__] [INFO] Iter: 12/100, Ts(iter): 0, Ts(total): 55200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.13s
2025-04-03 21:10:23,281 [__main__] [INFO] Iter: 13/100, Ts(iter): 0, Ts(total): 59800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:10:26,626 [__main__] [INFO] Iter: 14/100, Ts(iter): 0, Ts(total): 64400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.34s
2025-04-03 21:10:29,577 [__main__] [INFO] Iter: 15/100, Ts(iter): 0, Ts(total): 69000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.95s
2025-04-03 21:10:32,839 [__main__] [INFO] Iter: 16/100, Ts(iter): 0, Ts(total): 73600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.26s
2025-04-03 21:10:35,857 [__main__] [INFO] Iter: 17/100, Ts(iter): 0, Ts(total): 78200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:10:38,852 [__main__] [INFO] Iter: 18/100, Ts(iter): 0, Ts(total): 82800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.99s
2025-04-03 21:10:42,163 [__main__] [INFO] Iter: 19/100, Ts(iter): 0, Ts(total): 87400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.31s
2025-04-03 21:10:46,235 [__main__] [INFO] Iter: 20/100, Ts(iter): 0, Ts(total): 92000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.07s
2025-04-03 21:10:46,235 [__main__] [DEBUG] Full result dict at iter 20: {'timers': {'training_iteration': 3.1125361391429474, 'restore_env_runners': 1.816592233362111e-05, 'training_step': 3.112385307632465, 'env_runner_sampling_timer': 0.3499370303761408, 'learner_update_timer': 2.7549405443714945, 'synch_weights': 0.005900795198810732, 'synch_env_connectors': 0.00728938185261793, 'restore_eval_env_runners': 8.343331137439236e-06, 'evaluation_iteration': 3.104811790419917, 'synch_eval_env_connectors': 0.002356297169608297}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.511625877263217e-06, 'add_observations_from_episodes_to_batch': 1.7511933381157313e-05, 'batch_individual_items': 1.9347469056452526e-05, 'add_time_dim_to_batch_and_zero_pad': 7.132349949087297e-06, 'add_states_from_episodes_to_batch': 4.151837627660459e-06, 'numpy_to_tensor': 3.245896807219586e-05}}, 'connector_pipeline_timer': 0.00012393870592591655}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.2224203421314805, 'num_module_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'num_agent_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.269315692217812e-05, 'normalize_and_clip_actions': 5.6746781175380216e-05, 'module_to_agent_unmapping': 4.0825864827629975e-06, 'get_actions': 0.00013974232813244577, 'un_batch_to_individual_items': 2.289968725020755e-05, 'listify_data_for_vector_env': 1.0054996876520033e-05, 'remove_single_ts_time_rank_from_batch': 1.225990824530324e-06}}, 'connector_pipeline_timer': 0.0003352430780822844}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 92000, 'weights_seq_no': 19.0, 'env_step_timer': 0.00015435306950707705, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.05545602565746, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.05545602565746, 'rlmodule_inference_timer': 0.00015995387516417537, 'time_between_sampling': 2.899438576195156, 'episode_return_min': -1113.9655076446898, 'num_episodes_lifetime': 92, 'episode_return_mean': -1103.3246683549871, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1085.4548122456656, 'target': -17.869856109321116}, 'episode_duration_sec_mean': 0.9621068657370809, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1085.4548122456656, 'target': -17.869856109321116}, 'episode_len_min': 1000, 'episode_return_max': -1088.623370738058, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1129.9999659037417}, 'learners': {'servicer': {'policy_loss': -0.07450439035892487, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.889082908630371, 'total_loss': 4.619058132171631, 'gradients_default_optimizer_global_norm': 1.2094234228134155, 'curr_kl_coeff': 4.882812572759576e-05, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 20.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.007612166926264763, 'vf_loss_unclipped': 3810.910888671875, 'num_module_steps_trained_lifetime': 926720, 'vf_explained_var': 0.0003425478935241699, 'entropy': 9.776016235351562}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07977448325789974, 'agent_to_module_mapping': 0.003846882993009039, 'add_observations_from_episodes_to_batch': 0.00025048439381219356, 'general_advantage_estimation': 0.02970691183040553, 'batch_individual_items': 0.07362947503253993, 'add_time_dim_to_batch_and_zero_pad': 2.9399505025306253e-05, 'add_states_from_episodes_to_batch': 8.563130617142273e-06, 'add_one_ts_to_episodes_and_truncate': 0.006145615492715769, 'numpy_to_tensor': 0.00018773123839347706}}, 'connector_pipeline_timer': 0.19385552913556237}, 'num_module_steps_trained_lifetime': 1853440, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 33304000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.10569343715906143, 'vf_loss': 0.1378839910030365, 'curr_kl_coeff': 9.765625145519152e-05, 'gradients_default_optimizer_global_norm': 2.3323745727539062, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 20.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.004897580482065678, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.1378839910030365, 'num_module_steps_trained_lifetime': 926720, 'vf_explained_var': 0.3482273817062378, 'policy_loss': -0.06034011393785477, 'entropy': 9.161914825439453, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6915285357972605e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6582102997926995e-05, 'add_states_from_episodes_to_batch': 4.999865217541809e-06, 'numpy_to_tensor': 4.683124210423557e-05, 'agent_to_module_mapping': 5.291918048169464e-06, 'add_observations_from_episodes_to_batch': 3.00403613015078e-05}}, 'episode_return_min': -1080.942038345945, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.301811094484653e-07, 'tensor_to_numpy': 3.436059299567247e-05, 'normalize_and_clip_actions': 3.6632224326341476e-05, 'module_to_agent_unmapping': 2.6745466932357943e-06, 'get_actions': 3.6993814388729017e-05, 'un_batch_to_individual_items': 1.4820840331313346e-05, 'listify_data_for_vector_env': 6.872326863313603e-06}}, 'connector_pipeline_timer': 0.00016441389128348552}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.458571200208295e-06, 'add_observations_from_episodes_to_batch': 1.172069257762455e-05, 'batch_individual_items': 1.231940548068926e-05, 'add_time_dim_to_batch_and_zero_pad': 4.376185877596837e-06, 'add_states_from_episodes_to_batch': 2.9649357720156654e-06, 'numpy_to_tensor': 1.9713229013955548e-05}}, 'connector_pipeline_timer': 8.059387954114108e-05}, 'env_reset_timer': 0.00016307887927250703, 'sample': 2.8685768178772704, 'num_episodes_lifetime': 10, 'num_module_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'episode_return_mean': -1072.3983657499234, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'module_episode_returns_mean': {'servicer': -1069.514197845467, 'target': -2.88416790445646}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 10000, 'weights_seq_no': 19.0, 'env_step_timer': 0.00010468830368967792, 'episode_duration_sec_mean': 0.5612477251338229, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1069.514197845467, 'target': -2.88416790445646}, 'connector_pipeline_timer': 0.00024157135118293808, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.0001127697484565192, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.663559159812, 'time_between_sampling': 29.291633500004536}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 92000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1129.9999659037417, 'done': False, 'training_iteration': 20, 'trial_id': 'default', 'date': '2025-04-03_21-10-46', 'timestamp': 1743729046, 'time_this_iter_s': 4.05665397644043, 'time_total_s': 64.15719723701477, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 64.15719723701477, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 80.78333333333335, 'ram_util_percent': 52.699999999999996}}
2025-04-03 21:10:46,256 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.1125361391429474, 'restore_env_runners': 1.816592233362111e-05, 'training_step': 3.112385307632465, 'env_runner_sampling_timer': 0.3499370303761408, 'learner_update_timer': 2.7549405443714945, 'synch_weights': 0.005900795198810732, 'synch_env_connectors': 0.00728938185261793, 'restore_eval_env_runners': 8.343331137439236e-06, 'evaluation_iteration': 3.104811790419917, 'synch_eval_env_connectors': 0.002356297169608297}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.511625877263217e-06, 'add_observations_from_episodes_to_batch': 1.7511933381157313e-05, 'batch_individual_items': 1.9347469056452526e-05, 'add_time_dim_to_batch_and_zero_pad': 7.132349949087297e-06, 'add_states_from_episodes_to_batch': 4.151837627660459e-06, 'numpy_to_tensor': 3.245896807219586e-05}}, 'connector_pipeline_timer': 0.00012393870592591655}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.2224203421314805, 'num_module_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'num_agent_steps_sampled_lifetime': {'servicer': 92000, 'target': 92000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.269315692217812e-05, 'normalize_and_clip_actions': 5.6746781175380216e-05, 'module_to_agent_unmapping': 4.0825864827629975e-06, 'get_actions': 0.00013974232813244577, 'un_batch_to_individual_items': 2.289968725020755e-05, 'listify_data_for_vector_env': 1.0054996876520033e-05, 'remove_single_ts_time_rank_from_batch': 1.225990824530324e-06}}, 'connector_pipeline_timer': 0.0003352430780822844}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 92000, 'weights_seq_no': 19.0, 'env_step_timer': 0.00015435306950707705, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.05545602565746, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.05545602565746, 'rlmodule_inference_timer': 0.00015995387516417537, 'time_between_sampling': 2.899438576195156, 'episode_return_min': -1113.9655076446898, 'num_episodes_lifetime': 92, 'episode_return_mean': -1103.3246683549871, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1085.4548122456656, 'target': -17.869856109321116}, 'episode_duration_sec_mean': 0.9621068657370809, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1085.4548122456656, 'target': -17.869856109321116}, 'episode_len_min': 1000, 'episode_return_max': -1088.623370738058, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1129.9999659037417}, 'learners': {'servicer': {'policy_loss': -0.07450439035892487, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.889082908630371, 'total_loss': 4.619058132171631, 'gradients_default_optimizer_global_norm': 1.2094234228134155, 'curr_kl_coeff': 4.882812572759576e-05, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 20.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.007612166926264763, 'vf_loss_unclipped': 3810.910888671875, 'num_module_steps_trained_lifetime': 926720, 'vf_explained_var': 0.0003425478935241699, 'entropy': 9.776016235351562}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07977448325789974, 'agent_to_module_mapping': 0.003846882993009039, 'add_observations_from_episodes_to_batch': 0.00025048439381219356, 'general_advantage_estimation': 0.02970691183040553, 'batch_individual_items': 0.07362947503253993, 'add_time_dim_to_batch_and_zero_pad': 2.9399505025306253e-05, 'add_states_from_episodes_to_batch': 8.563130617142273e-06, 'add_one_ts_to_episodes_and_truncate': 0.006145615492715769, 'numpy_to_tensor': 0.00018773123839347706}}, 'connector_pipeline_timer': 0.19385552913556237}, 'num_module_steps_trained_lifetime': 1853440, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 33304000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.10569343715906143, 'vf_loss': 0.1378839910030365, 'curr_kl_coeff': 9.765625145519152e-05, 'gradients_default_optimizer_global_norm': 2.3323745727539062, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 20.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.004897580482065678, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.1378839910030365, 'num_module_steps_trained_lifetime': 926720, 'vf_explained_var': 0.3482273817062378, 'policy_loss': -0.06034011393785477, 'entropy': 9.161914825439453, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6915285357972605e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6582102997926995e-05, 'add_states_from_episodes_to_batch': 4.999865217541809e-06, 'numpy_to_tensor': 4.683124210423557e-05, 'agent_to_module_mapping': 5.291918048169464e-06, 'add_observations_from_episodes_to_batch': 3.00403613015078e-05}}, 'episode_return_min': -1080.942038345945, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.301811094484653e-07, 'tensor_to_numpy': 3.436059299567247e-05, 'normalize_and_clip_actions': 3.6632224326341476e-05, 'module_to_agent_unmapping': 2.6745466932357943e-06, 'get_actions': 3.6993814388729017e-05, 'un_batch_to_individual_items': 1.4820840331313346e-05, 'listify_data_for_vector_env': 6.872326863313603e-06}}, 'connector_pipeline_timer': 0.00016441389128348552}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.458571200208295e-06, 'add_observations_from_episodes_to_batch': 1.172069257762455e-05, 'batch_individual_items': 1.231940548068926e-05, 'add_time_dim_to_batch_and_zero_pad': 4.376185877596837e-06, 'add_states_from_episodes_to_batch': 2.9649357720156654e-06, 'numpy_to_tensor': 1.9713229013955548e-05}}, 'connector_pipeline_timer': 8.059387954114108e-05}, 'env_reset_timer': 0.00016307887927250703, 'sample': 2.8685768178772704, 'num_episodes_lifetime': 10, 'num_module_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'episode_return_mean': -1072.3983657499234, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 10000, 'target': 10000}, 'module_episode_returns_mean': {'servicer': -1069.514197845467, 'target': -2.88416790445646}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 10000, 'weights_seq_no': 19.0, 'env_step_timer': 0.00010468830368967792, 'episode_duration_sec_mean': 0.5612477251338229, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1069.514197845467, 'target': -2.88416790445646}, 'connector_pipeline_timer': 0.00024157135118293808, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.0001127697484565192, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.663559159812, 'time_between_sampling': 29.291633500004536}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 92000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1129.9999659037417, 'done': False, 'training_iteration': 20, 'trial_id': 'default', 'date': '2025-04-03_21-10-46', 'timestamp': 1743729046, 'time_this_iter_s': 4.05665397644043, 'time_total_s': 64.15719723701477, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 64.15719723701477, 'iterations_since_restore': 20, 'perf': {'cpu_util_percent': 80.78333333333335, 'ram_util_percent': 52.699999999999996}})
2025-04-03 21:10:49,330 [__main__] [INFO] Iter: 21/100, Ts(iter): 0, Ts(total): 96600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.07s
2025-04-03 21:10:52,573 [__main__] [INFO] Iter: 22/100, Ts(iter): 0, Ts(total): 101200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.24s
2025-04-03 21:10:55,796 [__main__] [INFO] Iter: 23/100, Ts(iter): 0, Ts(total): 105800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.22s
2025-04-03 21:10:59,144 [__main__] [INFO] Iter: 24/100, Ts(iter): 0, Ts(total): 110400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.35s
2025-04-03 21:11:02,387 [__main__] [INFO] Iter: 25/100, Ts(iter): 0, Ts(total): 115000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.24s
2025-04-03 21:11:05,658 [__main__] [INFO] Iter: 26/100, Ts(iter): 0, Ts(total): 119600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.27s
2025-04-03 21:11:08,913 [__main__] [INFO] Iter: 27/100, Ts(iter): 0, Ts(total): 124200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.26s
2025-04-03 21:11:12,080 [__main__] [INFO] Iter: 28/100, Ts(iter): 0, Ts(total): 128800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.17s
2025-04-03 21:11:15,477 [__main__] [INFO] Iter: 29/100, Ts(iter): 0, Ts(total): 133400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.40s
2025-04-03 21:11:19,934 [__main__] [INFO] Iter: 30/100, Ts(iter): 0, Ts(total): 138000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.46s
2025-04-03 21:11:19,934 [__main__] [DEBUG] Full result dict at iter 30: {'timers': {'training_iteration': 3.1351525140862444, 'restore_env_runners': 1.7654649964090972e-05, 'training_step': 3.1350020476996385, 'env_runner_sampling_timer': 0.33968342508127713, 'learner_update_timer': 2.787896566707757, 'synch_weights': 0.005806771703361911, 'synch_env_connectors': 0.007298452338751896, 'restore_eval_env_runners': 8.306977782922332e-06, 'evaluation_iteration': 3.1059307862656103, 'synch_eval_env_connectors': 0.0023655929479675254}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.107276633005417e-06, 'add_observations_from_episodes_to_batch': 1.613872767906804e-05, 'batch_individual_items': 1.781581027979421e-05, 'add_time_dim_to_batch_and_zero_pad': 6.551153997249205e-06, 'add_states_from_episodes_to_batch': 4.059450294312876e-06, 'numpy_to_tensor': 2.9453639245565702e-05}}, 'connector_pipeline_timer': 0.00011352662451533716}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21922405345416948, 'num_module_steps_sampled_lifetime': {'servicer': 138000, 'target': 138000}, 'num_agent_steps_sampled_lifetime': {'servicer': 138000, 'target': 138000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.7543151306122296e-05, 'normalize_and_clip_actions': 5.240491800631006e-05, 'module_to_agent_unmapping': 3.7248340495397655e-06, 'get_actions': 0.00012956785587859705, 'un_batch_to_individual_items': 2.0903593378325736e-05, 'listify_data_for_vector_env': 9.518117891578032e-06, 'remove_single_ts_time_rank_from_batch': 1.201748573425406e-06}}, 'connector_pipeline_timer': 0.0003092320959900937}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 138000, 'weights_seq_no': 29.0, 'env_step_timer': 0.00014567209934603765, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.25369603132646, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.25369603132646, 'rlmodule_inference_timer': 0.00014696559776757634, 'time_between_sampling': 2.918222521813524, 'episode_return_min': -1111.678909635259, 'num_episodes_lifetime': 138, 'episode_return_mean': -1098.0695567461244, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1079.5322080603673, 'target': -18.537348685756978}, 'episode_duration_sec_mean': 0.9062066247007232, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1079.5322080603673, 'target': -18.537348685756978}, 'episode_len_min': 1000, 'episode_return_max': -1079.4008449460757, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1032.6025550933966}, 'learners': {'servicer': {'policy_loss': -0.0773761123418808, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.773265361785889, 'total_loss': 4.483711242675781, 'gradients_default_optimizer_global_norm': 1.9653459787368774, 'curr_kl_coeff': 7.629394644936838e-07, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 30.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.008145689032971859, 'vf_loss_unclipped': 3729.584716796875, 'num_module_steps_trained_lifetime': 1390080, 'vf_explained_var': 0.0004912018775939941, 'entropy': 10.608914375305176}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07980509233275458, 'agent_to_module_mapping': 0.003853173263365576, 'add_observations_from_episodes_to_batch': 0.0002501065929249458, 'general_advantage_estimation': 0.029423345707191663, 'batch_individual_items': 0.07418726921967443, 'add_time_dim_to_batch_and_zero_pad': 2.9142318399080904e-05, 'add_states_from_episodes_to_batch': 8.504087294526825e-06, 'add_one_ts_to_episodes_and_truncate': 0.006132556088725452, 'numpy_to_tensor': 0.0001868692165558436}}, 'connector_pipeline_timer': 0.19414910686369738}, 'num_module_steps_trained_lifetime': 2780160, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 49956000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': 0.047690317034721375, 'vf_loss': 0.119049571454525, 'curr_kl_coeff': 1.220703143189894e-05, 'gradients_default_optimizer_global_norm': 1.9782847166061401, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 30.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.005094360094517469, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.119049571454525, 'num_module_steps_trained_lifetime': 1390080, 'vf_explained_var': 0.4940671920776367, 'policy_loss': 0.12072458118200302, 'entropy': 9.604192733764648, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.691414962435374e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6580575114872772e-05, 'add_states_from_episodes_to_batch': 4.999592802341794e-06, 'numpy_to_tensor': 4.6830660488252765e-05, 'agent_to_module_mapping': 5.291777751932386e-06, 'add_observations_from_episodes_to_batch': 3.0039132633944973e-05}}, 'episode_return_min': -1085.4126701859993, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.311161337074073e-07, 'tensor_to_numpy': 3.437132867649726e-05, 'normalize_and_clip_actions': 3.663679236722031e-05, 'module_to_agent_unmapping': 2.675206311114438e-06, 'get_actions': 3.699912420851474e-05, 'un_batch_to_individual_items': 1.4828232455155123e-05, 'listify_data_for_vector_env': 6.873395987742395e-06}}, 'connector_pipeline_timer': 0.00016445111295466797}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4569030863798226e-06, 'add_observations_from_episodes_to_batch': 1.1725803935144894e-05, 'batch_individual_items': 1.2323792624065426e-05, 'add_time_dim_to_batch_and_zero_pad': 4.379363643797479e-06, 'add_states_from_episodes_to_batch': 2.965449058943326e-06, 'numpy_to_tensor': 1.9718630984312373e-05}}, 'connector_pipeline_timer': 8.061796412366265e-05}, 'env_reset_timer': 0.00016307752865241492, 'sample': 2.8685896363522865, 'num_episodes_lifetime': 15, 'num_module_steps_sampled_lifetime': {'servicer': 15000, 'target': 15000}, 'episode_return_mean': -1073.143471056599, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 15000, 'target': 15000}, 'module_episode_returns_mean': {'servicer': -1070.1243592692203, 'target': -3.0191117873787907}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 15000, 'weights_seq_no': 29.0, 'env_step_timer': 0.00010471084582190411, 'episode_duration_sec_mean': 0.5626559612006531, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1070.1243592692203, 'target': -3.0191117873787907}, 'connector_pipeline_timer': 0.00024155201774623126, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.0001127880366955346, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.660959295686, 'time_between_sampling': 29.291750815162935}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 138000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1032.6025550933966, 'done': False, 'training_iteration': 30, 'trial_id': 'default', 'date': '2025-04-03_21-11-19', 'timestamp': 1743729079, 'time_this_iter_s': 4.442252159118652, 'time_total_s': 97.69520998001099, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 97.69520998001099, 'iterations_since_restore': 30, 'perf': {'cpu_util_percent': 80.75, 'ram_util_percent': 52.75}}
2025-04-03 21:11:23,134 [__main__] [INFO] Iter: 31/100, Ts(iter): 0, Ts(total): 142600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.20s
2025-04-03 21:11:26,357 [__main__] [INFO] Iter: 32/100, Ts(iter): 0, Ts(total): 147200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.22s
2025-04-03 21:11:29,602 [__main__] [INFO] Iter: 33/100, Ts(iter): 0, Ts(total): 151800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.24s
2025-04-03 21:11:33,031 [__main__] [INFO] Iter: 34/100, Ts(iter): 0, Ts(total): 156400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.43s
2025-04-03 21:11:36,335 [__main__] [INFO] Iter: 35/100, Ts(iter): 0, Ts(total): 161000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.30s
2025-04-03 21:11:39,453 [__main__] [INFO] Iter: 36/100, Ts(iter): 0, Ts(total): 165600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.12s
2025-04-03 21:11:42,668 [__main__] [INFO] Iter: 37/100, Ts(iter): 0, Ts(total): 170200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.21s
2025-04-03 21:11:45,691 [__main__] [INFO] Iter: 38/100, Ts(iter): 0, Ts(total): 174800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:11:49,051 [__main__] [INFO] Iter: 39/100, Ts(iter): 0, Ts(total): 179400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.36s
2025-04-03 21:11:53,238 [__main__] [INFO] Iter: 40/100, Ts(iter): 0, Ts(total): 184000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.19s
2025-04-03 21:11:53,238 [__main__] [DEBUG] Full result dict at iter 40: {'timers': {'training_iteration': 3.151755214901112, 'restore_env_runners': 1.6884517947573167e-05, 'training_step': 3.151605720800708, 'env_runner_sampling_timer': 0.3307751314432298, 'learner_update_timer': 2.8134722088499977, 'synch_weights': 0.005731235807822433, 'synch_env_connectors': 0.007294933063292719, 'restore_eval_env_runners': 8.286408044441487e-06, 'evaluation_iteration': 3.105994730902919, 'synch_eval_env_connectors': 0.0023552724384230247}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.205834461199496e-06, 'add_observations_from_episodes_to_batch': 1.7081804339646694e-05, 'batch_individual_items': 1.8486903039588367e-05, 'add_time_dim_to_batch_and_zero_pad': 6.7604525873880715e-06, 'add_states_from_episodes_to_batch': 4.270303423078886e-06, 'numpy_to_tensor': 3.168656313242792e-05}}, 'connector_pipeline_timer': 0.00012057614355514139}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21626213614157833, 'num_module_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'num_agent_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.963252817044849e-05, 'normalize_and_clip_actions': 5.570591178552873e-05, 'module_to_agent_unmapping': 3.815542857414885e-06, 'get_actions': 0.0001340042735045963, 'un_batch_to_individual_items': 2.198289030405624e-05, 'listify_data_for_vector_env': 1.0075884482809316e-05, 'remove_single_ts_time_rank_from_batch': 1.1989482503277344e-06}}, 'connector_pipeline_timer': 0.00032227868882301925}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 184000, 'weights_seq_no': 39.0, 'env_step_timer': 0.0001488946405855675, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27334257051677, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27334257051677, 'rlmodule_inference_timer': 0.00015136236629770836, 'time_between_sampling': 2.942728828455822, 'episode_return_min': -1121.908014897646, 'num_episodes_lifetime': 184, 'episode_return_mean': -1111.8823979789242, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1092.9506652537082, 'target': -18.931732725215998}, 'episode_duration_sec_mean': 0.9613375253488219, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1092.9506652537082, 'target': -18.931732725215998}, 'episode_len_min': 1000, 'episode_return_max': -1101.4306728761194, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1098.3083791752217}, 'learners': {'servicer': {'policy_loss': 0.04622916877269745, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.960058212280273, 'total_loss': 4.783199310302734, 'gradients_default_optimizer_global_norm': 1.0294883251190186, 'curr_kl_coeff': 2.3841858265427618e-08, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 40.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.007856343872845173, 'vf_loss_unclipped': 4230.8310546875, 'num_module_steps_trained_lifetime': 1853440, 'vf_explained_var': 0.0003121495246887207, 'entropy': 11.154372215270996}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07985322775620395, 'agent_to_module_mapping': 0.003861625914918097, 'add_observations_from_episodes_to_batch': 0.0002496424121971742, 'general_advantage_estimation': 0.029058948543783034, 'batch_individual_items': 0.07484928406466358, 'add_time_dim_to_batch_and_zero_pad': 2.8812083546516478e-05, 'add_states_from_episodes_to_batch': 8.417360672319199e-06, 'add_one_ts_to_episodes_and_truncate': 0.006116261543486914, 'numpy_to_tensor': 0.00018583385903064812}}, 'connector_pipeline_timer': 0.1944813556255549}, 'num_module_steps_trained_lifetime': 3706880, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 66608000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.14590394496917725, 'vf_loss': 0.13279989361763, 'curr_kl_coeff': 7.629394644936838e-07, 'gradients_default_optimizer_global_norm': 1.5137237310409546, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 40.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.006096229888498783, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.13279989361763, 'num_module_steps_trained_lifetime': 1853440, 'vf_explained_var': 0.4086408019065857, 'policy_loss': -0.07279684394598007, 'entropy': 10.29534912109375, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6912420076664418e-05, 'add_time_dim_to_batch_and_zero_pad': 1.657846547916939e-05, 'add_states_from_episodes_to_batch': 4.9991841490911606e-06, 'numpy_to_tensor': 4.6829878181301904e-05, 'agent_to_module_mapping': 5.291527769728564e-06, 'add_observations_from_episodes_to_batch': 3.0037312004320557e-05}}, 'episode_return_min': -1085.4126701859993, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.309469920880218e-07, 'tensor_to_numpy': 3.43652086243382e-05, 'normalize_and_clip_actions': 3.662351064819898e-05, 'module_to_agent_unmapping': 2.6745093759414587e-06, 'get_actions': 3.69852561695921e-05, 'un_batch_to_individual_items': 1.482865713241485e-05, 'listify_data_for_vector_env': 6.8726709787445714e-06}}, 'connector_pipeline_timer': 0.00016441231038985863}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4523357834218993e-06, 'add_observations_from_episodes_to_batch': 1.1718318969233459e-05, 'batch_individual_items': 1.2318087104434052e-05, 'add_time_dim_to_batch_and_zero_pad': 4.37832942754481e-06, 'add_states_from_episodes_to_batch': 2.9648123619529275e-06, 'numpy_to_tensor': 1.9715704450017833e-05}}, 'connector_pipeline_timer': 8.059217130494929e-05}, 'env_reset_timer': 0.0001630720888561495, 'sample': 2.8686027955551148, 'num_episodes_lifetime': 20, 'num_module_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'episode_return_mean': -1072.4193410013484, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'module_episode_returns_mean': {'servicer': -1069.1225859666038, 'target': -3.296755034744742}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 20000, 'weights_seq_no': 39.0, 'env_step_timer': 0.00010467135102698012, 'episode_duration_sec_mean': 0.5629221125604817, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1069.1225859666038, 'target': -3.296755034744742}, 'connector_pipeline_timer': 0.00024152338044340006, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.0001127483454090946, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6525835143452, 'time_between_sampling': 29.291996060993167}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 184000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1098.3083791752217, 'done': False, 'training_iteration': 40, 'trial_id': 'default', 'date': '2025-04-03_21-11-53', 'timestamp': 1743729113, 'time_this_iter_s': 4.171972036361694, 'time_total_s': 130.8535692691803, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 130.8535692691803, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 80.66666666666667, 'ram_util_percent': 52.800000000000004}}
2025-04-03 21:11:53,258 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.151755214901112, 'restore_env_runners': 1.6884517947573167e-05, 'training_step': 3.151605720800708, 'env_runner_sampling_timer': 0.3307751314432298, 'learner_update_timer': 2.8134722088499977, 'synch_weights': 0.005731235807822433, 'synch_env_connectors': 0.007294933063292719, 'restore_eval_env_runners': 8.286408044441487e-06, 'evaluation_iteration': 3.105994730902919, 'synch_eval_env_connectors': 0.0023552724384230247}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.205834461199496e-06, 'add_observations_from_episodes_to_batch': 1.7081804339646694e-05, 'batch_individual_items': 1.8486903039588367e-05, 'add_time_dim_to_batch_and_zero_pad': 6.7604525873880715e-06, 'add_states_from_episodes_to_batch': 4.270303423078886e-06, 'numpy_to_tensor': 3.168656313242792e-05}}, 'connector_pipeline_timer': 0.00012057614355514139}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21626213614157833, 'num_module_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'num_agent_steps_sampled_lifetime': {'servicer': 184000, 'target': 184000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.963252817044849e-05, 'normalize_and_clip_actions': 5.570591178552873e-05, 'module_to_agent_unmapping': 3.815542857414885e-06, 'get_actions': 0.0001340042735045963, 'un_batch_to_individual_items': 2.198289030405624e-05, 'listify_data_for_vector_env': 1.0075884482809316e-05, 'remove_single_ts_time_rank_from_batch': 1.1989482503277344e-06}}, 'connector_pipeline_timer': 0.00032227868882301925}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 184000, 'weights_seq_no': 39.0, 'env_step_timer': 0.0001488946405855675, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27334257051677, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27334257051677, 'rlmodule_inference_timer': 0.00015136236629770836, 'time_between_sampling': 2.942728828455822, 'episode_return_min': -1121.908014897646, 'num_episodes_lifetime': 184, 'episode_return_mean': -1111.8823979789242, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1092.9506652537082, 'target': -18.931732725215998}, 'episode_duration_sec_mean': 0.9613375253488219, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1092.9506652537082, 'target': -18.931732725215998}, 'episode_len_min': 1000, 'episode_return_max': -1101.4306728761194, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1098.3083791752217}, 'learners': {'servicer': {'policy_loss': 0.04622916877269745, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.960058212280273, 'total_loss': 4.783199310302734, 'gradients_default_optimizer_global_norm': 1.0294883251190186, 'curr_kl_coeff': 2.3841858265427618e-08, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 40.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.007856343872845173, 'vf_loss_unclipped': 4230.8310546875, 'num_module_steps_trained_lifetime': 1853440, 'vf_explained_var': 0.0003121495246887207, 'entropy': 11.154372215270996}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07985322775620395, 'agent_to_module_mapping': 0.003861625914918097, 'add_observations_from_episodes_to_batch': 0.0002496424121971742, 'general_advantage_estimation': 0.029058948543783034, 'batch_individual_items': 0.07484928406466358, 'add_time_dim_to_batch_and_zero_pad': 2.8812083546516478e-05, 'add_states_from_episodes_to_batch': 8.417360672319199e-06, 'add_one_ts_to_episodes_and_truncate': 0.006116261543486914, 'numpy_to_tensor': 0.00018583385903064812}}, 'connector_pipeline_timer': 0.1944813556255549}, 'num_module_steps_trained_lifetime': 3706880, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 66608000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.14590394496917725, 'vf_loss': 0.13279989361763, 'curr_kl_coeff': 7.629394644936838e-07, 'gradients_default_optimizer_global_norm': 1.5137237310409546, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 40.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.006096229888498783, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.13279989361763, 'num_module_steps_trained_lifetime': 1853440, 'vf_explained_var': 0.4086408019065857, 'policy_loss': -0.07279684394598007, 'entropy': 10.29534912109375, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6912420076664418e-05, 'add_time_dim_to_batch_and_zero_pad': 1.657846547916939e-05, 'add_states_from_episodes_to_batch': 4.9991841490911606e-06, 'numpy_to_tensor': 4.6829878181301904e-05, 'agent_to_module_mapping': 5.291527769728564e-06, 'add_observations_from_episodes_to_batch': 3.0037312004320557e-05}}, 'episode_return_min': -1085.4126701859993, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.309469920880218e-07, 'tensor_to_numpy': 3.43652086243382e-05, 'normalize_and_clip_actions': 3.662351064819898e-05, 'module_to_agent_unmapping': 2.6745093759414587e-06, 'get_actions': 3.69852561695921e-05, 'un_batch_to_individual_items': 1.482865713241485e-05, 'listify_data_for_vector_env': 6.8726709787445714e-06}}, 'connector_pipeline_timer': 0.00016441231038985863}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4523357834218993e-06, 'add_observations_from_episodes_to_batch': 1.1718318969233459e-05, 'batch_individual_items': 1.2318087104434052e-05, 'add_time_dim_to_batch_and_zero_pad': 4.37832942754481e-06, 'add_states_from_episodes_to_batch': 2.9648123619529275e-06, 'numpy_to_tensor': 1.9715704450017833e-05}}, 'connector_pipeline_timer': 8.059217130494929e-05}, 'env_reset_timer': 0.0001630720888561495, 'sample': 2.8686027955551148, 'num_episodes_lifetime': 20, 'num_module_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'episode_return_mean': -1072.4193410013484, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 20000, 'target': 20000}, 'module_episode_returns_mean': {'servicer': -1069.1225859666038, 'target': -3.296755034744742}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 20000, 'weights_seq_no': 39.0, 'env_step_timer': 0.00010467135102698012, 'episode_duration_sec_mean': 0.5629221125604817, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1069.1225859666038, 'target': -3.296755034744742}, 'connector_pipeline_timer': 0.00024152338044340006, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.0001127483454090946, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6525835143452, 'time_between_sampling': 29.291996060993167}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 184000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1098.3083791752217, 'done': False, 'training_iteration': 40, 'trial_id': 'default', 'date': '2025-04-03_21-11-53', 'timestamp': 1743729113, 'time_this_iter_s': 4.171972036361694, 'time_total_s': 130.8535692691803, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 130.8535692691803, 'iterations_since_restore': 40, 'perf': {'cpu_util_percent': 80.66666666666667, 'ram_util_percent': 52.800000000000004}})
2025-04-03 21:11:56,415 [__main__] [INFO] Iter: 41/100, Ts(iter): 0, Ts(total): 188600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.16s
2025-04-03 21:11:59,466 [__main__] [INFO] Iter: 42/100, Ts(iter): 0, Ts(total): 193200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.05s
2025-04-03 21:12:02,571 [__main__] [INFO] Iter: 43/100, Ts(iter): 0, Ts(total): 197800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.10s
2025-04-03 21:12:05,636 [__main__] [INFO] Iter: 44/100, Ts(iter): 0, Ts(total): 202400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.06s
2025-04-03 21:12:08,724 [__main__] [INFO] Iter: 45/100, Ts(iter): 0, Ts(total): 207000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.09s
2025-04-03 21:12:12,059 [__main__] [INFO] Iter: 46/100, Ts(iter): 0, Ts(total): 211600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.33s
2025-04-03 21:12:15,240 [__main__] [INFO] Iter: 47/100, Ts(iter): 0, Ts(total): 216200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.18s
2025-04-03 21:12:18,451 [__main__] [INFO] Iter: 48/100, Ts(iter): 0, Ts(total): 220800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.21s
2025-04-03 21:12:21,727 [__main__] [INFO] Iter: 49/100, Ts(iter): 0, Ts(total): 225400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.28s
2025-04-03 21:12:26,002 [__main__] [INFO] Iter: 50/100, Ts(iter): 0, Ts(total): 230000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.28s
2025-04-03 21:12:26,003 [__main__] [DEBUG] Full result dict at iter 50: {'timers': {'training_iteration': 3.1615897480810946, 'restore_env_runners': 1.6169173369346498e-05, 'training_step': 3.161440827903555, 'env_runner_sampling_timer': 0.3237769884243754, 'learner_update_timer': 2.830361426416654, 'synch_weights': 0.005647683793058077, 'synch_env_connectors': 0.0072992648336724425, 'restore_eval_env_runners': 8.273543914934999e-06, 'evaluation_iteration': 3.1059773331838003, 'synch_eval_env_connectors': 0.002350099294035485}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.243447733394609e-06, 'add_observations_from_episodes_to_batch': 1.685329096178433e-05, 'batch_individual_items': 1.8220972008843794e-05, 'add_time_dim_to_batch_and_zero_pad': 6.924229746057836e-06, 'add_states_from_episodes_to_batch': 4.298042046325037e-06, 'numpy_to_tensor': 3.096098359016637e-05}}, 'connector_pipeline_timer': 0.0001186168842497623}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21437850171696562, 'num_module_steps_sampled_lifetime': {'servicer': 230000, 'target': 230000}, 'num_agent_steps_sampled_lifetime': {'servicer': 230000, 'target': 230000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.881956649991016e-05, 'normalize_and_clip_actions': 5.3629414518661696e-05, 'module_to_agent_unmapping': 3.8206470652920335e-06, 'get_actions': 0.0001325416502392019, 'un_batch_to_individual_items': 2.151532166459608e-05, 'listify_data_for_vector_env': 9.642601292120436e-06, 'remove_single_ts_time_rank_from_batch': 1.1906679663129725e-06}}, 'connector_pipeline_timer': 0.0003163223444227108}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 230000, 'weights_seq_no': 49.0, 'env_step_timer': 0.00014780166305601998, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27528963715886, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27528963715886, 'rlmodule_inference_timer': 0.00015190751000053278, 'time_between_sampling': 2.9559304026695594, 'episode_return_min': -1135.7533629378627, 'num_episodes_lifetime': 230, 'episode_return_mean': -1122.768910407047, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1103.398816241556, 'target': -19.37009416549102}, 'episode_duration_sec_mean': 0.8733875343016774, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1103.398816241556, 'target': -19.37009416549102}, 'episode_len_min': 1000, 'episode_return_max': -1110.1628058772055, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1077.1450505424025}, 'learners': {'servicer': {'policy_loss': -0.0003054235130548477, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.962496757507324, 'total_loss': 4.735238075256348, 'gradients_default_optimizer_global_norm': 1.6356863975524902, 'curr_kl_coeff': 5.9604645663569045e-09, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 50.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.006218714639544487, 'vf_loss_unclipped': 4340.66162109375, 'num_module_steps_trained_lifetime': 2316800, 'vf_explained_var': 0.0003495216369628906, 'entropy': 11.347686767578125}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07991033268503116, 'agent_to_module_mapping': 0.003871261768450487, 'add_observations_from_episodes_to_batch': 0.000249103529270298, 'general_advantage_estimation': 0.028636523033708665, 'batch_individual_items': 0.07554513850413441, 'add_time_dim_to_batch_and_zero_pad': 2.8427492045174408e-05, 'add_states_from_episodes_to_batch': 8.308241292131958e-06, 'add_one_ts_to_episodes_and_truncate': 0.006099302825304746, 'numpy_to_tensor': 0.00018460840612331196}}, 'connector_pipeline_timer': 0.19479795804191147}, 'num_module_steps_trained_lifetime': 4633600, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 83260000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.011799695901572704, 'vf_loss': 0.09469829499721527, 'curr_kl_coeff': 9.536743306171047e-08, 'gradients_default_optimizer_global_norm': 2.8848814964294434, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 50.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.004504441283643246, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.09469829499721527, 'num_module_steps_trained_lifetime': 2316800, 'vf_explained_var': 0.560226321220398, 'policy_loss': 0.10708752274513245, 'entropy': 10.679276466369629, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.691010450507668e-05, 'add_time_dim_to_batch_and_zero_pad': 1.657584407904309e-05, 'add_states_from_episodes_to_batch': 4.998696209855902e-06, 'numpy_to_tensor': 4.682852015468919e-05, 'agent_to_module_mapping': 5.291178609719401e-06, 'add_observations_from_episodes_to_batch': 3.0035240573989603e-05}}, 'episode_return_min': -1085.4126701859993, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.305007095141624e-07, 'tensor_to_numpy': 3.436910088971048e-05, 'normalize_and_clip_actions': 3.661891638513209e-05, 'module_to_agent_unmapping': 2.673308947165453e-06, 'get_actions': 3.698610807742361e-05, 'un_batch_to_individual_items': 1.482928301523368e-05, 'listify_data_for_vector_env': 6.873376048896785e-06}}, 'connector_pipeline_timer': 0.0001644127457164616}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.448386297616662e-06, 'add_observations_from_episodes_to_batch': 1.1716494961949183e-05, 'batch_individual_items': 1.2315226910969953e-05, 'add_time_dim_to_batch_and_zero_pad': 4.376517236109507e-06, 'add_states_from_episodes_to_batch': 2.9641856226813356e-06, 'numpy_to_tensor': 1.9709847990590545e-05}}, 'connector_pipeline_timer': 8.057387748831107e-05}, 'env_reset_timer': 0.00016306257090245487, 'sample': 2.868619869447751, 'num_episodes_lifetime': 25, 'num_module_steps_sampled_lifetime': {'servicer': 25000, 'target': 25000}, 'episode_return_mean': -1071.7765438064891, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 25000, 'target': 25000}, 'module_episode_returns_mean': {'servicer': -1068.0911078355869, 'target': -3.6854359709024447}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 25000, 'weights_seq_no': 49.0, 'env_step_timer': 0.00010465299049405392, 'episode_duration_sec_mean': 0.563362179506997, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1068.0911078355869, 'target': -3.6854359709024447}, 'connector_pipeline_timer': 0.00024148627318350957, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.0001127149649621637, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6439600685806, 'time_between_sampling': 29.29228292989198}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 230000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1077.1450505424025, 'done': False, 'training_iteration': 50, 'trial_id': 'default', 'date': '2025-04-03_21-12-25', 'timestamp': 1743729145, 'time_this_iter_s': 4.257052898406982, 'time_total_s': 163.4501075744629, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 163.4501075744629, 'iterations_since_restore': 50, 'perf': {'cpu_util_percent': 79.81666666666666, 'ram_util_percent': 52.86666666666667}}
2025-04-03 21:12:29,427 [__main__] [INFO] Iter: 51/100, Ts(iter): 0, Ts(total): 234600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.42s
2025-04-03 21:12:32,393 [__main__] [INFO] Iter: 52/100, Ts(iter): 0, Ts(total): 239200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.97s
2025-04-03 21:12:35,558 [__main__] [INFO] Iter: 53/100, Ts(iter): 0, Ts(total): 243800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.16s
2025-04-03 21:12:38,599 [__main__] [INFO] Iter: 54/100, Ts(iter): 0, Ts(total): 248400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.04s
2025-04-03 21:12:41,599 [__main__] [INFO] Iter: 55/100, Ts(iter): 0, Ts(total): 253000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.00s
2025-04-03 21:12:44,676 [__main__] [INFO] Iter: 56/100, Ts(iter): 0, Ts(total): 257600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.08s
2025-04-03 21:12:47,949 [__main__] [INFO] Iter: 57/100, Ts(iter): 0, Ts(total): 262200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.27s
2025-04-03 21:12:51,266 [__main__] [INFO] Iter: 58/100, Ts(iter): 0, Ts(total): 266800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.32s
2025-04-03 21:12:54,468 [__main__] [INFO] Iter: 59/100, Ts(iter): 0, Ts(total): 271400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.20s
2025-04-03 21:12:58,805 [__main__] [INFO] Iter: 60/100, Ts(iter): 0, Ts(total): 276000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.34s
2025-04-03 21:12:58,806 [__main__] [DEBUG] Full result dict at iter 60: {'timers': {'training_iteration': 3.171143384384612, 'restore_env_runners': 1.5524646913964833e-05, 'training_step': 3.1709937992109927, 'env_runner_sampling_timer': 0.3178548672216332, 'learner_update_timer': 2.845912789875834, 'synch_weights': 0.005564321903847278, 'synch_env_connectors': 0.0073108125265112026, 'restore_eval_env_runners': 8.245808458025326e-06, 'evaluation_iteration': 3.1063395377719254, 'synch_eval_env_connectors': 0.0023417662210140247}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.5563781453254435e-06, 'add_observations_from_episodes_to_batch': 1.7601004183714034e-05, 'batch_individual_items': 1.9609809067590178e-05, 'add_time_dim_to_batch_and_zero_pad': 7.3198003562541165e-06, 'add_states_from_episodes_to_batch': 4.2453821117954665e-06, 'numpy_to_tensor': 3.2854998392569885e-05}}, 'connector_pipeline_timer': 0.0001251353241410929}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21334507880768053, 'num_module_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'num_agent_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.192078650110064e-05, 'normalize_and_clip_actions': 5.818357682245986e-05, 'module_to_agent_unmapping': 3.8855209293951116e-06, 'get_actions': 0.00014218139031182137, 'un_batch_to_individual_items': 2.337187039199049e-05, 'listify_data_for_vector_env': 1.0339495619185651e-05, 'remove_single_ts_time_rank_from_batch': 1.2507630474190118e-06}}, 'connector_pipeline_timer': 0.0003410394427162862}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 276000, 'weights_seq_no': 59.0, 'env_step_timer': 0.00015957071748726672, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27548260083915, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27548260083915, 'rlmodule_inference_timer': 0.0001623824968613693, 'time_between_sampling': 2.9674092679474176, 'episode_return_min': -1126.4298987504014, 'num_episodes_lifetime': 276, 'episode_return_mean': -1111.4748697915468, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1091.7367601032804, 'target': -19.738109688266466}, 'episode_duration_sec_mean': 1.0271732680431223, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1091.7367601032804, 'target': -19.738109688266466}, 'episode_len_min': 1000, 'episode_return_max': -1099.766199547149, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1060.2409305345036}, 'learners': {'servicer': {'policy_loss': -0.034021999686956406, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 5.0, 'total_loss': 4.753520488739014, 'gradients_default_optimizer_global_norm': 1.4365493059158325, 'curr_kl_coeff': 7.450580707946131e-10, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 60.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.007029891014099121, 'vf_loss_unclipped': 3925.114501953125, 'num_module_steps_trained_lifetime': 2780160, 'vf_explained_var': 0.0006416440010070801, 'entropy': 10.622862815856934}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07997778409086807, 'agent_to_module_mapping': 0.003882256659563535, 'add_observations_from_episodes_to_batch': 0.0002487037601569224, 'general_advantage_estimation': 0.028164543950753167, 'batch_individual_items': 0.07635653463626016, 'add_time_dim_to_batch_and_zero_pad': 2.7998319498508774e-05, 'add_states_from_episodes_to_batch': 8.182116424314983e-06, 'add_one_ts_to_episodes_and_truncate': 0.006080392496318466, 'numpy_to_tensor': 0.0001832623013954478}}, 'connector_pipeline_timer': 0.19518989981711132}, 'num_module_steps_trained_lifetime': 5560320, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 99912000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.12423212081193924, 'vf_loss': 0.082685686647892, 'curr_kl_coeff': 5.9604645663569045e-09, 'gradients_default_optimizer_global_norm': 1.2011206150054932, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 60.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.005323098506778479, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.082685686647892, 'num_module_steps_trained_lifetime': 2780160, 'vf_explained_var': 0.6197832822799683, 'policy_loss': 0.014166693203151226, 'entropy': 11.054224014282227, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.69097732028882e-05, 'add_time_dim_to_batch_and_zero_pad': 1.657379646060855e-05, 'add_states_from_episodes_to_batch': 4.9986514111703325e-06, 'numpy_to_tensor': 4.683193129979763e-05, 'agent_to_module_mapping': 5.29143647965134e-06, 'add_observations_from_episodes_to_batch': 3.003536514140175e-05}}, 'episode_return_min': -1090.388138358216, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.305776029929681e-07, 'tensor_to_numpy': 3.4365492531724214e-05, 'normalize_and_clip_actions': 3.6612075828670973e-05, 'module_to_agent_unmapping': 2.674925856480213e-06, 'get_actions': 3.697624105080772e-05, 'un_batch_to_individual_items': 1.48321718393702e-05, 'listify_data_for_vector_env': 6.873273865185591e-06}}, 'connector_pipeline_timer': 0.0001643980213155922}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4464897387497997e-06, 'add_observations_from_episodes_to_batch': 1.1712914347453e-05, 'batch_individual_items': 1.2313580879132835e-05, 'add_time_dim_to_batch_and_zero_pad': 4.3750555810480805e-06, 'add_states_from_episodes_to_batch': 2.964203982232096e-06, 'numpy_to_tensor': 1.970897205884424e-05}}, 'connector_pipeline_timer': 8.056326130002519e-05}, 'env_reset_timer': 0.00016307600279921334, 'sample': 2.8686434555746794, 'num_episodes_lifetime': 30, 'num_module_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'episode_return_mean': -1071.9274502096732, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'module_episode_returns_mean': {'servicer': -1067.8006506081035, 'target': -4.126799601569773}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 30000, 'weights_seq_no': 59.0, 'env_step_timer': 0.00010463351744050361, 'episode_duration_sec_mean': 0.5642446667300828, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1067.8006506081035, 'target': -4.126799601569773}, 'connector_pipeline_timer': 0.00024145842663000867, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011267883181936234, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6355130275335, 'time_between_sampling': 29.292620649560813}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 276000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1060.2409305345036, 'done': False, 'training_iteration': 60, 'trial_id': 'default', 'date': '2025-04-03_21-12-58', 'timestamp': 1743729178, 'time_this_iter_s': 4.324597120285034, 'time_total_s': 196.1059205532074, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 196.1059205532074, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 79.03333333333335, 'ram_util_percent': 52.800000000000004}}
2025-04-03 21:12:58,826 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.171143384384612, 'restore_env_runners': 1.5524646913964833e-05, 'training_step': 3.1709937992109927, 'env_runner_sampling_timer': 0.3178548672216332, 'learner_update_timer': 2.845912789875834, 'synch_weights': 0.005564321903847278, 'synch_env_connectors': 0.0073108125265112026, 'restore_eval_env_runners': 8.245808458025326e-06, 'evaluation_iteration': 3.1063395377719254, 'synch_eval_env_connectors': 0.0023417662210140247}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.5563781453254435e-06, 'add_observations_from_episodes_to_batch': 1.7601004183714034e-05, 'batch_individual_items': 1.9609809067590178e-05, 'add_time_dim_to_batch_and_zero_pad': 7.3198003562541165e-06, 'add_states_from_episodes_to_batch': 4.2453821117954665e-06, 'numpy_to_tensor': 3.2854998392569885e-05}}, 'connector_pipeline_timer': 0.0001251353241410929}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21334507880768053, 'num_module_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'num_agent_steps_sampled_lifetime': {'servicer': 276000, 'target': 276000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.192078650110064e-05, 'normalize_and_clip_actions': 5.818357682245986e-05, 'module_to_agent_unmapping': 3.8855209293951116e-06, 'get_actions': 0.00014218139031182137, 'un_batch_to_individual_items': 2.337187039199049e-05, 'listify_data_for_vector_env': 1.0339495619185651e-05, 'remove_single_ts_time_rank_from_batch': 1.2507630474190118e-06}}, 'connector_pipeline_timer': 0.0003410394427162862}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 276000, 'weights_seq_no': 59.0, 'env_step_timer': 0.00015957071748726672, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27548260083915, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27548260083915, 'rlmodule_inference_timer': 0.0001623824968613693, 'time_between_sampling': 2.9674092679474176, 'episode_return_min': -1126.4298987504014, 'num_episodes_lifetime': 276, 'episode_return_mean': -1111.4748697915468, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1091.7367601032804, 'target': -19.738109688266466}, 'episode_duration_sec_mean': 1.0271732680431223, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1091.7367601032804, 'target': -19.738109688266466}, 'episode_len_min': 1000, 'episode_return_max': -1099.766199547149, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1060.2409305345036}, 'learners': {'servicer': {'policy_loss': -0.034021999686956406, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 5.0, 'total_loss': 4.753520488739014, 'gradients_default_optimizer_global_norm': 1.4365493059158325, 'curr_kl_coeff': 7.450580707946131e-10, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 60.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.007029891014099121, 'vf_loss_unclipped': 3925.114501953125, 'num_module_steps_trained_lifetime': 2780160, 'vf_explained_var': 0.0006416440010070801, 'entropy': 10.622862815856934}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.07997778409086807, 'agent_to_module_mapping': 0.003882256659563535, 'add_observations_from_episodes_to_batch': 0.0002487037601569224, 'general_advantage_estimation': 0.028164543950753167, 'batch_individual_items': 0.07635653463626016, 'add_time_dim_to_batch_and_zero_pad': 2.7998319498508774e-05, 'add_states_from_episodes_to_batch': 8.182116424314983e-06, 'add_one_ts_to_episodes_and_truncate': 0.006080392496318466, 'numpy_to_tensor': 0.0001832623013954478}}, 'connector_pipeline_timer': 0.19518989981711132}, 'num_module_steps_trained_lifetime': 5560320, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 99912000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.12423212081193924, 'vf_loss': 0.082685686647892, 'curr_kl_coeff': 5.9604645663569045e-09, 'gradients_default_optimizer_global_norm': 1.2011206150054932, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 60.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.005323098506778479, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.082685686647892, 'num_module_steps_trained_lifetime': 2780160, 'vf_explained_var': 0.6197832822799683, 'policy_loss': 0.014166693203151226, 'entropy': 11.054224014282227, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.69097732028882e-05, 'add_time_dim_to_batch_and_zero_pad': 1.657379646060855e-05, 'add_states_from_episodes_to_batch': 4.9986514111703325e-06, 'numpy_to_tensor': 4.683193129979763e-05, 'agent_to_module_mapping': 5.29143647965134e-06, 'add_observations_from_episodes_to_batch': 3.003536514140175e-05}}, 'episode_return_min': -1090.388138358216, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.305776029929681e-07, 'tensor_to_numpy': 3.4365492531724214e-05, 'normalize_and_clip_actions': 3.6612075828670973e-05, 'module_to_agent_unmapping': 2.674925856480213e-06, 'get_actions': 3.697624105080772e-05, 'un_batch_to_individual_items': 1.48321718393702e-05, 'listify_data_for_vector_env': 6.873273865185591e-06}}, 'connector_pipeline_timer': 0.0001643980213155922}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4464897387497997e-06, 'add_observations_from_episodes_to_batch': 1.1712914347453e-05, 'batch_individual_items': 1.2313580879132835e-05, 'add_time_dim_to_batch_and_zero_pad': 4.3750555810480805e-06, 'add_states_from_episodes_to_batch': 2.964203982232096e-06, 'numpy_to_tensor': 1.970897205884424e-05}}, 'connector_pipeline_timer': 8.056326130002519e-05}, 'env_reset_timer': 0.00016307600279921334, 'sample': 2.8686434555746794, 'num_episodes_lifetime': 30, 'num_module_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'episode_return_mean': -1071.9274502096732, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 30000, 'target': 30000}, 'module_episode_returns_mean': {'servicer': -1067.8006506081035, 'target': -4.126799601569773}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 30000, 'weights_seq_no': 59.0, 'env_step_timer': 0.00010463351744050361, 'episode_duration_sec_mean': 0.5642446667300828, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1067.8006506081035, 'target': -4.126799601569773}, 'connector_pipeline_timer': 0.00024145842663000867, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011267883181936234, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6355130275335, 'time_between_sampling': 29.292620649560813}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 276000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1060.2409305345036, 'done': False, 'training_iteration': 60, 'trial_id': 'default', 'date': '2025-04-03_21-12-58', 'timestamp': 1743729178, 'time_this_iter_s': 4.324597120285034, 'time_total_s': 196.1059205532074, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 196.1059205532074, 'iterations_since_restore': 60, 'perf': {'cpu_util_percent': 79.03333333333335, 'ram_util_percent': 52.800000000000004}})
2025-04-03 21:13:01,999 [__main__] [INFO] Iter: 61/100, Ts(iter): 0, Ts(total): 280600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.17s
2025-04-03 21:13:05,321 [__main__] [INFO] Iter: 62/100, Ts(iter): 0, Ts(total): 285200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.32s
2025-04-03 21:13:08,394 [__main__] [INFO] Iter: 63/100, Ts(iter): 0, Ts(total): 289800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.07s
2025-04-03 21:13:11,742 [__main__] [INFO] Iter: 64/100, Ts(iter): 0, Ts(total): 294400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.35s
2025-04-03 21:13:15,098 [__main__] [INFO] Iter: 65/100, Ts(iter): 0, Ts(total): 299000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.36s
2025-04-03 21:13:18,390 [__main__] [INFO] Iter: 66/100, Ts(iter): 0, Ts(total): 303600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.29s
2025-04-03 21:13:21,520 [__main__] [INFO] Iter: 67/100, Ts(iter): 0, Ts(total): 308200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.13s
2025-04-03 21:13:24,732 [__main__] [INFO] Iter: 68/100, Ts(iter): 0, Ts(total): 312800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.21s
2025-04-03 21:13:28,035 [__main__] [INFO] Iter: 69/100, Ts(iter): 0, Ts(total): 317400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.30s
2025-04-03 21:13:32,204 [__main__] [INFO] Iter: 70/100, Ts(iter): 0, Ts(total): 322000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.17s
2025-04-03 21:13:32,205 [__main__] [DEBUG] Full result dict at iter 70: {'timers': {'training_iteration': 3.184991697145925, 'restore_env_runners': 1.4986346412461288e-05, 'training_step': 3.184842229958405, 'env_runner_sampling_timer': 0.3111783432207946, 'learner_update_timer': 2.8664710035978724, 'synch_weights': 0.005516403444226564, 'synch_env_connectors': 0.007336517984542571, 'restore_eval_env_runners': 8.20626033347472e-06, 'evaluation_iteration': 3.1061925890541824, 'synch_eval_env_connectors': 0.002340372718792971}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.286125884351944e-06, 'add_observations_from_episodes_to_batch': 1.6931289016471665e-05, 'batch_individual_items': 1.9868923414347476e-05, 'add_time_dim_to_batch_and_zero_pad': 6.796527697295199e-06, 'add_states_from_episodes_to_batch': 4.114760314696385e-06, 'numpy_to_tensor': 3.165490576198006e-05}}, 'connector_pipeline_timer': 0.00012072067268842534}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.21186803640950988, 'num_module_steps_sampled_lifetime': {'servicer': 322000, 'target': 322000}, 'num_agent_steps_sampled_lifetime': {'servicer': 322000, 'target': 322000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.065739042105235e-05, 'normalize_and_clip_actions': 5.4621708459670016e-05, 'module_to_agent_unmapping': 3.857192462044924e-06, 'get_actions': 0.00013491497623613986, 'un_batch_to_individual_items': 2.1531640617002426e-05, 'listify_data_for_vector_env': 9.881825653392627e-06, 'remove_single_ts_time_rank_from_batch': 1.1656226831301357e-06}}, 'connector_pipeline_timer': 0.0003259560590939841}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 322000, 'weights_seq_no': 69.0, 'env_step_timer': 0.00015259458830764274, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27550172446908, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27550172446908, 'rlmodule_inference_timer': 0.00015331737499794308, 'time_between_sampling': 2.983422628675156, 'episode_return_min': -1138.7705358042278, 'num_episodes_lifetime': 322, 'episode_return_mean': -1125.2658453230488, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1105.2504344035221, 'target': -20.015410919526357}, 'episode_duration_sec_mean': 0.9305696452179488, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1105.2504344035221, 'target': -20.015410919526357}, 'episode_len_min': 1000, 'episode_return_max': -1117.0778612242314, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1103.277683921471}, 'learners': {'servicer': {'policy_loss': -0.023725885897874832, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.963027000427246, 'total_loss': 4.711328506469727, 'gradients_default_optimizer_global_norm': 2.622274875640869, 'curr_kl_coeff': 1.8626451769865326e-10, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 70.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.008892892859876156, 'vf_loss_unclipped': 4470.1357421875, 'num_module_steps_trained_lifetime': 3243520, 'vf_explained_var': -5.9723854064941406e-05, 'entropy': 11.398639678955078}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.08004886368057447, 'agent_to_module_mapping': 0.0038949238794741925, 'add_observations_from_episodes_to_batch': 0.00024830766429791655, 'general_advantage_estimation': 0.027660286962875726, 'batch_individual_items': 0.07723545620103421, 'add_time_dim_to_batch_and_zero_pad': 2.752606053307033e-05, 'add_states_from_episodes_to_batch': 8.042228560892284e-06, 'add_one_ts_to_episodes_and_truncate': 0.006061059610460748, 'numpy_to_tensor': 0.0001818080788049824}}, 'connector_pipeline_timer': 0.19562154119884836}, 'num_module_steps_trained_lifetime': 6487040, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 116564000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.16209420561790466, 'vf_loss': 0.13222715258598328, 'curr_kl_coeff': 1.8626451769865326e-10, 'gradients_default_optimizer_global_norm': 1.7985187768936157, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 70.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.0076120030134916306, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.13222715258598328, 'num_module_steps_trained_lifetime': 3243520, 'vf_explained_var': 0.43649446964263916, 'policy_loss': -0.05805026739835739, 'entropy': 11.813554763793945, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6909378316225612e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6571019709616705e-05, 'add_states_from_episodes_to_batch': 4.99857853881428e-06, 'numpy_to_tensor': 4.6834349671306585e-05, 'agent_to_module_mapping': 5.291718374558511e-06, 'add_observations_from_episodes_to_batch': 3.003572119332192e-05}}, 'episode_return_min': -1116.965619994999, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.306924171414573e-07, 'tensor_to_numpy': 3.4358586793586003e-05, 'normalize_and_clip_actions': 3.659970882963517e-05, 'module_to_agent_unmapping': 2.6747641401388784e-06, 'get_actions': 3.6965952484828445e-05, 'un_batch_to_individual_items': 1.4830091396256159e-05, 'listify_data_for_vector_env': 6.8734721239690355e-06}}, 'connector_pipeline_timer': 0.00016436518345040667}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4417380985724904e-06, 'add_observations_from_episodes_to_batch': 1.171066247126498e-05, 'batch_individual_items': 1.2313865587879577e-05, 'add_time_dim_to_batch_and_zero_pad': 4.373540100401402e-06, 'add_states_from_episodes_to_batch': 2.964513978010946e-06, 'numpy_to_tensor': 1.9701178123459684e-05}}, 'connector_pipeline_timer': 8.054299871040333e-05}, 'env_reset_timer': 0.00016309960980090727, 'sample': 2.868669882879624, 'num_episodes_lifetime': 35, 'num_module_steps_sampled_lifetime': {'servicer': 35000, 'target': 35000}, 'episode_return_mean': -1075.2092831366529, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 35000, 'target': 35000}, 'module_episode_returns_mean': {'servicer': -1070.2624053414484, 'target': -4.94687779520452}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 35000, 'weights_seq_no': 69.0, 'env_step_timer': 0.00010461781020573905, 'episode_duration_sec_mean': 0.5652996017195983, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1070.2624053414484, 'target': -4.94687779520452}, 'connector_pipeline_timer': 0.0002414227675792799, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011263520271306174, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6252734029904, 'time_between_sampling': 29.293084258489085}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 322000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1103.277683921471, 'done': False, 'training_iteration': 70, 'trial_id': 'default', 'date': '2025-04-03_21-13-32', 'timestamp': 1743729212, 'time_this_iter_s': 4.155402898788452, 'time_total_s': 229.33753395080566, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 229.33753395080566, 'iterations_since_restore': 70, 'perf': {'cpu_util_percent': 80.8, 'ram_util_percent': 52.9}}
2025-04-03 21:13:35,478 [__main__] [INFO] Iter: 71/100, Ts(iter): 0, Ts(total): 326600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.27s
2025-04-03 21:13:38,456 [__main__] [INFO] Iter: 72/100, Ts(iter): 0, Ts(total): 331200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.98s
2025-04-03 21:13:41,657 [__main__] [INFO] Iter: 73/100, Ts(iter): 0, Ts(total): 335800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.20s
2025-04-03 21:13:44,957 [__main__] [INFO] Iter: 74/100, Ts(iter): 0, Ts(total): 340400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.30s
2025-04-03 21:13:48,077 [__main__] [INFO] Iter: 75/100, Ts(iter): 0, Ts(total): 345000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.12s
2025-04-03 21:13:51,458 [__main__] [INFO] Iter: 76/100, Ts(iter): 0, Ts(total): 349600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.38s
2025-04-03 21:13:54,300 [__main__] [INFO] Iter: 77/100, Ts(iter): 0, Ts(total): 354200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.84s
2025-04-03 21:13:57,324 [__main__] [INFO] Iter: 78/100, Ts(iter): 0, Ts(total): 358800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.02s
2025-04-03 21:14:00,472 [__main__] [INFO] Iter: 79/100, Ts(iter): 0, Ts(total): 363400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.15s
2025-04-03 21:14:04,615 [__main__] [INFO] Iter: 80/100, Ts(iter): 0, Ts(total): 368000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.14s
2025-04-03 21:14:04,616 [__main__] [DEBUG] Full result dict at iter 80: {'timers': {'training_iteration': 3.188088148727751, 'restore_env_runners': 1.4376208350400656e-05, 'training_step': 3.1879392798364274, 'env_runner_sampling_timer': 0.30527763425692683, 'learner_update_timer': 2.8755276495774975, 'synch_weights': 0.005451420395856113, 'synch_env_connectors': 0.007335849984281565, 'restore_eval_env_runners': 8.193367639833272e-06, 'evaluation_iteration': 3.106501234413649, 'synch_eval_env_connectors': 0.0023401210717076326}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.209136610580345e-06, 'add_observations_from_episodes_to_batch': 1.696399577583545e-05, 'batch_individual_items': 1.8485573025488086e-05, 'add_time_dim_to_batch_and_zero_pad': 6.959041820124729e-06, 'add_states_from_episodes_to_batch': 4.093510291322357e-06, 'numpy_to_tensor': 3.064438965992059e-05}}, 'connector_pipeline_timer': 0.00011903476446739377}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.2101569117223267, 'num_module_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'num_agent_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.963893953741597e-05, 'normalize_and_clip_actions': 5.4745630323972195e-05, 'module_to_agent_unmapping': 3.922674355442333e-06, 'get_actions': 0.00013232713680519164, 'un_batch_to_individual_items': 2.133621312728727e-05, 'listify_data_for_vector_env': 1.0145835165227239e-05, 'remove_single_ts_time_rank_from_batch': 1.1710016476323036e-06}}, 'connector_pipeline_timer': 0.00031945635152689415}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 368000, 'weights_seq_no': 79.0, 'env_step_timer': 0.00014970342000394994, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.2755036197129, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.2755036197129, 'rlmodule_inference_timer': 0.00015128275326514178, 'time_between_sampling': 2.9937885395555055, 'episode_return_min': -1169.725683028316, 'num_episodes_lifetime': 368, 'episode_return_mean': -1150.9710877357306, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1130.483216516137, 'target': -20.487871219593547}, 'episode_duration_sec_mean': 0.9090970379563614, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1130.483216516137, 'target': -20.487871219593547}, 'episode_len_min': 1000, 'episode_return_max': -1133.4145084709548, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1114.246229390925}, 'learners': {'servicer': {'policy_loss': 0.06788002699613571, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.914266109466553, 'total_loss': 4.7077155113220215, 'gradients_default_optimizer_global_norm': 2.00980806350708, 'curr_kl_coeff': 3.4924597935859225e-11, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 80.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.004952956922352314, 'vf_loss_unclipped': 5140.6376953125, 'num_module_steps_trained_lifetime': 3706880, 'vf_explained_var': -0.0006470680236816406, 'entropy': 13.721541404724121}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.08013159584200981, 'agent_to_module_mapping': 0.003908274421252982, 'add_observations_from_episodes_to_batch': 0.0002481924078427059, 'general_advantage_estimation': 0.02712626856870302, 'batch_individual_items': 0.07817124042984634, 'add_time_dim_to_batch_and_zero_pad': 2.703555571791813e-05, 'add_states_from_episodes_to_batch': 7.891549370273307e-06, 'add_one_ts_to_episodes_and_truncate': 0.00604153459738381, 'numpy_to_tensor': 0.00018029702952883586}}, 'connector_pipeline_timer': 0.19609239715558022}, 'num_module_steps_trained_lifetime': 7413760, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 133216000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.20760881900787354, 'vf_loss': 0.19057874381542206, 'curr_kl_coeff': 5.8207661780829145e-12, 'gradients_default_optimizer_global_norm': 1.481393814086914, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 80.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.00436726538464427, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.19057874381542206, 'num_module_steps_trained_lifetime': 3706880, 'vf_explained_var': 0.30346566438674927, 'policy_loss': -0.14763732254505157, 'entropy': 12.527512550354004, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.691241284995345e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6572349513110975e-05, 'add_states_from_episodes_to_batch': 4.999244758000826e-06, 'numpy_to_tensor': 4.684261978170037e-05, 'agent_to_module_mapping': 5.2930154880805065e-06, 'add_observations_from_episodes_to_batch': 3.003649158757574e-05}}, 'episode_return_min': -1154.2261203802816, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.306308420349968e-07, 'tensor_to_numpy': 3.436287546146266e-05, 'normalize_and_clip_actions': 3.658707928520294e-05, 'module_to_agent_unmapping': 2.673621442113106e-06, 'get_actions': 3.695058799608978e-05, 'un_batch_to_individual_items': 1.4828834190532991e-05, 'listify_data_for_vector_env': 6.872425721657507e-06}}, 'connector_pipeline_timer': 0.00016433365163182767}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.438063000503628e-06, 'add_observations_from_episodes_to_batch': 1.1710415752491988e-05, 'batch_individual_items': 1.2349555430104462e-05, 'add_time_dim_to_batch_and_zero_pad': 4.37291172666617e-06, 'add_states_from_episodes_to_batch': 2.9661364169054518e-06, 'numpy_to_tensor': 1.969736677964729e-05}}, 'connector_pipeline_timer': 8.058096263818286e-05}, 'env_reset_timer': 0.00016311881626306725, 'sample': 2.868703609634612, 'num_episodes_lifetime': 40, 'num_module_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'episode_return_mean': -1081.787198917527, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'module_episode_returns_mean': {'servicer': -1076.309007854138, 'target': -5.478191063389181}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 40000, 'weights_seq_no': 79.0, 'env_step_timer': 0.00010458618742727137, 'episode_duration_sec_mean': 0.5658765979597229, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1076.309007854138, 'target': -5.478191063389181}, 'connector_pipeline_timer': 0.0002414100216679954, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011260194248314264, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.615897654693, 'time_between_sampling': 29.293562948853033}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 368000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1114.246229390925, 'done': False, 'training_iteration': 80, 'trial_id': 'default', 'date': '2025-04-03_21-14-04', 'timestamp': 1743729244, 'time_this_iter_s': 4.121288061141968, 'time_total_s': 261.59907388687134, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 261.59907388687134, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 79.93333333333334, 'ram_util_percent': 52.833333333333336}}
2025-04-03 21:14:04,638 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.188088148727751, 'restore_env_runners': 1.4376208350400656e-05, 'training_step': 3.1879392798364274, 'env_runner_sampling_timer': 0.30527763425692683, 'learner_update_timer': 2.8755276495774975, 'synch_weights': 0.005451420395856113, 'synch_env_connectors': 0.007335849984281565, 'restore_eval_env_runners': 8.193367639833272e-06, 'evaluation_iteration': 3.106501234413649, 'synch_eval_env_connectors': 0.0023401210717076326}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.209136610580345e-06, 'add_observations_from_episodes_to_batch': 1.696399577583545e-05, 'batch_individual_items': 1.8485573025488086e-05, 'add_time_dim_to_batch_and_zero_pad': 6.959041820124729e-06, 'add_states_from_episodes_to_batch': 4.093510291322357e-06, 'numpy_to_tensor': 3.064438965992059e-05}}, 'connector_pipeline_timer': 0.00011903476446739377}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.2101569117223267, 'num_module_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'num_agent_steps_sampled_lifetime': {'servicer': 368000, 'target': 368000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.963893953741597e-05, 'normalize_and_clip_actions': 5.4745630323972195e-05, 'module_to_agent_unmapping': 3.922674355442333e-06, 'get_actions': 0.00013232713680519164, 'un_batch_to_individual_items': 2.133621312728727e-05, 'listify_data_for_vector_env': 1.0145835165227239e-05, 'remove_single_ts_time_rank_from_batch': 1.1710016476323036e-06}}, 'connector_pipeline_timer': 0.00031945635152689415}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 368000, 'weights_seq_no': 79.0, 'env_step_timer': 0.00014970342000394994, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.2755036197129, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.2755036197129, 'rlmodule_inference_timer': 0.00015128275326514178, 'time_between_sampling': 2.9937885395555055, 'episode_return_min': -1169.725683028316, 'num_episodes_lifetime': 368, 'episode_return_mean': -1150.9710877357306, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1130.483216516137, 'target': -20.487871219593547}, 'episode_duration_sec_mean': 0.9090970379563614, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1130.483216516137, 'target': -20.487871219593547}, 'episode_len_min': 1000, 'episode_return_max': -1133.4145084709548, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1114.246229390925}, 'learners': {'servicer': {'policy_loss': 0.06788002699613571, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.914266109466553, 'total_loss': 4.7077155113220215, 'gradients_default_optimizer_global_norm': 2.00980806350708, 'curr_kl_coeff': 3.4924597935859225e-11, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 80.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.004952956922352314, 'vf_loss_unclipped': 5140.6376953125, 'num_module_steps_trained_lifetime': 3706880, 'vf_explained_var': -0.0006470680236816406, 'entropy': 13.721541404724121}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.08013159584200981, 'agent_to_module_mapping': 0.003908274421252982, 'add_observations_from_episodes_to_batch': 0.0002481924078427059, 'general_advantage_estimation': 0.02712626856870302, 'batch_individual_items': 0.07817124042984634, 'add_time_dim_to_batch_and_zero_pad': 2.703555571791813e-05, 'add_states_from_episodes_to_batch': 7.891549370273307e-06, 'add_one_ts_to_episodes_and_truncate': 0.00604153459738381, 'numpy_to_tensor': 0.00018029702952883586}}, 'connector_pipeline_timer': 0.19609239715558022}, 'num_module_steps_trained_lifetime': 7413760, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 133216000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.20760881900787354, 'vf_loss': 0.19057874381542206, 'curr_kl_coeff': 5.8207661780829145e-12, 'gradients_default_optimizer_global_norm': 1.481393814086914, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 80.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.00436726538464427, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.19057874381542206, 'num_module_steps_trained_lifetime': 3706880, 'vf_explained_var': 0.30346566438674927, 'policy_loss': -0.14763732254505157, 'entropy': 12.527512550354004, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.691241284995345e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6572349513110975e-05, 'add_states_from_episodes_to_batch': 4.999244758000826e-06, 'numpy_to_tensor': 4.684261978170037e-05, 'agent_to_module_mapping': 5.2930154880805065e-06, 'add_observations_from_episodes_to_batch': 3.003649158757574e-05}}, 'episode_return_min': -1154.2261203802816, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.306308420349968e-07, 'tensor_to_numpy': 3.436287546146266e-05, 'normalize_and_clip_actions': 3.658707928520294e-05, 'module_to_agent_unmapping': 2.673621442113106e-06, 'get_actions': 3.695058799608978e-05, 'un_batch_to_individual_items': 1.4828834190532991e-05, 'listify_data_for_vector_env': 6.872425721657507e-06}}, 'connector_pipeline_timer': 0.00016433365163182767}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.438063000503628e-06, 'add_observations_from_episodes_to_batch': 1.1710415752491988e-05, 'batch_individual_items': 1.2349555430104462e-05, 'add_time_dim_to_batch_and_zero_pad': 4.37291172666617e-06, 'add_states_from_episodes_to_batch': 2.9661364169054518e-06, 'numpy_to_tensor': 1.969736677964729e-05}}, 'connector_pipeline_timer': 8.058096263818286e-05}, 'env_reset_timer': 0.00016311881626306725, 'sample': 2.868703609634612, 'num_episodes_lifetime': 40, 'num_module_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'episode_return_mean': -1081.787198917527, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 40000, 'target': 40000}, 'module_episode_returns_mean': {'servicer': -1076.309007854138, 'target': -5.478191063389181}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 40000, 'weights_seq_no': 79.0, 'env_step_timer': 0.00010458618742727137, 'episode_duration_sec_mean': 0.5658765979597229, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1076.309007854138, 'target': -5.478191063389181}, 'connector_pipeline_timer': 0.0002414100216679954, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011260194248314264, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.615897654693, 'time_between_sampling': 29.293562948853033}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 368000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1114.246229390925, 'done': False, 'training_iteration': 80, 'trial_id': 'default', 'date': '2025-04-03_21-14-04', 'timestamp': 1743729244, 'time_this_iter_s': 4.121288061141968, 'time_total_s': 261.59907388687134, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 261.59907388687134, 'iterations_since_restore': 80, 'perf': {'cpu_util_percent': 79.93333333333334, 'ram_util_percent': 52.833333333333336}})
2025-04-03 21:14:08,033 [__main__] [INFO] Iter: 81/100, Ts(iter): 0, Ts(total): 372600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.39s
2025-04-03 21:14:11,292 [__main__] [INFO] Iter: 82/100, Ts(iter): 0, Ts(total): 377200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.26s
2025-04-03 21:14:14,264 [__main__] [INFO] Iter: 83/100, Ts(iter): 0, Ts(total): 381800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 2.97s
2025-04-03 21:14:17,370 [__main__] [INFO] Iter: 84/100, Ts(iter): 0, Ts(total): 386400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:14:20,416 [__main__] [INFO] Iter: 85/100, Ts(iter): 0, Ts(total): 391000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.05s
2025-04-03 21:14:23,531 [__main__] [INFO] Iter: 86/100, Ts(iter): 0, Ts(total): 395600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.11s
2025-04-03 21:14:26,949 [__main__] [INFO] Iter: 87/100, Ts(iter): 0, Ts(total): 400200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.42s
2025-04-03 21:14:30,324 [__main__] [INFO] Iter: 88/100, Ts(iter): 0, Ts(total): 404800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.37s
2025-04-03 21:14:33,781 [__main__] [INFO] Iter: 89/100, Ts(iter): 0, Ts(total): 409400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.46s
2025-04-03 21:14:37,875 [__main__] [INFO] Iter: 90/100, Ts(iter): 0, Ts(total): 414000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.09s
2025-04-03 21:14:37,875 [__main__] [DEBUG] Full result dict at iter 90: {'timers': {'training_iteration': 3.199013956917879, 'restore_env_runners': 1.405598287808515e-05, 'training_step': 3.1988639228957503, 'env_runner_sampling_timer': 0.30064114258352065, 'learner_update_timer': 2.8911233442762234, 'synch_weights': 0.005390097948085956, 'synch_env_connectors': 0.007382710052194618, 'restore_eval_env_runners': 8.150183967458253e-06, 'evaluation_iteration': 3.1064839333195065, 'synch_eval_env_connectors': 0.0023381873608911657}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.5053872053086446e-06, 'add_observations_from_episodes_to_batch': 1.6975609426040624e-05, 'batch_individual_items': 1.884389558873949e-05, 'add_time_dim_to_batch_and_zero_pad': 7.171924302698388e-06, 'add_states_from_episodes_to_batch': 4.1363018853607755e-06, 'numpy_to_tensor': 3.221420374068299e-05}}, 'connector_pipeline_timer': 0.00012184070689362392}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.20853101563277296, 'num_module_steps_sampled_lifetime': {'servicer': 414000, 'target': 414000}, 'num_agent_steps_sampled_lifetime': {'servicer': 414000, 'target': 414000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 5.08967128243133e-05, 'normalize_and_clip_actions': 5.6365012534317104e-05, 'module_to_agent_unmapping': 3.988069503138005e-06, 'get_actions': 0.00013865211615693516, 'un_batch_to_individual_items': 2.228600376873699e-05, 'listify_data_for_vector_env': 1.0176724877531037e-05, 'remove_single_ts_time_rank_from_batch': 1.3128881738572646e-06}}, 'connector_pipeline_timer': 0.0003305521064999324}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 414000, 'weights_seq_no': 89.0, 'env_step_timer': 0.0001543638662323201, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27550380754067, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27550380754067, 'rlmodule_inference_timer': 0.00015616708177126649, 'time_between_sampling': 3.0022545845142843, 'episode_return_min': -1155.4719587365853, 'num_episodes_lifetime': 414, 'episode_return_mean': -1133.0608496866241, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1112.2291857329624, 'target': -20.831663953661916}, 'episode_duration_sec_mean': 0.929855817003282, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1112.2291857329624, 'target': -20.831663953661916}, 'episode_len_min': 1000, 'episode_return_max': -1119.3059317357665, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1123.7238022648826}, 'learners': {'servicer': {'policy_loss': 0.010352487675845623, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.9818902015686035, 'total_loss': 4.7782697677612305, 'gradients_default_optimizer_global_norm': 4.677923202514648, 'curr_kl_coeff': 8.731149483964806e-12, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 90.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.009005624800920486, 'vf_loss_unclipped': 4495.3310546875, 'num_module_steps_trained_lifetime': 4170240, 'vf_explained_var': -0.0005035400390625, 'entropy': 10.698657989501953}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.0802229458944447, 'agent_to_module_mapping': 0.003922747930786594, 'add_observations_from_episodes_to_batch': 0.00024816609349009866, 'general_advantage_estimation': 0.026580992428704885, 'batch_individual_items': 0.0791819439436327, 'add_time_dim_to_batch_and_zero_pad': 2.6540313193208852e-05, 'add_states_from_episodes_to_batch': 7.73449602564021e-06, 'add_one_ts_to_episodes_and_truncate': 0.006021978116577241, 'numpy_to_tensor': 0.00017873088426687152}}, 'connector_pipeline_timer': 0.1966364876222674}, 'num_module_steps_trained_lifetime': 8340480, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 149868000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.08604642748832703, 'vf_loss': 0.1120690107345581, 'curr_kl_coeff': 9.094947153254554e-14, 'gradients_default_optimizer_global_norm': 1.9642621278762817, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 90.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.006300031673163176, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.1120690107345581, 'num_module_steps_trained_lifetime': 4170240, 'vf_explained_var': 0.5943987369537354, 'policy_loss': 0.06024831533432007, 'entropy': 12.918188095092773, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.6917208256066102e-05, 'add_time_dim_to_batch_and_zero_pad': 1.657382061936412e-05, 'add_states_from_episodes_to_batch': 5.000318595034474e-06, 'numpy_to_tensor': 4.685343695523941e-05, 'agent_to_module_mapping': 5.294757487833142e-06, 'add_observations_from_episodes_to_batch': 3.00390514013604e-05}}, 'episode_return_min': -1154.2261203802816, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.301456917100991e-07, 'tensor_to_numpy': 3.43594896483898e-05, 'normalize_and_clip_actions': 3.6566470580281375e-05, 'module_to_agent_unmapping': 2.672000968771622e-06, 'get_actions': 3.692815586118278e-05, 'un_batch_to_individual_items': 1.4827485277327483e-05, 'listify_data_for_vector_env': 6.871546809280399e-06}}, 'connector_pipeline_timer': 0.0001642744091247627}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.4333908305453207e-06, 'add_observations_from_episodes_to_batch': 1.1702573029194806e-05, 'batch_individual_items': 1.2341132259629975e-05, 'add_time_dim_to_batch_and_zero_pad': 4.370182329302597e-06, 'add_states_from_episodes_to_batch': 2.9656691953144678e-06, 'numpy_to_tensor': 1.9689728308061504e-05}}, 'connector_pipeline_timer': 8.05485913997926e-05}, 'env_reset_timer': 0.00016314545363534946, 'sample': 2.868738318745313, 'num_episodes_lifetime': 45, 'num_module_steps_sampled_lifetime': {'servicer': 45000, 'target': 45000}, 'episode_return_mean': -1091.4147050822367, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 45000, 'target': 45000}, 'module_episode_returns_mean': {'servicer': -1085.429952605038, 'target': -5.984752477198838}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 45000, 'weights_seq_no': 89.0, 'env_step_timer': 0.00010454779606388528, 'episode_duration_sec_mean': 0.5657582104399625, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1085.429952605038, 'target': -5.984752477198838}, 'connector_pipeline_timer': 0.00024140245089828574, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011253102276864348, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.6050163642137, 'time_between_sampling': 29.29414195540885}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 414000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1123.7238022648826, 'done': False, 'training_iteration': 90, 'trial_id': 'default', 'date': '2025-04-03_21-14-37', 'timestamp': 1743729277, 'time_this_iter_s': 4.079099178314209, 'time_total_s': 294.6850035190582, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 294.6850035190582, 'iterations_since_restore': 90, 'perf': {'cpu_util_percent': 88.44999999999999, 'ram_util_percent': 53.300000000000004}}
2025-04-03 21:14:41,198 [__main__] [INFO] Iter: 91/100, Ts(iter): 0, Ts(total): 418600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.32s
2025-04-03 21:14:44,389 [__main__] [INFO] Iter: 92/100, Ts(iter): 0, Ts(total): 423200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.19s
2025-04-03 21:14:49,591 [__main__] [INFO] Iter: 93/100, Ts(iter): 0, Ts(total): 427800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 5.20s
2025-04-03 21:14:52,828 [__main__] [INFO] Iter: 94/100, Ts(iter): 0, Ts(total): 432400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.24s
2025-04-03 21:14:58,138 [__main__] [INFO] Iter: 95/100, Ts(iter): 0, Ts(total): 437000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 5.31s
2025-04-03 21:15:02,472 [__main__] [INFO] Iter: 96/100, Ts(iter): 0, Ts(total): 441600, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.33s
2025-04-03 21:15:06,140 [__main__] [INFO] Iter: 97/100, Ts(iter): 0, Ts(total): 446200, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.67s
2025-04-03 21:15:09,710 [__main__] [INFO] Iter: 98/100, Ts(iter): 0, Ts(total): 450800, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.57s
2025-04-03 21:15:12,974 [__main__] [INFO] Iter: 99/100, Ts(iter): 0, Ts(total): 455400, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 3.26s
2025-04-03 21:15:17,451 [__main__] [INFO] Iter: 100/100, Ts(iter): 0, Ts(total): 460000, Reward (Eval/Sample): nan, Loss(serv): nan, Loss(targ): nan, Time: 4.48s
2025-04-03 21:15:17,452 [__main__] [DEBUG] Full result dict at iter 100: {'timers': {'training_iteration': 3.2691990297304994, 'restore_env_runners': 1.3607040299432952e-05, 'training_step': 3.2690501165093555, 'env_runner_sampling_timer': 0.29477324680274497, 'learner_update_timer': 2.9671825470481106, 'synch_weights': 0.005378086914608102, 'synch_env_connectors': 0.007357268410546342, 'restore_eval_env_runners': 8.120352049742489e-06, 'evaluation_iteration': 3.1058711698162735, 'synch_eval_env_connectors': 0.0023291267371919533}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.1756147791613935e-06, 'add_observations_from_episodes_to_batch': 1.6418317428750224e-05, 'batch_individual_items': 1.7887543044247333e-05, 'add_time_dim_to_batch_and_zero_pad': 6.7412173983863315e-06, 'add_states_from_episodes_to_batch': 4.111720561593728e-06, 'numpy_to_tensor': 3.106455784088114e-05}}, 'connector_pipeline_timer': 0.0001168819621894189}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.20680508353944332, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.9013097438175096e-05, 'normalize_and_clip_actions': 5.289789450506878e-05, 'module_to_agent_unmapping': 3.832626298601379e-06, 'get_actions': 0.00012922227890025707, 'un_batch_to_individual_items': 2.1021666599089374e-05, 'listify_data_for_vector_env': 9.712846459511463e-06, 'remove_single_ts_time_rank_from_batch': 1.2900418597243684e-06}}, 'connector_pipeline_timer': 0.00031176717828032834}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 460000, 'weights_seq_no': 99.0, 'env_step_timer': 0.00014675818635572892, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27550382615527, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27550382615527, 'rlmodule_inference_timer': 0.0001494846505676662, 'time_between_sampling': 3.0549748996017914, 'episode_return_min': -1147.0772676145502, 'num_episodes_lifetime': 460, 'episode_return_mean': -1134.9738465661956, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1113.7756231775086, 'target': -21.198223388687428}, 'episode_duration_sec_mean': 0.8782768277837338, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1113.7756231775086, 'target': -21.198223388687428}, 'episode_len_min': 1000, 'episode_return_max': -1121.660445022005, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1026.9392584385243}, 'learners': {'servicer': {'policy_loss': 0.03071274608373642, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.949444770812988, 'total_loss': 4.728753566741943, 'gradients_default_optimizer_global_norm': 2.452972412109375, 'curr_kl_coeff': 1.0913936854956008e-12, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 100.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.011769662611186504, 'vf_loss_unclipped': 4711.322265625, 'num_module_steps_trained_lifetime': 4633600, 'vf_explained_var': -0.0002186298370361328, 'entropy': 12.570230484008789}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.0803054661543558, 'agent_to_module_mapping': 0.003937603447704336, 'add_observations_from_episodes_to_batch': 0.000248000157080595, 'general_advantage_estimation': 0.026023871329215152, 'batch_individual_items': 0.08017102252322919, 'add_time_dim_to_batch_and_zero_pad': 2.6042736216617874e-05, 'add_states_from_episodes_to_batch': 7.581040728900952e-06, 'add_one_ts_to_episodes_and_truncate': 0.006000561948868704, 'numpy_to_tensor': 0.00017715893963667878}}, 'connector_pipeline_timer': 0.19713662975284105}, 'num_module_steps_trained_lifetime': 9267200, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 166520000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.12048656493425369, 'vf_loss': 0.13297685980796814, 'curr_kl_coeff': 7.10542746348012e-16, 'gradients_default_optimizer_global_norm': 0.9515795707702637, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 100.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.006549862213432789, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.13297685980796814, 'num_module_steps_trained_lifetime': 4633600, 'vf_explained_var': 0.47876644134521484, 'policy_loss': 0.017830852419137955, 'entropy': 13.564713478088379, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.692128731288174e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6574609268562164e-05, 'add_states_from_episodes_to_batch': 5.001221030606338e-06, 'numpy_to_tensor': 4.686352852310579e-05, 'agent_to_module_mapping': 5.296356146684957e-06, 'add_observations_from_episodes_to_batch': 3.0040777169507826e-05}}, 'episode_return_min': -1154.2261203802816, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.298097508616164e-07, 'tensor_to_numpy': 3.434964649096243e-05, 'normalize_and_clip_actions': 3.6548197859388314e-05, 'module_to_agent_unmapping': 2.6705036519505267e-06, 'get_actions': 3.6917358518009685e-05, 'un_batch_to_individual_items': 1.4823871030434054e-05, 'listify_data_for_vector_env': 6.870115675168978e-06}}, 'connector_pipeline_timer': 0.00016421967464681658}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.430101659943702e-06, 'add_observations_from_episodes_to_batch': 1.1698420237646163e-05, 'batch_individual_items': 1.2337207468576507e-05, 'add_time_dim_to_batch_and_zero_pad': 4.368024133684823e-06, 'add_states_from_episodes_to_batch': 2.9651376417389675e-06, 'numpy_to_tensor': 1.9681926611644714e-05}}, 'connector_pipeline_timer': 8.05200756474339e-05}, 'env_reset_timer': 0.00016316655887884236, 'sample': 2.8687702398003356, 'num_episodes_lifetime': 50, 'num_module_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'episode_return_mean': -1098.8613984093452, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'module_episode_returns_mean': {'servicer': -1092.9567625022316, 'target': -5.904635907113552}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 50000, 'weights_seq_no': 99.0, 'env_step_timer': 0.00010452010856001011, 'episode_duration_sec_mean': 0.5644118800005526, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1092.9567625022316, 'target': -5.904635907113552}, 'connector_pipeline_timer': 0.00024138469474179245, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011249136723106232, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.594333526863, 'time_between_sampling': 29.295408693717867}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1026.9392584385243, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_21-15-17', 'timestamp': 1743729317, 'time_this_iter_s': 4.46389102935791, 'time_total_s': 334.11483502388, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 334.11483502388, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 87.93333333333332, 'ram_util_percent': 54.199999999999996}}
2025-04-03 21:15:17,476 [__main__] [INFO] Checkpoint saved in directory TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.2691990297304994, 'restore_env_runners': 1.3607040299432952e-05, 'training_step': 3.2690501165093555, 'env_runner_sampling_timer': 0.29477324680274497, 'learner_update_timer': 2.9671825470481106, 'synch_weights': 0.005378086914608102, 'synch_env_connectors': 0.007357268410546342, 'restore_eval_env_runners': 8.120352049742489e-06, 'evaluation_iteration': 3.1058711698162735, 'synch_eval_env_connectors': 0.0023291267371919533}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.1756147791613935e-06, 'add_observations_from_episodes_to_batch': 1.6418317428750224e-05, 'batch_individual_items': 1.7887543044247333e-05, 'add_time_dim_to_batch_and_zero_pad': 6.7412173983863315e-06, 'add_states_from_episodes_to_batch': 4.111720561593728e-06, 'numpy_to_tensor': 3.106455784088114e-05}}, 'connector_pipeline_timer': 0.0001168819621894189}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.20680508353944332, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.9013097438175096e-05, 'normalize_and_clip_actions': 5.289789450506878e-05, 'module_to_agent_unmapping': 3.832626298601379e-06, 'get_actions': 0.00012922227890025707, 'un_batch_to_individual_items': 2.1021666599089374e-05, 'listify_data_for_vector_env': 9.712846459511463e-06, 'remove_single_ts_time_rank_from_batch': 1.2900418597243684e-06}}, 'connector_pipeline_timer': 0.00031176717828032834}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 460000, 'weights_seq_no': 99.0, 'env_step_timer': 0.00014675818635572892, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27550382615527, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27550382615527, 'rlmodule_inference_timer': 0.0001494846505676662, 'time_between_sampling': 3.0549748996017914, 'episode_return_min': -1147.0772676145502, 'num_episodes_lifetime': 460, 'episode_return_mean': -1134.9738465661956, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1113.7756231775086, 'target': -21.198223388687428}, 'episode_duration_sec_mean': 0.8782768277837338, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1113.7756231775086, 'target': -21.198223388687428}, 'episode_len_min': 1000, 'episode_return_max': -1121.660445022005, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1026.9392584385243}, 'learners': {'servicer': {'policy_loss': 0.03071274608373642, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.949444770812988, 'total_loss': 4.728753566741943, 'gradients_default_optimizer_global_norm': 2.452972412109375, 'curr_kl_coeff': 1.0913936854956008e-12, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 100.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.011769662611186504, 'vf_loss_unclipped': 4711.322265625, 'num_module_steps_trained_lifetime': 4633600, 'vf_explained_var': -0.0002186298370361328, 'entropy': 12.570230484008789}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.0803054661543558, 'agent_to_module_mapping': 0.003937603447704336, 'add_observations_from_episodes_to_batch': 0.000248000157080595, 'general_advantage_estimation': 0.026023871329215152, 'batch_individual_items': 0.08017102252322919, 'add_time_dim_to_batch_and_zero_pad': 2.6042736216617874e-05, 'add_states_from_episodes_to_batch': 7.581040728900952e-06, 'add_one_ts_to_episodes_and_truncate': 0.006000561948868704, 'numpy_to_tensor': 0.00017715893963667878}}, 'connector_pipeline_timer': 0.19713662975284105}, 'num_module_steps_trained_lifetime': 9267200, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 166520000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.12048656493425369, 'vf_loss': 0.13297685980796814, 'curr_kl_coeff': 7.10542746348012e-16, 'gradients_default_optimizer_global_norm': 0.9515795707702637, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 100.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.006549862213432789, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.13297685980796814, 'num_module_steps_trained_lifetime': 4633600, 'vf_explained_var': 0.47876644134521484, 'policy_loss': 0.017830852419137955, 'entropy': 13.564713478088379, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.692128731288174e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6574609268562164e-05, 'add_states_from_episodes_to_batch': 5.001221030606338e-06, 'numpy_to_tensor': 4.686352852310579e-05, 'agent_to_module_mapping': 5.296356146684957e-06, 'add_observations_from_episodes_to_batch': 3.0040777169507826e-05}}, 'episode_return_min': -1154.2261203802816, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.298097508616164e-07, 'tensor_to_numpy': 3.434964649096243e-05, 'normalize_and_clip_actions': 3.6548197859388314e-05, 'module_to_agent_unmapping': 2.6705036519505267e-06, 'get_actions': 3.6917358518009685e-05, 'un_batch_to_individual_items': 1.4823871030434054e-05, 'listify_data_for_vector_env': 6.870115675168978e-06}}, 'connector_pipeline_timer': 0.00016421967464681658}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.430101659943702e-06, 'add_observations_from_episodes_to_batch': 1.1698420237646163e-05, 'batch_individual_items': 1.2337207468576507e-05, 'add_time_dim_to_batch_and_zero_pad': 4.368024133684823e-06, 'add_states_from_episodes_to_batch': 2.9651376417389675e-06, 'numpy_to_tensor': 1.9681926611644714e-05}}, 'connector_pipeline_timer': 8.05200756474339e-05}, 'env_reset_timer': 0.00016316655887884236, 'sample': 2.8687702398003356, 'num_episodes_lifetime': 50, 'num_module_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'episode_return_mean': -1098.8613984093452, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'module_episode_returns_mean': {'servicer': -1092.9567625022316, 'target': -5.904635907113552}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 50000, 'weights_seq_no': 99.0, 'env_step_timer': 0.00010452010856001011, 'episode_duration_sec_mean': 0.5644118800005526, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1092.9567625022316, 'target': -5.904635907113552}, 'connector_pipeline_timer': 0.00024138469474179245, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011249136723106232, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.594333526863, 'time_between_sampling': 29.295408693717867}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1026.9392584385243, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_21-15-17', 'timestamp': 1743729317, 'time_this_iter_s': 4.46389102935791, 'time_total_s': 334.11483502388, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 334.11483502388, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 87.93333333333332, 'ram_util_percent': 54.199999999999996}})
2025-04-03 21:15:17,477 [__main__] [INFO] 
--- Training Finished ---
2025-04-03 21:15:17,477 [__main__] [INFO] Total Training Time: 335.67 seconds
2025-04-03 21:15:17,477 [__main__] [INFO] Using last checkpoint: TrainingResult(checkpoint=Checkpoint(filesystem=local, path=/Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results), metrics={'timers': {'training_iteration': 3.2691990297304994, 'restore_env_runners': 1.3607040299432952e-05, 'training_step': 3.2690501165093555, 'env_runner_sampling_timer': 0.29477324680274497, 'learner_update_timer': 2.9671825470481106, 'synch_weights': 0.005378086914608102, 'synch_env_connectors': 0.007357268410546342, 'restore_eval_env_runners': 8.120352049742489e-06, 'evaluation_iteration': 3.1058711698162735, 'synch_eval_env_connectors': 0.0023291267371919533}, 'env_runners': {'timers': {'connectors': {'batch_individual_items': 3.9694000683400944e-05, 'add_time_dim_to_batch_and_zero_pad': 2.4302695553911768e-05, 'add_states_from_episodes_to_batch': 9.700955200494956e-06, 'numpy_to_tensor': 6.676087049645898e-05, 'agent_to_module_mapping': 8.26265212431874e-06, 'add_observations_from_episodes_to_batch': 4.7994651654532746e-05}}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 4.1756147791613935e-06, 'add_observations_from_episodes_to_batch': 1.6418317428750224e-05, 'batch_individual_items': 1.7887543044247333e-05, 'add_time_dim_to_batch_and_zero_pad': 6.7412173983863315e-06, 'add_states_from_episodes_to_batch': 4.111720561593728e-06, 'numpy_to_tensor': 3.106455784088114e-05}}, 'connector_pipeline_timer': 0.0001168819621894189}, 'env_reset_timer': 0.00023121565312106648, 'sample': 0.20680508353944332, 'num_module_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'num_agent_steps_sampled_lifetime': {'servicer': 460000, 'target': 460000}, 'module_to_env_connector': {'timers': {'connectors': {'tensor_to_numpy': 4.9013097438175096e-05, 'normalize_and_clip_actions': 5.289789450506878e-05, 'module_to_agent_unmapping': 3.832626298601379e-06, 'get_actions': 0.00012922227890025707, 'un_batch_to_individual_items': 2.1021666599089374e-05, 'listify_data_for_vector_env': 9.712846459511463e-06, 'remove_single_ts_time_rank_from_batch': 1.2900418597243684e-06}}, 'connector_pipeline_timer': 0.00031176717828032834}, 'num_agent_steps_sampled': {'servicer': 4600, 'target': 4600}, 'num_env_steps_sampled_lifetime': 460000, 'weights_seq_no': 99.0, 'env_step_timer': 0.00014675818635572892, 'num_env_steps_sampled': 4600, 'env_to_module_sum_episodes_length_out': 131.27550382615527, 'connector_pipeline_timer': 0.00037708882439841073, 'num_module_steps_sampled': {'servicer': 4600, 'target': 4600}, 'env_to_module_sum_episodes_length_in': 131.27550382615527, 'rlmodule_inference_timer': 0.0001494846505676662, 'time_between_sampling': 3.0549748996017914, 'episode_return_min': -1147.0772676145502, 'num_episodes_lifetime': 460, 'episode_return_mean': -1134.9738465661956, 'num_episodes': 23, 'module_episode_returns_mean': {'servicer': -1113.7756231775086, 'target': -21.198223388687428}, 'episode_duration_sec_mean': 0.8782768277837338, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1113.7756231775086, 'target': -21.198223388687428}, 'episode_len_min': 1000, 'episode_return_max': -1121.660445022005, 'episode_len_mean': 1000.0, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_lifetime_throughput': 1026.9392584385243}, 'learners': {'servicer': {'policy_loss': 0.03071274608373642, 'diff_num_grad_updates_vs_sampler_policy': 1.0, 'vf_loss': 4.949444770812988, 'total_loss': 4.728753566741943, 'gradients_default_optimizer_global_norm': 2.452972412109375, 'curr_kl_coeff': 1.0913936854956008e-12, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 100.0, 'num_module_steps_trained': 46336, 'module_train_batch_size_mean': 128.0, 'num_trainable_parameters': 142093.0, 'default_optimizer_learning_rate': 5e-05, 'mean_kl_loss': 0.011769662611186504, 'vf_loss_unclipped': 4711.322265625, 'num_module_steps_trained_lifetime': 4633600, 'vf_explained_var': -0.0002186298370361328, 'entropy': 12.570230484008789}, '__all_modules__': {'num_non_trainable_parameters': 0.0, 'learner_connector': {'timers': {'connectors': {'add_columns_from_episodes_to_train_batch': 0.0803054661543558, 'agent_to_module_mapping': 0.003937603447704336, 'add_observations_from_episodes_to_batch': 0.000248000157080595, 'general_advantage_estimation': 0.026023871329215152, 'batch_individual_items': 0.08017102252322919, 'add_time_dim_to_batch_and_zero_pad': 2.6042736216617874e-05, 'add_states_from_episodes_to_batch': 7.581040728900952e-06, 'add_one_ts_to_episodes_and_truncate': 0.006000561948868704, 'numpy_to_tensor': 0.00017715893963667878}}, 'connector_pipeline_timer': 0.19713662975284105}, 'num_module_steps_trained_lifetime': 9267200, 'learner_connector_sum_episodes_length_out': 4600.0, 'num_env_steps_trained': 1665200, 'num_env_steps_trained_lifetime': 166520000, 'num_module_steps_trained': 92672, 'num_trainable_parameters': 284186.0, 'learner_connector_sum_episodes_length_in': 4600.0, 'num_env_steps_trained_lifetime_throughput': 0.0}, 'target': {'total_loss': -0.12048656493425369, 'vf_loss': 0.13297685980796814, 'curr_kl_coeff': 7.10542746348012e-16, 'gradients_default_optimizer_global_norm': 0.9515795707702637, 'curr_entropy_coeff': 0.02, 'weights_seq_no': 100.0, 'module_train_batch_size_mean': 128.0, 'default_optimizer_learning_rate': 5e-05, 'num_module_steps_trained': 46336, 'mean_kl_loss': 0.006549862213432789, 'num_trainable_parameters': 142093.0, 'vf_loss_unclipped': 0.13297685980796814, 'num_module_steps_trained_lifetime': 4633600, 'vf_explained_var': 0.47876644134521484, 'policy_loss': 0.017830852419137955, 'entropy': 13.564713478088379, 'diff_num_grad_updates_vs_sampler_policy': 1.0}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'timers': {'connectors': {'batch_individual_items': 2.692128731288174e-05, 'add_time_dim_to_batch_and_zero_pad': 1.6574609268562164e-05, 'add_states_from_episodes_to_batch': 5.001221030606338e-06, 'numpy_to_tensor': 4.686352852310579e-05, 'agent_to_module_mapping': 5.296356146684957e-06, 'add_observations_from_episodes_to_batch': 3.0040777169507826e-05}}, 'episode_return_min': -1154.2261203802816, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 8.298097508616164e-07, 'tensor_to_numpy': 3.434964649096243e-05, 'normalize_and_clip_actions': 3.6548197859388314e-05, 'module_to_agent_unmapping': 2.6705036519505267e-06, 'get_actions': 3.6917358518009685e-05, 'un_batch_to_individual_items': 1.4823871030434054e-05, 'listify_data_for_vector_env': 6.870115675168978e-06}}, 'connector_pipeline_timer': 0.00016421967464681658}, 'env_to_module_connector': {'timers': {'connectors': {'agent_to_module_mapping': 3.430101659943702e-06, 'add_observations_from_episodes_to_batch': 1.1698420237646163e-05, 'batch_individual_items': 1.2337207468576507e-05, 'add_time_dim_to_batch_and_zero_pad': 4.368024133684823e-06, 'add_states_from_episodes_to_batch': 2.9651376417389675e-06, 'numpy_to_tensor': 1.9681926611644714e-05}}, 'connector_pipeline_timer': 8.05200756474339e-05}, 'env_reset_timer': 0.00016316655887884236, 'sample': 2.8687702398003356, 'num_episodes_lifetime': 50, 'num_module_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'episode_return_mean': -1098.8613984093452, 'num_episodes': 5, 'num_agent_steps_sampled_lifetime': {'servicer': 50000, 'target': 50000}, 'module_episode_returns_mean': {'servicer': -1092.9567625022316, 'target': -5.904635907113552}, 'num_agent_steps_sampled': {'servicer': 5000, 'target': 5000}, 'num_env_steps_sampled_lifetime': 50000, 'weights_seq_no': 99.0, 'env_step_timer': 0.00010452010856001011, 'episode_duration_sec_mean': 0.5644118800005526, 'num_env_steps_sampled': 5000, 'env_to_module_sum_episodes_length_out': 901.0423566894266, 'episode_len_max': 1000, 'agent_episode_returns_mean': {'servicer': -1092.9567625022316, 'target': -5.904635907113552}, 'connector_pipeline_timer': 0.00024138469474179245, 'episode_len_min': 1000, 'episode_return_max': -1055.3110205578794, 'episode_len_mean': 1000.0, 'num_module_steps_sampled': {'servicer': 5000, 'target': 5000}, 'env_to_module_sum_episodes_length_in': 901.0423566894266, 'rlmodule_inference_timer': 0.00011249136723106232, 'agent_steps': {'servicer': 1000.0, 'target': 1000.0}, 'num_env_steps_sampled_per_second': 1610.594333526863, 'time_between_sampling': 29.295408693717867}, 'num_healthy_workers': 1, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 460000, 'fault_tolerance': {'num_healthy_workers': 23, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'num_env_steps_sampled_lifetime_throughput': 1026.9392584385243, 'done': False, 'training_iteration': 100, 'trial_id': 'default', 'date': '2025-04-03_21-15-17', 'timestamp': 1743729317, 'time_this_iter_s': 4.46389102935791, 'time_total_s': 334.11483502388, 'pid': 78826, 'hostname': 'Nathans-Mac-Studio.local', 'node_ip': '127.0.0.1', 'config': {'exploration_config': {}, 'extra_python_environs_for_driver': {}, 'extra_python_environs_for_worker': {}, 'placement_strategy': 'PACK', 'num_gpus': 0, '_fake_gpus': False, 'num_cpus_for_main_process': 1, 'eager_tracing': True, 'eager_max_retraces': 20, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'torch_compile_learner': False, 'torch_compile_learner_what_to_compile': <TorchCompileWhatToCompile.FORWARD_TRAIN: 'forward_train'>, 'torch_compile_learner_dynamo_backend': 'aot_eager', 'torch_compile_learner_dynamo_mode': None, 'torch_compile_worker': False, 'torch_compile_worker_dynamo_backend': 'aot_eager', 'torch_compile_worker_dynamo_mode': None, 'torch_ddp_kwargs': {}, 'torch_skip_nan_gradients': False, 'env': 'satellite_marl', 'env_config': {}, 'observation_space': None, 'action_space': None, 'clip_rewards': None, 'normalize_actions': True, 'clip_actions': False, '_is_atari': None, 'disable_env_checking': False, 'render_env': False, 'action_mask_key': 'action_mask', 'env_runner_cls': None, 'num_env_runners': 23, 'num_envs_per_env_runner': 1, 'gym_env_vectorize_mode': 'SYNC', 'num_cpus_per_env_runner': 1, 'num_gpus_per_env_runner': 0, 'custom_resources_per_env_runner': {}, 'validate_env_runners_after_construction': True, 'episodes_to_numpy': True, 'max_requests_in_flight_per_env_runner': 1, 'sample_timeout_s': 60.0, '_env_to_module_connector': None, 'add_default_connectors_to_env_to_module_pipeline': True, '_module_to_env_connector': None, 'add_default_connectors_to_module_to_env_pipeline': True, 'episode_lookback_horizon': 1, 'rollout_fragment_length': 'auto', 'batch_mode': 'truncate_episodes', 'compress_observations': False, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'enable_tf1_exec_eagerly': False, 'sample_collector': <class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>, 'preprocessor_pref': 'deepmind', 'observation_filter': 'MeanStdFilter', 'update_worker_filter_stats': True, 'use_worker_filter_stats': True, 'sampler_perf_stats_ema_coef': None, 'num_learners': 0, 'num_gpus_per_learner': 0, 'num_cpus_per_learner': 'auto', 'num_aggregator_actors_per_learner': 0, 'max_requests_in_flight_per_aggregator_actor': 3, 'local_gpu_idx': 0, 'max_requests_in_flight_per_learner': 3, 'gamma': 0.99, 'lr': 5e-05, 'grad_clip': 0.5, 'grad_clip_by': 'global_norm', '_train_batch_size_per_learner': None, 'train_batch_size': 4600, 'num_epochs': 10, 'minibatch_size': 128, 'shuffle_batch_per_epoch': True, 'model': {'fcnet_hiddens': [256, 256], 'fcnet_activation': 'tanh', 'fcnet_weights_initializer': None, 'fcnet_weights_initializer_config': None, 'fcnet_bias_initializer': None, 'fcnet_bias_initializer_config': None, 'conv_filters': None, 'conv_activation': 'relu', 'conv_kernel_initializer': None, 'conv_kernel_initializer_config': None, 'conv_bias_initializer': None, 'conv_bias_initializer_config': None, 'conv_transpose_kernel_initializer': None, 'conv_transpose_kernel_initializer_config': None, 'conv_transpose_bias_initializer': None, 'conv_transpose_bias_initializer_config': None, 'post_fcnet_hiddens': [], 'post_fcnet_activation': 'relu', 'post_fcnet_weights_initializer': None, 'post_fcnet_weights_initializer_config': None, 'post_fcnet_bias_initializer': None, 'post_fcnet_bias_initializer_config': None, 'free_log_std': False, 'log_std_clip_param': 20.0, 'no_final_linear': False, 'vf_share_layers': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action': False, 'lstm_use_prev_reward': False, 'lstm_weights_initializer': None, 'lstm_weights_initializer_config': None, 'lstm_bias_initializer': None, 'lstm_bias_initializer_config': None, '_time_major': False, 'use_attention': False, 'attention_num_transformer_units': 1, 'attention_dim': 64, 'attention_num_heads': 1, 'attention_head_dim': 32, 'attention_memory_inference': 50, 'attention_memory_training': 50, 'attention_position_wise_mlp_dim': 32, 'attention_init_gru_gate_bias': 2.0, 'attention_use_n_prev_actions': 0, 'attention_use_n_prev_rewards': 0, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_model': None, 'custom_model_config': {}, 'custom_action_dist': None, 'custom_preprocessor': None, 'encoder_latent_dim': None, 'always_check_shapes': False, 'lstm_use_prev_action_reward': -1, '_use_default_native_models': -1, '_disable_preprocessor_api': False, '_disable_action_flattening': False}, '_learner_connector': None, 'add_default_connectors_to_learner_pipeline': True, 'learner_config_dict': {}, 'optimizer': {}, '_learner_class': None, 'callbacks_on_algorithm_init': None, 'callbacks_on_env_runners_recreated': None, 'callbacks_on_checkpoint_loaded': None, 'callbacks_on_environment_created': None, 'callbacks_on_episode_created': None, 'callbacks_on_episode_start': None, 'callbacks_on_episode_step': None, 'callbacks_on_episode_end': None, 'callbacks_on_evaluate_start': None, 'callbacks_on_evaluate_end': None, 'callbacks_on_sample_end': None, 'callbacks_on_train_result': None, 'explore': True, 'enable_rl_module_and_learner': True, 'enable_env_runner_and_connector_v2': True, '_prior_exploration_config': {'type': 'StochasticSampling'}, 'count_steps_by': 'env_steps', 'policy_map_capacity': 100, 'policy_mapping_fn': <function <lambda> at 0x37c1dc360>, 'policies_to_train': None, 'policy_states_are_swappable': False, 'observation_fn': None, 'offline_data_class': None, 'input_read_method': 'read_parquet', 'input_read_method_kwargs': {}, 'input_read_schema': {}, 'input_read_episodes': False, 'input_read_sample_batches': False, 'input_read_batch_size': None, 'input_filesystem': None, 'input_filesystem_kwargs': {}, 'input_compress_columns': ['obs', 'new_obs'], 'input_spaces_jsonable': True, 'materialize_data': False, 'materialize_mapped_data': True, 'map_batches_kwargs': {}, 'iter_batches_kwargs': {}, 'prelearner_class': None, 'prelearner_buffer_class': None, 'prelearner_buffer_kwargs': {}, 'prelearner_module_synch_period': 10, 'dataset_num_iters_per_learner': None, 'input_config': {}, 'actions_in_input_normalized': False, 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_config': {}, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'output_max_rows_per_file': None, 'output_write_remaining_data': False, 'output_write_method': 'write_parquet', 'output_write_method_kwargs': {}, 'output_filesystem': None, 'output_filesystem_kwargs': {}, 'output_write_episodes': True, 'offline_sampling': False, 'evaluation_interval': 10, 'evaluation_duration': 5, 'evaluation_duration_unit': 'episodes', 'evaluation_sample_timeout_s': 120.0, 'evaluation_parallel_to_training': True, 'evaluation_force_reset_envs_before_iteration': True, 'evaluation_config': {'explore': False, 'observation_filter': 'MeanStdFilter'}, 'off_policy_estimation_methods': {}, 'ope_split_batch_by_episode': True, 'evaluation_num_env_runners': 1, 'in_evaluation': False, 'sync_filters_on_rollout_workers_timeout_s': 10.0, 'keep_per_episode_custom_metrics': False, 'metrics_episode_collection_timeout_s': 60.0, 'metrics_num_episodes_for_smoothing': 100, 'min_time_s_per_iteration': None, 'min_train_timesteps_per_iteration': 0, 'min_sample_timesteps_per_iteration': 0, 'log_gradients': True, 'export_native_model_files': False, 'checkpoint_trainable_policies_only': False, 'logger_creator': None, 'logger_config': None, 'log_level': 'INFO', 'log_sys_usage': True, 'fake_sampler': False, 'seed': None, 'restart_failed_env_runners': True, 'ignore_env_runner_failures': False, 'max_num_env_runner_restarts': 1000, 'delay_between_env_runner_restarts_s': 60.0, 'restart_failed_sub_environments': False, 'num_consecutive_env_runner_failures_tolerance': 100, 'env_runner_health_probe_timeout_s': 30.0, 'env_runner_restore_timeout_s': 1800.0, '_model_config': {}, '_rl_module_spec': None, 'algorithm_config_overrides_per_module': {}, '_per_module_overrides': {}, '_validate_config': True, '_use_msgpack_checkpoints': False, '_torch_grad_scaler_class': None, '_torch_lr_scheduler_classes': None, '_tf_policy_handles_more_than_one_loss': False, '_disable_preprocessor_api': False, '_disable_action_flattening': False, '_disable_initialize_loss_from_dummy_batch': False, '_dont_auto_sync_env_runner_states': False, 'env_task_fn': -1, 'enable_connectors': -1, 'simple_optimizer': True, 'policy_map_cache': -1, 'worker_cls': -1, 'synchronize_filters': -1, 'enable_async_evaluation': -1, 'custom_async_evaluation_function': -1, '_enable_rl_module_api': -1, 'auto_wrap_old_gym_envs': -1, 'always_attach_evaluation_results': -1, 'replay_sequence_length': None, '_disable_execution_plan_api': -1, 'use_critic': True, 'use_gae': True, 'use_kl_loss': True, 'kl_coeff': 0.2, 'kl_target': 0.01, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.02, 'clip_param': 0.2, 'vf_clip_param': 5.0, 'entropy_coeff_schedule': None, 'lr_schedule': None, 'sgd_minibatch_size': -1, 'vf_share_layers': -1, 'class': <class 'ray.rllib.algorithms.ppo.ppo.PPOConfig'>, 'lambda': 1.0, 'input': 'sampler', 'policies': {'servicer': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None), 'target': (None, Box(-inf, inf, (13,), float32), Box(-1.0, 1.0, (6,), float32), None)}, 'callbacks': <class 'ray.rllib.callbacks.callbacks.RLlibCallback'>, 'create_env_on_driver': False, 'custom_eval_function': None, 'framework': 'torch'}, 'time_since_restore': 334.11483502388, 'iterations_since_restore': 100, 'perf': {'cpu_util_percent': 87.93333333333332, 'ram_util_percent': 54.199999999999996}})
2025-04-03 21:15:17,478 [__main__] [INFO] 
--- Running Evaluation & Recording Video ---
2025-04-03 21:15:17,479 [__main__] [INFO] Successfully retrieved RLModules for evaluation.
2025-04-03 21:15:17,479 [__main__] [INFO] Evaluation Episode: 1/5
2025-04-03 21:15:17,557 [src.satellite_marl_env] [INFO] MuJoCo Renderer initialized for rgb_array.
2025-04-03 21:15:20,467 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:15:20,470 [__main__] [INFO] Evaluation Episode 1 Rewards: {'servicer': -1140.032433294098, 'target': -8.708590607643117}
2025-04-03 21:15:20,470 [__main__] [INFO] Evaluation Episode: 2/5
2025-04-03 21:15:23,304 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:15:23,307 [__main__] [INFO] Evaluation Episode 2 Rewards: {'servicer': -1140.032433294098, 'target': -8.708590607643117}
2025-04-03 21:15:23,307 [__main__] [INFO] Evaluation Episode: 3/5
2025-04-03 21:15:26,148 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:15:26,151 [__main__] [INFO] Evaluation Episode 3 Rewards: {'servicer': -1140.032433294098, 'target': -8.708590607643117}
2025-04-03 21:15:26,151 [__main__] [INFO] Evaluation Episode: 4/5
2025-04-03 21:15:28,937 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:15:28,942 [__main__] [INFO] Evaluation Episode 4 Rewards: {'servicer': -1140.032433294098, 'target': -8.708590607643117}
2025-04-03 21:15:28,942 [__main__] [INFO] Evaluation Episode: 5/5
2025-04-03 21:15:31,755 [src.satellite_marl_env] [INFO] Max steps reached, episode truncated.
2025-04-03 21:15:31,758 [__main__] [INFO] Evaluation Episode 5 Rewards: {'servicer': -1140.032433294098, 'target': -8.708590607643117}
2025-04-03 21:15:31,767 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:15:31,767 [__main__] [INFO] Average Evaluation Rewards over 5 episodes: {'servicer': -1140.032433294098, 'target': -8.708590607643117}
2025-04-03 21:15:31,767 [__main__] [INFO] Saving evaluation video to: /Users/nathanleo/Downloads/IST 597 - RL/Final Project/RL-Spacecraft-Docking/output/ray_results/evaluation_video.mp4
2025-04-03 21:15:35,522 [__main__] [INFO] Shutting down Ray...
2025-04-03 21:15:36,225 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:15:36,244 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-03 21:15:37,736 [__main__] [INFO] Script finished.
