2025-04-22 14:49:01,723 [__main__] [INFO] Logging setup complete. Log file: output/logs/training_20250422_144901.log
2025-04-22 14:49:01,724 [__main__] [INFO] Registered RLlib environment 'satellite_marl'
2025-04-22 14:49:01,724 [__main__] [INFO] --- Starting MARL Training Script ---
2025-04-22 14:49:01,724 [__main__] [INFO] Environment Config: src.config
2025-04-22 14:49:01,724 [__main__] [INFO] RLlib PPO Algorithm
2025-04-22 14:49:01,724 [__main__] [INFO] Training Iterations: 100
2025-04-22 14:49:01,725 [__main__] [INFO] Results Directory: output/ray_results
2025-04-22 14:49:01,725 [__main__] [INFO] Detected 16 CPUs.
2025-04-22 14:49:01,823 [filelock] [DEBUG] Attempting to acquire lock 5706808656 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/node_ip_address.json.lock
2025-04-22 14:49:01,823 [filelock] [DEBUG] Lock 5706808656 acquired on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/node_ip_address.json.lock
2025-04-22 14:49:01,824 [filelock] [DEBUG] Attempting to release lock 5706808656 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/node_ip_address.json.lock
2025-04-22 14:49:01,824 [filelock] [DEBUG] Lock 5706808656 released on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/node_ip_address.json.lock
2025-04-22 14:49:01,825 [filelock] [DEBUG] Attempting to acquire lock 4810714064 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,825 [filelock] [DEBUG] Lock 4810714064 acquired on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,826 [filelock] [DEBUG] Attempting to release lock 4810714064 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,826 [filelock] [DEBUG] Lock 4810714064 released on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,826 [filelock] [DEBUG] Attempting to acquire lock 5248382864 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,827 [filelock] [DEBUG] Lock 5248382864 acquired on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,828 [filelock] [DEBUG] Attempting to release lock 5248382864 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,828 [filelock] [DEBUG] Lock 5248382864 released on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,828 [filelock] [DEBUG] Attempting to acquire lock 5704832528 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,828 [filelock] [DEBUG] Lock 5704832528 acquired on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,829 [filelock] [DEBUG] Attempting to release lock 5704832528 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,829 [filelock] [DEBUG] Lock 5704832528 released on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,830 [filelock] [DEBUG] Attempting to acquire lock 4810714064 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,830 [filelock] [DEBUG] Lock 4810714064 acquired on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,831 [filelock] [DEBUG] Attempting to release lock 4810714064 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,831 [filelock] [DEBUG] Lock 4810714064 released on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,831 [filelock] [DEBUG] Attempting to acquire lock 5704842704 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,831 [filelock] [DEBUG] Lock 5704842704 acquired on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,832 [filelock] [DEBUG] Attempting to release lock 5704842704 on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:01,832 [filelock] [DEBUG] Lock 5704842704 released on /tmp/ray/session_2025-04-22_14-49-01_820734_68057/ports_by_node.json.lock
2025-04-22 14:49:05,982 [__main__] [INFO] Ray initialized successfully.
2025-04-22 14:49:05,982 [__main__] [INFO] Creating temporary environment to get action/observation spaces...
2025-04-22 14:49:05,982 [__main__] [DEBUG] Creating RllibSatelliteEnv with config: {}
2025-04-22 14:49:05,999 [src.satellite_marl_env] [INFO] MuJoCo model loaded successfully from /Users/leo/RL-Spacecraft-Docking/src/xml_references/satellites.xml
2025-04-22 14:49:06,001 [src.satellite_marl_env] [DEBUG] MuJoCo IDs retrieved successfully.
2025-04-22 14:49:06,001 [src.satellite_marl_env] [INFO] SatelliteMARLEnv closed.
2025-04-22 14:49:06,001 [__main__] [INFO] Observation/Action spaces retrieved successfully:
2025-04-22 14:49:06,001 [__main__] [INFO]   Agent 'servicer': Obs=Box(-inf, inf, (13,), float32), Act=Box(-1.0, 1.0, (6,), float32)
2025-04-22 14:49:06,001 [__main__] [INFO]   Agent 'target': Obs=Box(-inf, inf, (13,), float32), Act=Box(-1.0, 1.0, (6,), float32)
2025-04-22 14:49:06,002 [__main__] [INFO] Configuring RLlib PPO Algorithm...
2025-04-22 14:49:06,002 [__main__] [INFO] Absolute results path: /Users/leo/RL-Spacecraft-Docking/output/ray_results
2025-04-22 14:49:06,002 [__main__] [INFO] Using 14 environment runners (workers).
2025-04-22 14:49:06,002 [__main__] [INFO] Setting train_batch_size: 4000
2025-04-22 14:49:06,005 [__main__] [ERROR] Failed during RLlib configuration or algorithm build. Exiting.
Traceback (most recent call last):
  File "/Users/leo/RL-Spacecraft-Docking/src/train_marl.py", line 408, in <module>
    .rl_module( _enable_rl_module_api=True )
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/algorithms/algorithm_config.py", line 3601, in rl_module
    deprecation_warning(
  File "/Users/leo/RL-Spacecraft-Docking/.venv/lib/python3.11/site-packages/ray/rllib/utils/deprecation.py", line 48, in deprecation_warning
    raise ValueError(msg)
ValueError: `AlgorithmConfig.rl_module(_enable_rl_module_api=..)` has been deprecated. Use `AlgorithmConfig.api_stack(enable_rl_module_and_learner=..)` instead.
